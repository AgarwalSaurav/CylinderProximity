(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    298043,       7852]
NotebookOptionsPosition[    291415,       7635]
NotebookOutlinePosition[    291873,       7653]
CellTagsIndexPosition[    291830,       7650]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
(*
Programme for finding the least distance (i.e., finding the proximity) \
between two infinite cylindrical surfaces
*)\[LineSeparator]\
\>", "Input",
 Evaluatable->False,
 CellChangeTimes->{
  3.558075401021812*^9, {3.558075433176977*^9, 3.55807549337778*^9}, 
   3.5580756045375433`*^9, {3.5698304191010246`*^9, 3.569830422737232*^9}, {
   3.5704363618914156`*^9, 3.570436361997422*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"norm", "[", "v_", "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "+", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.641861419888077*^9, 3.6418614198900423`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "define", " ", "the", " ", "first", " ", "cylinder", " ", "in", " ", "its",
     " ", "local", " ", "frame", " ", "of", " ", "reference"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", " ", "y1"}], "}"}], " ", "=", " ", 
     RowBox[{"r1", " ", "*", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], ",", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z1", " ", "=", " ", 
     RowBox[{"l1", "*", "t1"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "define", " ", "a", " ", "point", " ", "on", " ", "the", " ", 
     "cylinder"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   
   RowBox[{"p1", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.558073458170795*^9, 3.558073553293523*^9}, {
   3.55807371917924*^9, 3.5580737362448263`*^9}, {3.558096992182033*^9, 
   3.558096992876449*^9}, {3.5580976551705437`*^9, 3.5580976563218107`*^9}, 
   3.5580976996167173`*^9, {3.558098725578822*^9, 3.5580987512630997`*^9}, {
   3.558142950725593*^9, 3.558142991505747*^9}, {3.5587083423965797`*^9, 
   3.558708342701953*^9}, 3.5587084020411243`*^9, {3.55877071174793*^9, 
   3.558770719365891*^9}, 3.558771208567287*^9, {3.558772402537244*^9, 
   3.5587724069393177`*^9}, {3.558773240379507*^9, 3.558773272034829*^9}, 
   3.5587750721059427`*^9, {3.558781569802609*^9, 3.55878158664182*^9}, {
   3.558786957930822*^9, 3.558786962508292*^9}, {3.55882511647033*^9, 
   3.558825117438373*^9}, 3.558837829436367*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"r1", " ", 
    RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], ",", 
   RowBox[{"r1", " ", 
    RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], ",", 
   RowBox[{"l1", " ", "t1"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.558075673827717*^9, 3.5580757139613857`*^9, 3.558080377378187*^9, 
   3.558096993681979*^9, {3.558097678077073*^9, 3.558097703009056*^9}, 
   3.558098752910901*^9, 3.558175433811019*^9, 3.558707265456934*^9, 
   3.55870834372339*^9, 3.558708407063963*^9, 3.55875370056467*^9, 
   3.558770727019174*^9, 3.558771243339748*^9, 3.558772407676833*^9, 
   3.558772789318028*^9, {3.558773257479459*^9, 3.55877327314431*^9}, 
   3.558775073047317*^9, 3.55878159636373*^9, 3.558786966507745*^9, 
   3.558787027180826*^9, 3.5588251188342113`*^9, 3.558837832630258*^9, 
   3.5698297915661316`*^9, 3.5719973082722397`*^9, 3.572061240319376*^9, 
   3.5720614461141467`*^9, 3.572082934332261*^9, 3.572097691135271*^9, 
   3.572098626246756*^9, 3.5720999886096787`*^9, 3.5721010446070786`*^9, 
   3.572102345043459*^9, 3.572315505101534*^9, 3.572321438429901*^9, 
   3.572330762834194*^9, 3.5723547005637083`*^9, 3.5729664012199116`*^9, 
   3.574159150289457*^9, 3.5741600747193313`*^9, 3.574733849519536*^9, 
   3.5749419653072367`*^9, 3.574965378721628*^9, 3.5810884379318995`*^9, 
   3.641860918115974*^9, {3.6418613907645473`*^9, 3.6418614237677717`*^9}, 
   3.6418614943572817`*^9, 3.64186312099326*^9, 3.641863790358831*^9, 
   3.641864137504483*^9, 3.641865108477057*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "define", " ", "the", " ", "second", " ", "cylinder", " ", "likewise"}], 
   " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x2", ",", " ", "y2"}], "}"}], " ", "=", " ", 
     RowBox[{"r2", " ", "*", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]2", "]"}], ",", " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z2", " ", "=", " ", 
     RowBox[{"l2", "*", "t2"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "take", " ", "the", " ", "second", " ", "cylinder", " ", "to", " ", "a", 
     " ", "generic", " ", "configuration"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"define", " ", "the", " ", "orientation"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"q0", "^", "2"}], "+", 
          RowBox[{"q1", "^", "2"}], "-", 
          RowBox[{"q2", "^", "2"}], "-", 
          RowBox[{"q3", "^", "2"}]}], ",", 
         RowBox[{
          RowBox[{"2", " ", "q1", " ", "q2"}], "-", 
          RowBox[{"2", " ", "q0", " ", "q3"}]}], ",", 
         RowBox[{
          RowBox[{"2", " ", "q1", " ", "q3"}], "+", 
          RowBox[{"2", " ", "q0", " ", "q2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
          RowBox[{"2", " ", "q0", " ", "q3"}]}], ",", 
         RowBox[{
          RowBox[{"q0", "^", "2"}], "-", 
          RowBox[{"q1", "^", "2"}], "+", 
          RowBox[{"q2", "^", "2"}], "-", 
          RowBox[{"q3", "^", "2"}]}], ",", 
         RowBox[{
          RowBox[{"2", " ", "q2", " ", "q3"}], "-", 
          RowBox[{"2", "q0", " ", "q1"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", "q1", " ", "q3"}], "-", 
          RowBox[{"2", " ", "q0", " ", "q2"}]}], ",", 
         RowBox[{
          RowBox[{"2", "q2", " ", "q3"}], "+", 
          RowBox[{"2", " ", "q0", " ", "q1"}]}], ",", " ", 
         RowBox[{
          RowBox[{"q0", "^", "2"}], "-", 
          RowBox[{"q1", "^", "2"}], "-", 
          RowBox[{"q2", "^", "2"}], "+", 
          RowBox[{"q3", "^", "2"}]}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"const1", "=", 
     RowBox[{
      RowBox[{"q0", "^", "2"}], "+", 
      RowBox[{"q1", "^", "2"}], "+", 
      RowBox[{"q2", "^", "2"}], "+", 
      RowBox[{"q3", "^", "2"}], "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "R", "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "define", " ", "the", " ", "position", " ", "of", " ", "the", " ", 
     "\"\<origin\>\""}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"tx", ",", " ", "ty", ",", " ", "tz"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "define", " ", "a", " ", "point", " ", "on", " ", "the", " ", "second", 
      " ", "cylinder"}], ",", " ", 
     RowBox[{
     "expressed", " ", "in", " ", "the", " ", "frame", " ", "of", " ", 
      "reference", " ", "of", " ", "the", " ", "first", " ", "cylinder"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"p2", " ", "=", " ", 
    RowBox[{"t", " ", "+", " ", 
     RowBox[{"R", ".", 
      RowBox[{"{", 
       RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], "}"}]}]}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.558073458170795*^9, 3.558073709507827*^9}, {
   3.558073740454792*^9, 3.5580738049933653`*^9}, 3.558082148926989*^9, {
   3.558096355912854*^9, 3.55809635695401*^9}, {3.558096434825989*^9, 
   3.5580964407635508`*^9}, {3.558096566201684*^9, 3.558096566383749*^9}, 
   3.5580968035030537`*^9, {3.558143008551819*^9, 3.5581430129027843`*^9}, {
   3.558221056875045*^9, 3.558221058367564*^9}, {3.558707871191598*^9, 
   3.5587080532057667`*^9}, {3.558708086242559*^9, 3.558708138196657*^9}, {
   3.5587081864836493`*^9, 3.558708197922638*^9}, {3.5587082919003572`*^9, 
   3.558708296868143*^9}, 3.558708403965981*^9, {3.558770730864664*^9, 
   3.5587707355707817`*^9}, 3.558771211427903*^9, {3.558772411253378*^9, 
   3.5587724139794683`*^9}, {3.558773268116036*^9, 3.558773271162249*^9}, 
   3.558775076077957*^9, {3.558781591525593*^9, 3.558781593321697*^9}, {
   3.558787035778143*^9, 3.558787038400735*^9}, {3.558825124510339*^9, 
   3.5588251252333527`*^9}, 3.5588378353835907`*^9, {3.572061196104847*^9, 
   3.572061196569874*^9}, {3.572062554819561*^9, 3.572062606148497*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q1", "2"], "-", 
       SuperscriptBox["q2", "2"], "-", 
       SuperscriptBox["q3", "2"]}], 
      RowBox[{
       RowBox[{"2", " ", "q1", " ", "q2"}], "-", 
       RowBox[{"2", " ", "q0", " ", "q3"}]}], 
      RowBox[{
       RowBox[{"2", " ", "q0", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q1", " ", "q3"}]}]},
     {
      RowBox[{
       RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q0", " ", "q3"}]}], 
      RowBox[{
       SuperscriptBox["q0", "2"], "-", 
       SuperscriptBox["q1", "2"], "+", 
       SuperscriptBox["q2", "2"], "-", 
       SuperscriptBox["q3", "2"]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q0", " ", "q1"}], "+", 
       RowBox[{"2", " ", "q2", " ", "q3"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q0", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q1", " ", "q3"}]}], 
      RowBox[{
       RowBox[{"2", " ", "q0", " ", "q1"}], "+", 
       RowBox[{"2", " ", "q2", " ", "q3"}]}], 
      RowBox[{
       SuperscriptBox["q0", "2"], "-", 
       SuperscriptBox["q1", "2"], "-", 
       SuperscriptBox["q2", "2"], "+", 
       SuperscriptBox["q3", "2"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.641861390869198*^9, 3.6418614237907352`*^9}, 
   3.641861494385429*^9, 3.6418631210214376`*^9, 3.641863790477725*^9, 
   3.641864137601272*^9, 3.641865108503057*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"l2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q0", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q1", " ", "q3"}]}], ")"}], " ", "t2"}], "+", "tx", 
    "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q1", "2"], "-", 
       SuperscriptBox["q2", "2"], "-", 
       SuperscriptBox["q3", "2"]}], ")"}], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q1", " ", "q2"}], "-", 
       RowBox[{"2", " ", "q0", " ", "q3"}]}], ")"}], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"l2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q0", " ", "q1"}], "+", 
       RowBox[{"2", " ", "q2", " ", "q3"}]}], ")"}], " ", "t2"}], "+", "ty", 
    "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q0", " ", "q3"}]}], ")"}], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "-", 
       SuperscriptBox["q1", "2"], "+", 
       SuperscriptBox["q2", "2"], "-", 
       SuperscriptBox["q3", "2"]}], ")"}], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"l2", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "-", 
       SuperscriptBox["q1", "2"], "-", 
       SuperscriptBox["q2", "2"], "+", 
       SuperscriptBox["q3", "2"]}], ")"}], " ", "t2"}], "+", "tz", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q0", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q1", " ", "q3"}]}], ")"}], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q0", " ", "q1"}], "+", 
       RowBox[{"2", " ", "q2", " ", "q3"}]}], ")"}], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.641861390869198*^9, 3.6418614237907352`*^9}, 
   3.641861494385429*^9, 3.6418631210214376`*^9, 3.641863790477725*^9, 
   3.641864137601272*^9, 3.6418651085048847`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ogen", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "s", "]"}], ",", 
      RowBox[{"Sin", "[", "s", "]"}], ",", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "s"}], "]"}]}], "}"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ogen", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"ogen", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"ogen", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "s"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Tu", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"T", "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "+", 
       RowBox[{"4", "*", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "s"}], "]"}], "^", "2"}]}]}], "]"}]}], "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nvec", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{"Tu", ",", "s"}], "]"}], "]"}]}], "\[IndentingNewLine]"}], "\n", 

 RowBox[{
  RowBox[{"Nvecu", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Nvec", "/", 
     RowBox[{"norm", "[", "Nvec", "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Bvec", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Cross", "[", 
     RowBox[{"Tu", ",", "Nvecu"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Rgen", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Nvec", ",", "Bvec", ",", "Tu"}], "}"}], "//", "Transpose"}]}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"Rgen", "=", 
   RowBox[{"Simplify", "[", "Rgen", "]"}]}], 
  "\[IndentingNewLine]"}], "\n"}], "Input",
 CellChangeTimes->{{3.641860941677215*^9, 3.6418609679576597`*^9}, {
   3.641861084159692*^9, 3.641861087969136*^9}, {3.641861400318776*^9, 
   3.6418614031899023`*^9}, 3.641861871981073*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"Sin", "[", "s", "]"}]}], ",", 
   RowBox[{"Cos", "[", "s", "]"}], ",", 
   RowBox[{
    RowBox[{"-", "2"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "s"}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.641863121042829*^9, 3.641863790498143*^9, 
  3.641864137613241*^9, 3.6418651085317717`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"Sin", "[", "s", "]"}], 
     SqrtBox[
      RowBox[{"3", "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"4", " ", "s"}], "]"}]}]}]]]}], ",", 
   FractionBox[
    RowBox[{"Cos", "[", "s", "]"}], 
    SqrtBox[
     RowBox[{"3", "-", 
      RowBox[{"2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"4", " ", "s"}], "]"}]}]}]]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "s"}], "]"}]}], 
     SqrtBox[
      RowBox[{"3", "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"4", " ", "s"}], "]"}]}]}]]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.641863121042829*^9, 3.641863790498143*^9, 
  3.641864137613241*^9, 3.641865108648759*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"3", " ", 
       RowBox[{"Cos", "[", "s", "]"}]}], "-", 
      RowBox[{"3", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"3", " ", "s"}], "]"}]}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{"5", " ", "s"}], "]"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"3", "-", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
      RowBox[{"3", "/", "2"}]]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"3", " ", 
       RowBox[{"Sin", "[", "s", "]"}]}], "+", 
      RowBox[{"3", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"3", " ", "s"}], "]"}]}], "+", 
      RowBox[{"Sin", "[", 
       RowBox[{"5", " ", "s"}], "]"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"3", "-", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
      RowBox[{"3", "/", "2"}]]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"4", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "s"}], "]"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"3", "-", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
      RowBox[{"3", "/", "2"}]]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.641863121042829*^9, 3.641863790498143*^9, 
  3.641864137613241*^9, 3.641865108692926*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"3", " ", 
       RowBox[{"Cos", "[", "s", "]"}]}], "-", 
      RowBox[{"3", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"3", " ", "s"}], "]"}]}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{"5", " ", "s"}], "]"}]}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"3", "-", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
       RowBox[{"3", "/", "2"}]], " ", 
      SqrtBox[
       FractionBox[
        RowBox[{"11", "+", 
         RowBox[{"6", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "s"}], "]"}]}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"3", "-", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], "2"]]]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"12", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "s", "]"}], "2"], " ", 
       RowBox[{"Sin", "[", "s", "]"}]}], "+", 
      RowBox[{"Sin", "[", 
       RowBox[{"5", " ", "s"}], "]"}]}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"3", "-", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
       RowBox[{"3", "/", "2"}]], " ", 
      SqrtBox[
       FractionBox[
        RowBox[{"11", "+", 
         RowBox[{"6", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "s"}], "]"}]}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"3", "-", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], "2"]]]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"4", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "s"}], "]"}]}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"3", "-", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
       RowBox[{"3", "/", "2"}]], " ", 
      SqrtBox[
       FractionBox[
        RowBox[{"11", "+", 
         RowBox[{"6", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "s"}], "]"}]}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"3", "-", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], "2"]]]}]]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.641863121042829*^9, 3.641863790498143*^9, 
  3.641864137613241*^9, 3.641865109463933*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"4", " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", "s", "]"}], "3"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "3"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], " ", 
     SqrtBox[
      FractionBox[
       RowBox[{"11", "+", 
        RowBox[{"6", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "s"}], "]"}]}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], "2"]]]}], 
    RowBox[{"11", "+", 
     RowBox[{"6", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "s"}], "]"}]}]}]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "3"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], " ", 
      SqrtBox[
       FractionBox[
        RowBox[{"11", "+", 
         RowBox[{"6", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "s"}], "]"}]}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"3", "-", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], "2"]]], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "s", "]"}], "3"]}], 
     RowBox[{"11", "+", 
      RowBox[{"6", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"4", " ", "s"}], "]"}]}]}]]}], ",", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"3", "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], " ", 
     SqrtBox[
      FractionBox[
       RowBox[{"11", "+", 
        RowBox[{"6", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "s"}], "]"}]}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], "2"]]]}]]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.641863121042829*^9, 3.641863790498143*^9, 
  3.641864137613241*^9, 3.641865109650145*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"3", " ", 
         RowBox[{"Cos", "[", "s", "]"}]}], "-", 
        RowBox[{"3", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"3", " ", "s"}], "]"}]}], "+", 
        RowBox[{"Cos", "[", 
         RowBox[{"5", " ", "s"}], "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     FractionBox[
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "s", "]"}], "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "3"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{"11", "+", 
          RowBox[{"6", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "s"}], "]"}]}]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"3", "-", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], "2"]]]}], 
      RowBox[{"11", "+", 
       RowBox[{"6", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"4", " ", "s"}], "]"}]}]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"Sin", "[", "s", "]"}], 
       SqrtBox[
        RowBox[{"3", "-", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "s"}], "]"}]}]}]]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"3", " ", 
         RowBox[{"Sin", "[", "s", "]"}]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"3", " ", "s"}], "]"}]}], "+", 
        RowBox[{"Sin", "[", 
         RowBox[{"5", " ", "s"}], "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{"11", "+", 
           RowBox[{"6", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"4", " ", "s"}], "]"}]}]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"3", "-", 
             RowBox[{"2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], "2"]]], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "s", "]"}], "3"]}], 
       RowBox[{"11", "+", 
        RowBox[{"6", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "s"}], "]"}]}]}]]}], ",", 
     FractionBox[
      RowBox[{"Cos", "[", "s", "]"}], 
      SqrtBox[
       RowBox[{"3", "-", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "s"}], "]"}]}]}]]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "s"}], "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"3", "-", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{"11", "+", 
          RowBox[{"6", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "s"}], "]"}]}]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"3", "-", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], "2"]]]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "s"}], "]"}]}], 
       SqrtBox[
        RowBox[{"3", "-", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "s"}], "]"}]}]}]]]}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{3.641863121042829*^9, 3.641863790498143*^9, 
  3.641864137613241*^9, 3.641865109653023*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"3", " ", 
         RowBox[{"Cos", "[", "s", "]"}]}], "-", 
        RowBox[{"3", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"3", " ", "s"}], "]"}]}], "+", 
        RowBox[{"Cos", "[", 
         RowBox[{"5", " ", "s"}], "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     FractionBox[
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "s", "]"}], "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "3"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{"11", "+", 
          RowBox[{"6", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "s"}], "]"}]}]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"3", "-", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], "2"]]]}], 
      RowBox[{"11", "+", 
       RowBox[{"6", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"4", " ", "s"}], "]"}]}]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"Sin", "[", "s", "]"}], 
       SqrtBox[
        RowBox[{"3", "-", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "s"}], "]"}]}]}]]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"3", " ", 
         RowBox[{"Sin", "[", "s", "]"}]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"3", " ", "s"}], "]"}]}], "+", 
        RowBox[{"Sin", "[", 
         RowBox[{"5", " ", "s"}], "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{"11", "+", 
           RowBox[{"6", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"4", " ", "s"}], "]"}]}]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"3", "-", 
             RowBox[{"2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], "2"]]], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "s", "]"}], "3"]}], 
       RowBox[{"11", "+", 
        RowBox[{"6", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "s"}], "]"}]}]}]]}], ",", 
     FractionBox[
      RowBox[{"Cos", "[", "s", "]"}], 
      SqrtBox[
       RowBox[{"3", "-", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "s"}], "]"}]}]}]]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "s"}], "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"3", "-", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{"11", "+", 
          RowBox[{"6", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "s"}], "]"}]}]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"3", "-", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], "2"]]]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "s"}], "]"}]}], 
       SqrtBox[
        RowBox[{"3", "-", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "s"}], "]"}]}]}]]]}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{3.641863121042829*^9, 3.641863790498143*^9, 
  3.641864137613241*^9, 3.641865109698866*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"o2gen", "=", 
   RowBox[{"ogen", "-", 
    RowBox[{"(", 
     RowBox[{"ogen", "/.", 
      RowBox[{"s", "\[Rule]", " ", "0"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.641861073142262*^9, 3.641861113687194*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"o2subs", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"tx", "\[Rule]", " ", 
     RowBox[{"o2gen", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"ty", "\[Rule]", " ", 
     RowBox[{"o2gen", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", 
    RowBox[{"tz", "\[Rule]", " ", 
     RowBox[{"o2gen", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6418609989803143`*^9, 3.6418610691470337`*^9}, {
  3.641861117299165*^9, 3.64186112281839*^9}, {3.6418615962816*^9, 
  3.641861597079701*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"tx", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"Cos", "[", "s", "]"}]}]}], ",", 
   RowBox[{"ty", "\[Rule]", 
    RowBox[{"Sin", "[", "s", "]"}]}], ",", 
   RowBox[{"tz", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "s"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.641861390902961*^9, 3.641861424880323*^9}, 
   3.641861495563624*^9, 3.641861597683951*^9, 3.64186312228829*^9, 
   3.641863792047879*^9, 3.641864139404029*^9, 3.6418651097567177`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"R21gen", "=", 
  RowBox[{
   RowBox[{"Transpose", "[", "Rgen", "]"}], "*", 
   RowBox[{"(", 
    RowBox[{"Rgen", "/.", 
     RowBox[{"s", "\[Rule]", " ", "0"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.641861131520074*^9, 3.641861178819952*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"3", " ", 
        RowBox[{"Cos", "[", "s", "]"}]}], "-", 
       RowBox[{"3", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"3", " ", "s"}], "]"}]}], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"5", " ", "s"}], "]"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"3", "-", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
       RowBox[{"3", "/", "2"}]]], ",", 
     FractionBox[
      RowBox[{"4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"3", " ", "s"}], "]"}]}], "+", 
         RowBox[{"Sin", "[", 
          RowBox[{"5", " ", "s"}], "]"}]}], ")"}]}], 
      RowBox[{
       SqrtBox["17"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
        RowBox[{"3", "/", "2"}]]}]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"3", "-", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{"11", "+", 
          RowBox[{"6", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "s"}], "]"}]}]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"3", "-", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], "2"]]]}]]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"4", " ", 
       RowBox[{"Sin", "[", "s", "]"}]}], 
      SqrtBox[
       RowBox[{"3", "-", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"4", " ", "s"}], "]"}]}]}]]], ",", 
     FractionBox[
      RowBox[{"Cos", "[", "s", "]"}], 
      RowBox[{
       SqrtBox["17"], " ", 
       SqrtBox[
        RowBox[{"3", "-", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "s"}], "]"}]}]}]]}]], ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6418613909208193`*^9, 3.6418614248850813`*^9}, 
   3.641861495652145*^9, 3.641863122313725*^9, 3.641863792105401*^9, 
   3.641864139407515*^9, 3.641865109782799*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p2gen", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"ogen", "+", 
    RowBox[{"R", ".", 
     RowBox[{"{", 
      RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6418618622885847`*^9, 3.641861886611608*^9}, 
   3.641863758842723*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"2", " ", "l2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q0", " ", "q2"}], "+", 
       RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "t2"}], "+", 
    RowBox[{"Cos", "[", "s", "]"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q1", "2"], "-", 
       SuperscriptBox["q2", "2"], "-", 
       SuperscriptBox["q3", "2"]}], ")"}], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q1", " ", "q2"}], "-", 
       RowBox[{"q0", " ", "q3"}]}], ")"}], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"l2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q0", " ", "q1"}], "+", 
       RowBox[{"2", " ", "q2", " ", "q3"}]}], ")"}], " ", "t2"}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q1", " ", "q2"}], "+", 
       RowBox[{"q0", " ", "q3"}]}], ")"}], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"Sin", "[", "s", "]"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "-", 
       SuperscriptBox["q1", "2"], "+", 
       SuperscriptBox["q2", "2"], "-", 
       SuperscriptBox["q3", "2"]}], ")"}], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"l2", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "-", 
       SuperscriptBox["q1", "2"], "-", 
       SuperscriptBox["q2", "2"], "+", 
       SuperscriptBox["q3", "2"]}], ")"}], " ", "t2"}], "+", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "s"}], "]"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q0", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q1", " ", "q3"}]}], ")"}], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q0", " ", "q1"}], "+", 
       RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6418618796302767`*^9, 3.641861887517249*^9}, 
   3.641863122791545*^9, 3.641863792320752*^9, 3.641864139920104*^9, 
   3.641865109936852*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tr", "[", "R21gen", "]"}]], "Input",
 CellChangeTimes->{{3.641861485354076*^9, 3.641861485697521*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"3", " ", 
    RowBox[{"Cos", "[", "s", "]"}]}], "-", 
   RowBox[{"3", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"3", " ", "s"}], "]"}]}], "+", 
   RowBox[{"Cos", "[", 
    RowBox[{"5", " ", "s"}], "]"}]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"3", "-", 
     RowBox[{"2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
   RowBox[{"3", "/", "2"}]]]], "Output",
 CellChangeTimes->{{3.641861460651565*^9, 3.64186149572427*^9}, 
   3.641863122814981*^9, 3.641863792368513*^9, 3.641864140350828*^9, 
   3.6418651099635563`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"temp", "=", " ", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{"1", "+", 
     RowBox[{"Tr", "[", "R21gen", "]"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6418613008898487`*^9, 3.641861303351219*^9}, {
  3.64186148988447*^9, 3.641861490207363*^9}, {3.641861532448634*^9, 
  3.6418615351490517`*^9}}],

Cell[BoxData[
 SqrtBox[
  RowBox[{"1", "+", 
   FractionBox[
    RowBox[{
     RowBox[{"3", " ", 
      RowBox[{"Cos", "[", "s", "]"}]}], "-", 
     RowBox[{"3", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"3", " ", "s"}], "]"}]}], "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"5", " ", "s"}], "]"}]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"3", "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
     RowBox[{"3", "/", "2"}]]]}]]], "Output",
 CellChangeTimes->{
  3.641861304900742*^9, {3.6418613909403267`*^9, 3.641861424908998*^9}, 
   3.6418614957487698`*^9, 3.641861535492573*^9, 3.6418631228997*^9, 
   3.641863792487273*^9, 3.641864140777996*^9, 3.641865110055786*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"q21subs", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q0", "\[Rule]", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", "temp"}]}], " ", ",", 
     RowBox[{"q1", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"R21gen", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}], "-", 
         RowBox[{"R21gen", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ")"}], "*", "temp"}]}], 
     ",", 
     RowBox[{"q2", "\[Rule]", "  ", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"R21gen", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], "-", 
         RowBox[{"R21gen", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ")"}], "*", "temp"}]}], 
     ",", " ", 
     RowBox[{"q3", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"R21gen", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", 
         RowBox[{"R21gen", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}], "*", "temp"}]}]}], 
    "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.641861185508363*^9, 3.641861192460495*^9}, {
  3.64186124051635*^9, 3.641861258771113*^9}, {3.641861308120626*^9, 
  3.641861388416963*^9}, {3.6418615180213118`*^9, 3.6418615217105083`*^9}, {
  3.6418616433149223`*^9, 3.641861646313154*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"q0", "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SqrtBox[
      RowBox[{"1", "+", 
       FractionBox[
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "-", 
         RowBox[{"3", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"3", " ", "s"}], "]"}]}], "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"5", " ", "s"}], "]"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"3", "-", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
         RowBox[{"3", "/", "2"}]]]}]]}]}], ",", 
   RowBox[{"q1", "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"Cos", "[", "s", "]"}], 
         SqrtBox[
          RowBox[{"51", "-", 
           RowBox[{"34", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"4", " ", "s"}], "]"}]}]}]]]}], "+", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"3", "-", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], " ", 
         SqrtBox[
          FractionBox[
           RowBox[{"11", "+", 
            RowBox[{"6", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"4", " ", "s"}], "]"}]}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"3", "-", 
              RowBox[{"2", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], "2"]]]}]]}], ")"}],
      " ", 
     SqrtBox[
      RowBox[{"1", "+", 
       FractionBox[
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "-", 
         RowBox[{"3", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"3", " ", "s"}], "]"}]}], "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"5", " ", "s"}], "]"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"3", "-", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
         RowBox[{"3", "/", "2"}]]]}]]}]}], ",", 
   RowBox[{"q2", "\[Rule]", 
    FractionBox[
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{
          RowBox[{"3", " ", 
           RowBox[{"Cos", "[", "s", "]"}]}], "-", 
          RowBox[{"3", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"3", " ", "s"}], "]"}]}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"5", " ", "s"}], "]"}]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"3", "-", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
          RowBox[{"3", "/", "2"}]]]}]], " ", 
      RowBox[{"Sin", "[", "s", "]"}]}], 
     SqrtBox[
      RowBox[{"3", "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"4", " ", "s"}], "]"}]}]}]]]}], ",", 
   RowBox[{"q3", "\[Rule]", 
    FractionBox[
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{"1", "+", 
        FractionBox[
         RowBox[{
          RowBox[{"3", " ", 
           RowBox[{"Cos", "[", "s", "]"}]}], "-", 
          RowBox[{"3", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"3", " ", "s"}], "]"}]}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"5", " ", "s"}], "]"}]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"3", "-", 
            RowBox[{"2", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
          RowBox[{"3", "/", "2"}]]]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", 
         RowBox[{"Sin", "[", "s", "]"}]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"3", " ", "s"}], "]"}]}], "+", 
        RowBox[{"Sin", "[", 
         RowBox[{"5", " ", "s"}], "]"}]}], ")"}]}], 
     RowBox[{
      SqrtBox["17"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"3", "-", 
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "s"}], "]"}]}]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6418613909605007`*^9, 3.641861424952633*^9}, {
   3.641861495782577*^9, 3.6418615226194696`*^9}, 3.641861646772327*^9, 
   3.641863123298829*^9, 3.6418637930261*^9, 3.641864141298867*^9, 
   3.641865110434909*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"algvars", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "q0", ",", " ", "q1", ",", " ", "q2", ",", "q3", ",", " ", "r1", ",", 
       " ", "r2", ",", " ", "l1", ",", " ", "l2", ",", " ", "tx", ",", " ", 
       "ty", ",", " ", "tz", ",", "s"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"size", "[", "x_", "]"}], " ", ":=", "  ", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Size of the expression is:\>\"", ",", " ", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"ByteCount", "[", "x", "]"}], "/", "1000"}], "]"}], ",", 
       "  ", "\"\< KB.\>\""}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "define", " ", "the", " ", "distance", " ", "between", " ", "p1"}], ",", 
     " ", "p2"}], " ", "*)"}], "\n", 
   RowBox[{"d", " ", "=", " ", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"Numerator", "[", 
       RowBox[{"Together", "[", 
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p1", " ", "-", " ", "p2"}], ")"}], ".", " ", 
          RowBox[{"(", 
           RowBox[{"p1", " ", "-", " ", "p2"}], ")"}]}], "]"}], "]"}], "]"}], 
      ",", "algvars", " ", ",", " ", "FullSimplify"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"size", "[", "d", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.558074291890336*^9, 3.5580743032330713`*^9}, 
   3.57209863436522*^9, {3.641861710365587*^9, 3.641861723753481*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["r1", "2"], "+", 
  RowBox[{
   SuperscriptBox["l1", "2"], " ", 
   SuperscriptBox["t1", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["r2", "2"], "+", 
     RowBox[{
      SuperscriptBox["l2", "2"], " ", 
      SuperscriptBox["t2", "2"]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["q1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["r2", "2"], "+", 
     RowBox[{
      SuperscriptBox["l2", "2"], " ", 
      SuperscriptBox["t2", "2"]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["q2", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["r2", "2"], "+", 
     RowBox[{
      SuperscriptBox["l2", "2"], " ", 
      SuperscriptBox["t2", "2"]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["q3", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["r2", "2"], "+", 
     RowBox[{
      SuperscriptBox["l2", "2"], " ", 
      SuperscriptBox["t2", "2"]}]}], ")"}]}], "+", 
  SuperscriptBox["tx", "2"], "+", 
  SuperscriptBox["ty", "2"], "-", 
  RowBox[{"2", " ", "l1", " ", "t1", " ", "tz"}], "+", 
  SuperscriptBox["tz", "2"], "+", 
  RowBox[{"r1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "tx", " ", 
      RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
     RowBox[{"2", " ", "ty", " ", 
      RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["q3", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "l1", " ", "l2", " ", "t1", " ", "t2"}], "+", 
     RowBox[{"2", " ", "l2", " ", "t2", " ", "tz"}], "+", 
     RowBox[{"2", " ", "r1", " ", "r2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
     RowBox[{"r2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "tx", " ", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
        RowBox[{"2", " ", "ty", " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
  
  RowBox[{
   SuperscriptBox["q1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "l1", " ", "l2", " ", "t1", " ", "t2"}], "+", 
     RowBox[{
      SuperscriptBox["q2", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["r2", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["t2", "2"]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["q3", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["r2", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["t2", "2"]}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "l2", " ", "t2", " ", "tz"}], "-", 
     RowBox[{"2", " ", "r1", " ", "r2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "+", 
     RowBox[{"r2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "tx", " ", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
        RowBox[{"2", " ", "ty", " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
  
  RowBox[{
   SuperscriptBox["q2", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "l1", " ", "l2", " ", "t1", " ", "t2"}], "+", 
     RowBox[{
      SuperscriptBox["q3", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["r2", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["t2", "2"]}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "l2", " ", "t2", " ", "tz"}], "+", 
     RowBox[{"2", " ", "r1", " ", "r2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "+", 
     RowBox[{"r2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "tx", " ", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
        RowBox[{"2", " ", "ty", " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
  
  RowBox[{
   SuperscriptBox["q0", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "l1", " ", "l2", " ", "t1", " ", "t2"}], "+", 
     RowBox[{
      SuperscriptBox["q1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["r2", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["t2", "2"]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["q2", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["r2", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["t2", "2"]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["q3", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["r2", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["t2", "2"]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "l2", " ", "t2", " ", "tz"}], "-", 
     RowBox[{"2", " ", "r1", " ", "r2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
     RowBox[{"r2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "tx", " ", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
        RowBox[{"2", " ", "ty", " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
  
  RowBox[{"q2", " ", "q3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", "l2", " ", "t2", " ", "ty"}], "-", 
     RowBox[{"4", " ", "l2", " ", "r1", " ", "t2", " ", 
      RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
     RowBox[{"r2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "l1", " ", "t1", " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
        RowBox[{"4", " ", "tz", " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
  
  RowBox[{"q0", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"q2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", "l2", " ", "t2", " ", "tx"}], "-", 
        RowBox[{"4", " ", "l2", " ", "r1", " ", "t2", " ", 
         RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
        RowBox[{"r2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "l1", " ", "t1", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
           RowBox[{"4", " ", "tz", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}], 
     "+", 
     RowBox[{"q3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "r1", " ", "r2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
        RowBox[{"r2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "ty", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
           RowBox[{"4", " ", "tx", " ", 
            RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}], 
     "+", 
     RowBox[{"q1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "l2", " ", "t2", " ", "ty"}], "+", 
        RowBox[{"4", " ", "l2", " ", "r1", " ", "t2", " ", 
         RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
        RowBox[{"r2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", "l1", " ", "t1", " ", 
            RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
           RowBox[{"4", " ", "tz", " ", 
            RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
    ")"}]}], "+", 
  RowBox[{"q1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"q3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", "l2", " ", "t2", " ", "tx"}], "-", 
        RowBox[{"4", " ", "l2", " ", "r1", " ", "t2", " ", 
         RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
        RowBox[{"r2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", "l1", " ", "t1", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
           RowBox[{"4", " ", "tz", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}], 
     "+", 
     RowBox[{"q2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "ty", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
           RowBox[{"4", " ", "tx", " ", 
            RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}], "-", 
        RowBox[{"4", " ", "r1", " ", "r2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.641861732460911*^9, 3.6418631234208183`*^9, 
  3.641863793244603*^9, 3.6418641414859543`*^9, 3.641865110530184*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Size of the expression is:\"\>", "\[InvisibleSpace]", 
   "14.808`", "\[InvisibleSpace]", "\<\" KB.\"\>"}],
  SequenceForm["Size of the expression is:", 14.808, " KB."],
  Editable->False]], "Print",
 CellChangeTimes->{3.5721023492657003`*^9, 3.5723214431081686`*^9, 
  3.572354704546936*^9, 3.574159217038275*^9, 3.5747338539557896`*^9, 
  3.5749653823808374`*^9, 3.641860919101653*^9, 3.641861406821294*^9, 
  3.6418614965468597`*^9, 3.6418617324621563`*^9, 3.6418631234228907`*^9, 
  3.641863793251742*^9, 3.641864141489327*^9, 3.641865110532543*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dgen", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Numerator", "[", 
     RowBox[{"Together", "[", 
      RowBox[{"Expand", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p1", " ", "-", " ", "p2gen"}], ")"}], ".", " ", 
        RowBox[{"(", 
         RowBox[{"p1", " ", "-", " ", "p2gen"}], ")"}]}], "]"}], "]"}], "]"}],
     ",", "algvars", " ", ",", " ", "FullSimplify"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.641861549064457*^9, 3.641861552161579*^9}, {
  3.641861586854615*^9, 3.64186160780329*^9}, {3.6418616542005043`*^9, 
  3.641861656840816*^9}, {3.641861798183271*^9, 3.641861836552772*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["r1", "2"], "+", 
  RowBox[{
   SuperscriptBox["l1", "2"], " ", 
   SuperscriptBox["t1", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["r2", "2"], "+", 
     RowBox[{
      SuperscriptBox["l2", "2"], " ", 
      SuperscriptBox["t2", "2"]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["q1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["r2", "2"], "+", 
     RowBox[{
      SuperscriptBox["l2", "2"], " ", 
      SuperscriptBox["t2", "2"]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["q2", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["r2", "2"], "+", 
     RowBox[{
      SuperscriptBox["l2", "2"], " ", 
      SuperscriptBox["t2", "2"]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["q3", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["r2", "2"], "+", 
     RowBox[{
      SuperscriptBox["l2", "2"], " ", 
      SuperscriptBox["t2", "2"]}]}], ")"}]}], "-", 
  RowBox[{"2", " ", "l1", " ", "t1", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "s"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"3", "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"4", " ", "s"}], "]"}]}], ")"}]}], "-", 
  RowBox[{"2", " ", "r1", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"s", "-", "\[Theta]1"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "l1", " ", "l2", " ", "t1", " ", "t2"}], "+", 
     RowBox[{
      SuperscriptBox["q1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["r2", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["t2", "2"]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["q2", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["r2", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["t2", "2"]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["q3", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["r2", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["t2", "2"]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "l2", " ", "t2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "s"}], "]"}]}], "+", 
     RowBox[{"2", " ", "r2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "-", 
     RowBox[{"2", " ", "r1", " ", "r2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["q3", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "l1", " ", "l2", " ", "t1", " ", "t2"}], "+", 
     RowBox[{"2", " ", "l2", " ", "t2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "s"}], "]"}]}], "-", 
     RowBox[{"2", " ", "r2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "+", 
     RowBox[{"2", " ", "r1", " ", "r2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["q1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "l1", " ", "l2", " ", "t1", " ", "t2"}], "+", 
     RowBox[{
      SuperscriptBox["q2", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["r2", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["t2", "2"]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["q3", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["r2", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["t2", "2"]}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "l2", " ", "t2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "s"}], "]"}]}], "+", 
     RowBox[{"2", " ", "r2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "-", 
     RowBox[{"2", " ", "r1", " ", "r2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["q2", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "l1", " ", "l2", " ", "t1", " ", "t2"}], "+", 
     RowBox[{
      SuperscriptBox["q3", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["r2", "2"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["t2", "2"]}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "l2", " ", "t2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "s"}], "]"}]}], "-", 
     RowBox[{"2", " ", "r2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "+", 
     RowBox[{"2", " ", "r1", " ", "r2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"q2", " ", "q3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", "l2", " ", "t2", " ", 
      RowBox[{"Sin", "[", "s", "]"}]}], "-", 
     RowBox[{"4", " ", "l2", " ", "r1", " ", "t2", " ", 
      RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
     RowBox[{"r2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "l1", " ", "t1", " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "s"}], "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
  
  RowBox[{"q0", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"q2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", "l2", " ", "t2", " ", 
         RowBox[{"Cos", "[", "s", "]"}]}], "-", 
        RowBox[{"4", " ", "l2", " ", "r1", " ", "t2", " ", 
         RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
        RowBox[{"r2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "l1", " ", "t1", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
           RowBox[{"4", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "s"}], "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}], 
     "+", 
     RowBox[{"q3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", "r2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "-", 
        RowBox[{"4", " ", "r1", " ", "r2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{"q1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "l2", " ", "t2", " ", 
         RowBox[{"Sin", "[", "s", "]"}]}], "+", 
        RowBox[{"4", " ", "l2", " ", "r1", " ", "t2", " ", 
         RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
        RowBox[{"r2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", "l1", " ", "t1", " ", 
            RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
           RowBox[{"4", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "s"}], "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
    ")"}]}], "+", 
  RowBox[{"q1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"q3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", "l2", " ", "t2", " ", 
         RowBox[{"Cos", "[", "s", "]"}]}], "-", 
        RowBox[{"4", " ", "l2", " ", "r1", " ", "t2", " ", 
         RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
        RowBox[{"r2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", "l1", " ", "t1", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
           RowBox[{"4", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "s"}], "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}], 
     "+", 
     RowBox[{"q2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", "r2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "-", 
        RowBox[{"4", " ", "r1", " ", "r2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.641861730105558*^9, 3.641861791783675*^9, 
  3.6418618377812347`*^9, 3.6418619045999107`*^9, 3.6418631327456493`*^9, 
  3.6418637933843307`*^9, 3.641864141962253*^9, 3.641865110633854*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq1", " ", "=", " ", 
  RowBox[{"Factor", "[", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"d", ",", " ", "\[Theta]1"}], "]"}], ",", " ", "algvars", ",", 
     " ", "FullSimplify"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5580742152226553`*^9, 3.55807428163601*^9}, {
   3.558074321689114*^9, 3.5580743711156588`*^9}, 3.558075720377026*^9, {
   3.558773386697381*^9, 3.558773387591748*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], " ", "r1", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "l2", " ", "q0", " ", "q1", " ", "t2", " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
    RowBox[{"2", " ", "l2", " ", "q2", " ", "q3", " ", "t2", " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
    RowBox[{"ty", " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
    RowBox[{"2", " ", "q0", " ", "q3", " ", "r2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{"2", " ", "q1", " ", "q2", " ", "r2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{"2", " ", "l2", " ", "q0", " ", "q2", " ", "t2", " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
    RowBox[{"2", " ", "l2", " ", "q1", " ", "q3", " ", "t2", " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
    RowBox[{"tx", " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q3", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q1", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q2", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.558773484084691*^9, 3.5587750840382147`*^9, 3.558781609706571*^9, 
   3.558787047320714*^9, 3.5588251314037523`*^9, 3.5588378610486097`*^9, 
   3.5698299242537208`*^9, 3.5719973199979105`*^9, 3.5720612703250923`*^9, 
   3.57206145455363*^9, 3.5720614885265727`*^9, 3.5720626160190616`*^9, 
   3.572082940398608*^9, 3.572097708743278*^9, 3.57209863943451*^9, 
   3.5721000056666546`*^9, 3.572101051056447*^9, 3.5721023502277555`*^9, 
   3.572315510882865*^9, 3.5723214441212263`*^9, 3.5723307682985067`*^9, 
   3.5723547064120426`*^9, 3.5729664073402615`*^9, 3.5741592234316406`*^9, 
   3.5741600801976447`*^9, 3.574733854882843*^9, 3.5749419700585084`*^9, 
   3.574965384328949*^9, 3.581088445772348*^9, 3.641860919419805*^9, {
   3.6418613920447683`*^9, 3.641861426122346*^9}, 3.641861496934346*^9, 
   3.641863132891968*^9, 3.641863793467149*^9, 3.64186414202956*^9, 
   3.641865110675727*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eq2", " ", "=", " ", 
   RowBox[{"Factor", "[", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"d", ",", " ", "\[Theta]2"}], "]"}], ",", " ", "algvars", ",", 
      " ", "FullSimplify"}], "]"}], "]"}]}], "\[IndentingNewLine]"}]], "Input",\

 CellChangeTimes->{{3.558074373968647*^9, 3.558074388579677*^9}, {
  3.5580744571006203`*^9, 3.558074478763012*^9}, {3.558773392592637*^9, 
  3.5587733935033207`*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", "r2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "q0", " ", "q3", " ", "r1", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{"2", " ", "l1", " ", "q0", " ", "q1", " ", "t1", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"2", " ", "l1", " ", "q2", " ", "q3", " ", "t1", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"2", " ", "q1", " ", "q2", " ", "tx", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"2", " ", "q0", " ", "q3", " ", "tx", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", "ty", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q1", "2"], " ", "ty", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q2", "2"], " ", "ty", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q3", "2"], " ", "ty", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"2", " ", "q0", " ", "q1", " ", "tz", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"2", " ", "q2", " ", "q3", " ", "tz", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"2", " ", "q1", " ", "q2", " ", "r1", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", "r1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q3", "2"], " ", "r1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{"2", " ", "l1", " ", "q0", " ", "q2", " ", "t1", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"2", " ", "l1", " ", "q1", " ", "q3", " ", "t1", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", "tx", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q1", "2"], " ", "tx", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q2", "2"], " ", "tx", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q3", "2"], " ", "tx", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"2", " ", "q1", " ", "q2", " ", "ty", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"2", " ", "q0", " ", "q3", " ", "ty", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"2", " ", "q0", " ", "q2", " ", "tz", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"2", " ", "q1", " ", "q3", " ", "tz", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q1", "2"], " ", "r1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q2", "2"], " ", "r1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.558771287008296*^9, 3.558772458873426*^9, 3.558772842561883*^9, {
   3.558773377220252*^9, 3.558773394266075*^9}, 3.558775087079199*^9, 
   3.558781614633267*^9, 3.558787049063971*^9, 3.558825133048872*^9, 
   3.558837863491074*^9, 3.5698299293190107`*^9, 3.5719973224260497`*^9, 
   3.5720612738562946`*^9, 3.5720614572657847`*^9, 3.5720614913347335`*^9, 
   3.572062618122182*^9, 3.572082941395665*^9, 3.572097711448433*^9, 
   3.572098640582576*^9, 3.572100007533761*^9, 3.5721010529755573`*^9, 
   3.5721023532129264`*^9, 3.572315514264058*^9, 3.572321446491362*^9, 
   3.572330769473574*^9, 3.5723547075061054`*^9, 3.572966409552388*^9, 
   3.574159225573763*^9, 3.574160081417714*^9, 3.574733855860899*^9, 
   3.57494197113457*^9, 3.574965385527017*^9, 3.581088447127425*^9, 
   3.641860919850519*^9, {3.6418613925155497`*^9, 3.6418614268664713`*^9}, 
   3.641861497363008*^9, 3.64186313295233*^9, 3.6418637935484*^9, 
   3.641864142244813*^9, 3.641865110713543*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq3", " ", "=", " ", 
  RowBox[{"Factor", "[", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"d", ",", " ", "t1"}], "]"}], ",", " ", "algvars"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5580744013003883`*^9, 3.558074405469269*^9}, 
   3.55870837743467*^9, 3.558708416285698*^9, {3.558773407055828*^9, 
   3.5587734080537367`*^9}, 3.558787081920381*^9, 3.558837870196101*^9}],

Cell[BoxData[
 RowBox[{"2", " ", "l1", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"l1", " ", "t1"}], "-", 
    RowBox[{"l2", " ", 
     SuperscriptBox["q0", "2"], " ", "t2"}], "+", 
    RowBox[{"l2", " ", 
     SuperscriptBox["q1", "2"], " ", "t2"}], "+", 
    RowBox[{"l2", " ", 
     SuperscriptBox["q2", "2"], " ", "t2"}], "-", 
    RowBox[{"l2", " ", 
     SuperscriptBox["q3", "2"], " ", "t2"}], "-", "tz", "+", 
    RowBox[{"2", " ", "q0", " ", "q2", " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"2", " ", "q1", " ", "q3", " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"2", " ", "q0", " ", "q1", " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"2", " ", "q2", " ", "q3", " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.558075707788279*^9, 3.55807575062318*^9, 3.558083370993641*^9, 
   3.558096910389751*^9, {3.558097032773487*^9, 3.558097037630073*^9}, 
   3.558175502569605*^9, 3.55870838132275*^9, 3.558708438288974*^9, 
   3.558753741128714*^9, 3.558771154071809*^9, 3.558771289187728*^9, 
   3.5587724602126102`*^9, 3.558772843938776*^9, {3.558773402491294*^9, 
   3.55877340919588*^9}, 3.558775095609807*^9, 3.558781625323029*^9, 
   3.5587870507468243`*^9, 3.558787082595313*^9, 3.558825134120995*^9, {
   3.558837865276832*^9, 3.5588378710101767`*^9}, 3.569829929891043*^9, 
   3.571997322491053*^9, 3.5720612764314413`*^9, 3.572061458128834*^9, 
   3.572061491816761*^9, 3.572062618744218*^9, 3.572082941492671*^9, 
   3.5720977121144705`*^9, 3.5720986407275844`*^9, 3.5721000082037992`*^9, 
   3.5721010531025643`*^9, 3.5721023540639753`*^9, 3.5723155144060664`*^9, 
   3.5723214467813787`*^9, 3.572330771695701*^9, 3.572354707612111*^9, 
   3.572966409633393*^9, 3.5741592257017703`*^9, 3.5741600815077195`*^9, 
   3.5747338559069014`*^9, 3.5749419711985736`*^9, 3.5749653856080217`*^9, 
   3.5810884472084303`*^9, 3.641860919873971*^9, {3.6418613925332003`*^9, 
   3.641861426889064*^9}, 3.641861497395442*^9, 3.641863132982596*^9, 
   3.641863793623884*^9, 3.6418641425492687`*^9, 3.641865110752755*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eq4", " ", "=", " ", 
   RowBox[{"Factor", "[", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"d", ",", " ", "t2"}], "]"}], ",", " ", "algvars"}], "]"}], 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5580743911825647`*^9, 3.558074416807541*^9}, {
   3.558773425006267*^9, 3.5587734266129627`*^9}, 3.5587870904717903`*^9, 
   3.558837873116452*^9}],

Cell[BoxData[
 RowBox[{"2", " ", "l2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "l1"}], " ", 
     SuperscriptBox["q0", "2"], " ", "t1"}], "+", 
    RowBox[{"l1", " ", 
     SuperscriptBox["q1", "2"], " ", "t1"}], "+", 
    RowBox[{"l1", " ", 
     SuperscriptBox["q2", "2"], " ", "t1"}], "-", 
    RowBox[{"l1", " ", 
     SuperscriptBox["q3", "2"], " ", "t1"}], "+", 
    RowBox[{"l2", " ", 
     SuperscriptBox["q0", "4"], " ", "t2"}], "+", 
    RowBox[{"2", " ", "l2", " ", 
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q1", "2"], " ", "t2"}], "+", 
    RowBox[{"l2", " ", 
     SuperscriptBox["q1", "4"], " ", "t2"}], "+", 
    RowBox[{"2", " ", "l2", " ", 
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q2", "2"], " ", "t2"}], "+", 
    RowBox[{"2", " ", "l2", " ", 
     SuperscriptBox["q1", "2"], " ", 
     SuperscriptBox["q2", "2"], " ", "t2"}], "+", 
    RowBox[{"l2", " ", 
     SuperscriptBox["q2", "4"], " ", "t2"}], "+", 
    RowBox[{"2", " ", "l2", " ", 
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q3", "2"], " ", "t2"}], "+", 
    RowBox[{"2", " ", "l2", " ", 
     SuperscriptBox["q1", "2"], " ", 
     SuperscriptBox["q3", "2"], " ", "t2"}], "+", 
    RowBox[{"2", " ", "l2", " ", 
     SuperscriptBox["q2", "2"], " ", 
     SuperscriptBox["q3", "2"], " ", "t2"}], "+", 
    RowBox[{"l2", " ", 
     SuperscriptBox["q3", "4"], " ", "t2"}], "+", 
    RowBox[{"2", " ", "q0", " ", "q2", " ", "tx"}], "+", 
    RowBox[{"2", " ", "q1", " ", "q3", " ", "tx"}], "-", 
    RowBox[{"2", " ", "q0", " ", "q1", " ", "ty"}], "+", 
    RowBox[{"2", " ", "q2", " ", "q3", " ", "ty"}], "+", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", "tz"}], "-", 
    RowBox[{
     SuperscriptBox["q1", "2"], " ", "tz"}], "-", 
    RowBox[{
     SuperscriptBox["q2", "2"], " ", "tz"}], "+", 
    RowBox[{
     SuperscriptBox["q3", "2"], " ", "tz"}], "-", 
    RowBox[{"2", " ", "q0", " ", "q2", " ", "r1", " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
    RowBox[{"2", " ", "q1", " ", "q3", " ", "r1", " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
    RowBox[{"2", " ", "q0", " ", "q1", " ", "r1", " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
    RowBox[{"2", " ", "q2", " ", "q3", " ", "r1", " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.558787549859593*^9, 3.558825136225856*^9, 3.558837873688485*^9, 
   3.569829931457133*^9, 3.5719973282723837`*^9, 3.5720612789845877`*^9, 
   3.5720614600849457`*^9, 3.572061492941825*^9, 3.5720626200462923`*^9, 
   3.572082941596677*^9, 3.5720977126885033`*^9, 3.572098641390622*^9, 
   3.572100008995845*^9, 3.5721010532275715`*^9, 3.5721023547180123`*^9, 
   3.5723155158131466`*^9, 3.572321447358412*^9, 3.572330773013777*^9, 
   3.572354709095196*^9, 3.5729664100424166`*^9, 3.5741592272328577`*^9, 
   3.5741600820507507`*^9, 3.574733855954904*^9, 3.5749419716035967`*^9, 
   3.574965385675026*^9, 3.581088447294435*^9, 3.6418609198954287`*^9, {
   3.641861392550837*^9, 3.641861426913501*^9}, 3.6418614974251003`*^9, 
   3.641863133005925*^9, 3.641863793706972*^9, 3.641864142696056*^9, 
   3.641865110770802*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq5", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"dgen", ",", " ", "s"}], "]"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6418616998161583`*^9, 3.6418617052311687`*^9}, {
  3.641861744939636*^9, 3.641861747812715*^9}, {3.641861954285232*^9, 
  3.64186196364456*^9}, {3.641863044820634*^9, 3.641863057097291*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", "l1", " ", "t1", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "s"}], "]"}]}], "+", 
  RowBox[{"4", " ", "q1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"q2", " ", "r2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "-", 
     RowBox[{"q3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"l2", " ", "t2", " ", 
         RowBox[{"Sin", "[", "s", "]"}]}], "+", 
        RowBox[{"2", " ", "r2", " ", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "s"}], "]"}]}]}], ")"}]}]}], ")"}]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"4", " ", "s"}], "]"}]}], "+", 
  RowBox[{"2", " ", "r1", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"s", "-", "\[Theta]1"}], "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "l2", " ", "t2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "s"}], "]"}]}], "+", 
     RowBox[{"r2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"s", "-", "\[Theta]2"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["q3", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", "l2", " ", "t2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "s"}], "]"}]}], "+", 
     RowBox[{"2", " ", "r2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"s", "-", "\[Theta]2"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"4", " ", "q2", " ", "q3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"l2", " ", "t2", " ", 
      RowBox[{"Cos", "[", "s", "]"}]}], "-", 
     RowBox[{"2", " ", "r2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "s"}], "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}], "-", 
  RowBox[{"4", " ", "q0", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "q3"}], " ", "r2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "+", 
     RowBox[{"l2", " ", "q2", " ", "t2", " ", 
      RowBox[{"Sin", "[", "s", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", "s", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"l2", " ", "q1", " ", "t2"}], "-", 
        RowBox[{"4", " ", "q2", " ", "r2", " ", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
         RowBox[{"Sin", "[", "s", "]"}]}], "+", 
        RowBox[{"4", " ", "q1", " ", "r2", " ", 
         RowBox[{"Sin", "[", "s", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
  
  RowBox[{
   SuperscriptBox["q1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", "l2", " ", "t2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "s"}], "]"}]}], "-", 
     RowBox[{"2", " ", "r2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"s", "+", "\[Theta]2"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q2", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "l2", " ", "t2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "s"}], "]"}]}], "+", 
     RowBox[{"r2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"s", "+", "\[Theta]2"}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.641861926174828*^9, 3.641862040057868*^9, 
  3.641863180668548*^9, 3.6418637942303467`*^9, 3.641864143321609*^9, 
  3.641865111187706*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq5fac", "=", 
  RowBox[{"FactorList", "[", "eq5", "]"}]}]], "Input",
 CellChangeTimes->{{3.641861976423572*^9, 3.641861986158144*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "l2", " ", "q0", " ", "q1", " ", "t2", " ", 
       RowBox[{"Cos", "[", "s", "]"}]}], "+", 
      RowBox[{"2", " ", "l2", " ", "q2", " ", "q3", " ", "t2", " ", 
       RowBox[{"Cos", "[", "s", "]"}]}], "+", 
      RowBox[{"2", " ", "q0", " ", "q3", " ", "r2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "+", 
      RowBox[{"2", " ", "q1", " ", "q2", " ", "r2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "-", 
      RowBox[{"2", " ", "l2", " ", "q0", " ", "q2", " ", "t2", " ", 
       RowBox[{"Sin", "[", "s", "]"}]}], "-", 
      RowBox[{"2", " ", "l2", " ", "q1", " ", "q3", " ", "t2", " ", 
       RowBox[{"Sin", "[", "s", "]"}]}], "+", 
      RowBox[{"8", " ", "q0", " ", "q2", " ", "r2", " ", 
       RowBox[{"Cos", "[", "s", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
       RowBox[{"Sin", "[", "s", "]"}]}], "+", 
      RowBox[{"2", " ", "l1", " ", "t1", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "s"}], "]"}]}], "-", 
      RowBox[{"2", " ", "l2", " ", 
       SuperscriptBox["q0", "2"], " ", "t2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "s"}], "]"}]}], "+", 
      RowBox[{"2", " ", "l2", " ", 
       SuperscriptBox["q1", "2"], " ", "t2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "s"}], "]"}]}], "+", 
      RowBox[{"2", " ", "l2", " ", 
       SuperscriptBox["q2", "2"], " ", "t2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "s"}], "]"}]}], "-", 
      RowBox[{"2", " ", "l2", " ", 
       SuperscriptBox["q3", "2"], " ", "t2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "s"}], "]"}]}], "-", 
      RowBox[{"4", " ", "q1", " ", "q3", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "s"}], "]"}]}], "-", 
      RowBox[{"Sin", "[", 
       RowBox[{"4", " ", "s"}], "]"}], "+", 
      RowBox[{"r1", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"s", "-", "\[Theta]1"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q0", "2"], " ", "r2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "-", 
      RowBox[{"8", " ", "q0", " ", "q1", " ", "r2", " ", 
       RowBox[{"Cos", "[", "s", "]"}], " ", 
       RowBox[{"Sin", "[", "s", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"4", " ", "q2", " ", "q3", " ", "r2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "s"}], "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q1", "2"], " ", "r2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q2", "2"], " ", "r2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"s", "+", "\[Theta]2"}], "]"}]}]}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.641862055819682*^9, 3.641863181313978*^9, 
  3.641863794380579*^9, 3.641864143420683*^9, 3.641865111209281*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq5a", "=", 
  RowBox[{
   RowBox[{"eq5fac", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}], "/.", "solt"}]}]], "Input",
 CellChangeTimes->{{3.6418620740457067`*^9, 3.6418620898812313`*^9}, 
   3.64186382731682*^9, {3.641865258869707*^9, 3.641865261714027*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "q0", " ", "q3", " ", "r2", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{"2", " ", "q1", " ", "q2", " ", "r2", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{"8", " ", "q0", " ", "q2", " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "-", 
  RowBox[{"4", " ", "q1", " ", "q3", " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "s"}], "]"}]}], "-", 
  RowBox[{"Sin", "[", 
   RowBox[{"4", " ", "s"}], "]"}], "+", 
  RowBox[{"r1", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"s", "-", "\[Theta]1"}], "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "r2", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "-", 
  RowBox[{"8", " ", "q0", " ", "q1", " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"4", " ", "q2", " ", "q3", " ", "r2", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "s"}], "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q1", "2"], "+", 
       SuperscriptBox["q2", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q3", "2"]}], ")"}]}]], 
   RowBox[{"q0", " ", "q1", " ", 
    RowBox[{"Cos", "[", "s", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q0", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q2"}], " ", "tx"}], "+", 
         RowBox[{"q1", " ", "ty"}]}], ")"}]}], "-", 
      RowBox[{"q3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q1", " ", "tx"}], "+", 
         RowBox[{"q2", " ", "ty"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q0", " ", "q2"}], "+", 
         RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q0"}], " ", "q1"}], "+", 
         RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q0", "2"], "-", 
         SuperscriptBox["q1", "2"], "-", 
         SuperscriptBox["q2", "2"], "+", 
         SuperscriptBox["q3", "2"]}], ")"}], " ", "r2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "q0"}], " ", "q2"}], "+", 
            RowBox[{"q1", " ", "q3"}]}], ")"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"q0", " ", "q1"}], "+", 
            RowBox[{"q2", " ", "q3"}]}], ")"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
  "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q1", "2"], "+", 
       SuperscriptBox["q2", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q3", "2"]}], ")"}]}]], 
   RowBox[{"q2", " ", "q3", " ", 
    RowBox[{"Cos", "[", "s", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q0", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q2"}], " ", "tx"}], "+", 
         RowBox[{"q1", " ", "ty"}]}], ")"}]}], "-", 
      RowBox[{"q3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q1", " ", "tx"}], "+", 
         RowBox[{"q2", " ", "ty"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q0", " ", "q2"}], "+", 
         RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q0"}], " ", "q1"}], "+", 
         RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q0", "2"], "-", 
         SuperscriptBox["q1", "2"], "-", 
         SuperscriptBox["q2", "2"], "+", 
         SuperscriptBox["q3", "2"]}], ")"}], " ", "r2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "q0"}], " ", "q2"}], "+", 
            RowBox[{"q1", " ", "q3"}]}], ")"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"q0", " ", "q1"}], "+", 
            RowBox[{"q2", " ", "q3"}]}], ")"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
  "-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q1", "2"], "+", 
       SuperscriptBox["q2", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q3", "2"]}], ")"}]}]], 
   RowBox[{"q0", " ", "q2", " ", 
    RowBox[{"Sin", "[", "s", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q0", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q2"}], " ", "tx"}], "+", 
         RowBox[{"q1", " ", "ty"}]}], ")"}]}], "-", 
      RowBox[{"q3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q1", " ", "tx"}], "+", 
         RowBox[{"q2", " ", "ty"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q0", " ", "q2"}], "+", 
         RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q0"}], " ", "q1"}], "+", 
         RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q0", "2"], "-", 
         SuperscriptBox["q1", "2"], "-", 
         SuperscriptBox["q2", "2"], "+", 
         SuperscriptBox["q3", "2"]}], ")"}], " ", "r2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "q0"}], " ", "q2"}], "+", 
            RowBox[{"q1", " ", "q3"}]}], ")"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"q0", " ", "q1"}], "+", 
            RowBox[{"q2", " ", "q3"}]}], ")"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
  "-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q1", "2"], "+", 
       SuperscriptBox["q2", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q3", "2"]}], ")"}]}]], 
   RowBox[{"q1", " ", "q3", " ", 
    RowBox[{"Sin", "[", "s", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q0", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q2"}], " ", "tx"}], "+", 
         RowBox[{"q1", " ", "ty"}]}], ")"}]}], "-", 
      RowBox[{"q3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q1", " ", "tx"}], "+", 
         RowBox[{"q2", " ", "ty"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q0", " ", "q2"}], "+", 
         RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q0"}], " ", "q1"}], "+", 
         RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q0", "2"], "-", 
         SuperscriptBox["q1", "2"], "-", 
         SuperscriptBox["q2", "2"], "+", 
         SuperscriptBox["q3", "2"]}], ")"}], " ", "r2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "q0"}], " ", "q2"}], "+", 
            RowBox[{"q1", " ", "q3"}]}], ")"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"q0", " ", "q1"}], "+", 
            RowBox[{"q2", " ", "q3"}]}], ")"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
  "-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q1", "2"], "+", 
       SuperscriptBox["q2", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q3", "2"]}], ")"}]}]], 
   RowBox[{
    SuperscriptBox["q0", "2"], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "s"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q0", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q2"}], " ", "tx"}], "+", 
         RowBox[{"q1", " ", "ty"}]}], ")"}]}], "-", 
      RowBox[{"q3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q1", " ", "tx"}], "+", 
         RowBox[{"q2", " ", "ty"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q0", " ", "q2"}], "+", 
         RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q0"}], " ", "q1"}], "+", 
         RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q0", "2"], "-", 
         SuperscriptBox["q1", "2"], "-", 
         SuperscriptBox["q2", "2"], "+", 
         SuperscriptBox["q3", "2"]}], ")"}], " ", "r2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "q0"}], " ", "q2"}], "+", 
            RowBox[{"q1", " ", "q3"}]}], ")"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"q0", " ", "q1"}], "+", 
            RowBox[{"q2", " ", "q3"}]}], ")"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
  "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q1", "2"], "+", 
       SuperscriptBox["q2", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q3", "2"]}], ")"}]}]], 
   RowBox[{
    SuperscriptBox["q1", "2"], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "s"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q0", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q2"}], " ", "tx"}], "+", 
         RowBox[{"q1", " ", "ty"}]}], ")"}]}], "-", 
      RowBox[{"q3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q1", " ", "tx"}], "+", 
         RowBox[{"q2", " ", "ty"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q0", " ", "q2"}], "+", 
         RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q0"}], " ", "q1"}], "+", 
         RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q0", "2"], "-", 
         SuperscriptBox["q1", "2"], "-", 
         SuperscriptBox["q2", "2"], "+", 
         SuperscriptBox["q3", "2"]}], ")"}], " ", "r2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "q0"}], " ", "q2"}], "+", 
            RowBox[{"q1", " ", "q3"}]}], ")"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"q0", " ", "q1"}], "+", 
            RowBox[{"q2", " ", "q3"}]}], ")"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
  "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q1", "2"], "+", 
       SuperscriptBox["q2", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q3", "2"]}], ")"}]}]], 
   RowBox[{
    SuperscriptBox["q2", "2"], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "s"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q0", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q2"}], " ", "tx"}], "+", 
         RowBox[{"q1", " ", "ty"}]}], ")"}]}], "-", 
      RowBox[{"q3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q1", " ", "tx"}], "+", 
         RowBox[{"q2", " ", "ty"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q0", " ", "q2"}], "+", 
         RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q0"}], " ", "q1"}], "+", 
         RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q0", "2"], "-", 
         SuperscriptBox["q1", "2"], "-", 
         SuperscriptBox["q2", "2"], "+", 
         SuperscriptBox["q3", "2"]}], ")"}], " ", "r2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "q0"}], " ", "q2"}], "+", 
            RowBox[{"q1", " ", "q3"}]}], ")"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"q0", " ", "q1"}], "+", 
            RowBox[{"q2", " ", "q3"}]}], ")"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
  "-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q1", "2"], "+", 
       SuperscriptBox["q2", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q3", "2"]}], ")"}]}]], 
   RowBox[{
    SuperscriptBox["q3", "2"], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "s"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q0", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q2"}], " ", "tx"}], "+", 
         RowBox[{"q1", " ", "ty"}]}], ")"}]}], "-", 
      RowBox[{"q3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q1", " ", "tx"}], "+", 
         RowBox[{"q2", " ", "ty"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q0", " ", "q2"}], "+", 
         RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q0"}], " ", "q1"}], "+", 
         RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q0", "2"], "-", 
         SuperscriptBox["q1", "2"], "-", 
         SuperscriptBox["q2", "2"], "+", 
         SuperscriptBox["q3", "2"]}], ")"}], " ", "r2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "q0"}], " ", "q2"}], "+", 
            RowBox[{"q1", " ", "q3"}]}], ")"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"q0", " ", "q1"}], "+", 
            RowBox[{"q2", " ", "q3"}]}], ")"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
  "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", "l2", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q1", "2"], "+", 
       SuperscriptBox["q2", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q3", "2"]}], ")"}]}]], 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "s"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "l2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q0", "2"], "-", 
         SuperscriptBox["q1", "2"], "-", 
         SuperscriptBox["q2", "2"], "+", 
         SuperscriptBox["q3", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"q0", " ", "q2", " ", "tx"}], "+", 
            RowBox[{"q1", " ", "q3", " ", "tx"}], "-", 
            RowBox[{"q0", " ", "q1", " ", "ty"}], "+", 
            RowBox[{"q2", " ", "q3", " ", "ty"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["q0", "2"], "-", 
            SuperscriptBox["q1", "2"], "-", 
            SuperscriptBox["q2", "2"], "+", 
            SuperscriptBox["q3", "2"]}], ")"}], " ", "tz"}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"q0", " ", "q2"}], "+", 
            RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r1", " ", 
          RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"q0", " ", "q1"}], "-", 
            RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r1", " ", 
          RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"l2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["q0", "2"], "+", 
          SuperscriptBox["q1", "2"], "+", 
          SuperscriptBox["q2", "2"], "+", 
          SuperscriptBox["q3", "2"]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"tz", "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "q0"}], " ", "q2"}], "+", 
            RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r2", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"q0", " ", "q1"}], "+", 
            RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r2", " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
  "-", 
  RowBox[{
   SuperscriptBox["q1", "2"], " ", "r2", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q2", "2"], " ", "r2", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"s", "+", "\[Theta]2"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.641862090555668*^9, 3.6418631814017773`*^9, 
  3.641863794651969*^9, 3.6418638277736387`*^9, 3.6418641434265223`*^9, 
  3.6418651112317543`*^9, 3.641865262644348*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq5b", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Numerator", "[", 
    RowBox[{"Together", "[", "eq5a", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.641862103733245*^9, 3.641862114951392*^9}, {
  3.641863097981172*^9, 3.64186311021487*^9}, {3.641865267852707*^9, 
  3.6418652692616167`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q0", " ", "q1"}], "-", 
       RowBox[{"q2", " ", "q3"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q0", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "q2"}], " ", "tx"}], "+", 
          RowBox[{"q1", " ", "ty"}]}], ")"}]}], "-", 
       RowBox[{"q3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q1", " ", "tx"}], "+", 
          RowBox[{"q2", " ", "ty"}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", "s", "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["q0", "2"], " ", "q1", " ", "q2"}], "+", 
       RowBox[{"q0", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["q1", "2"], "-", 
          SuperscriptBox["q2", "2"]}], ")"}], " ", "q3"}], "-", 
       RowBox[{"q1", " ", "q2", " ", 
        SuperscriptBox["q3", "2"]}]}], ")"}], " ", "r1", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"s", "+", "\[Theta]1"}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["q0", "3"], " ", 
     SuperscriptBox["q1", "2"], " ", "q3", " ", "r2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{"2", " ", "q0", " ", 
     SuperscriptBox["q1", "4"], " ", "q3", " ", "r2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["q0", "3"], " ", 
     SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{"4", " ", "q0", " ", 
     SuperscriptBox["q1", "2"], " ", 
     SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{"2", " ", "q0", " ", 
     SuperscriptBox["q2", "4"], " ", "q3", " ", "r2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{"2", " ", "q0", " ", 
     SuperscriptBox["q1", "2"], " ", 
     SuperscriptBox["q3", "3"], " ", "r2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{"2", " ", "q0", " ", 
     SuperscriptBox["q2", "2"], " ", 
     SuperscriptBox["q3", "3"], " ", "r2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["q0", "4"], " ", "q1", " ", "q2", " ", "r2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q1", "3"], " ", "q2", " ", "r2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["q0", "2"], " ", "q1", " ", 
     SuperscriptBox["q2", "3"], " ", "r2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", 
     SuperscriptBox["q3", "2"], " ", "r2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["q1", "3"], " ", "q2", " ", 
     SuperscriptBox["q3", "2"], " ", "r2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{"2", " ", "q1", " ", 
     SuperscriptBox["q2", "3"], " ", 
     SuperscriptBox["q3", "2"], " ", "r2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{"2", " ", "q1", " ", "q2", " ", 
     SuperscriptBox["q3", "4"], " ", "r2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q2", "2"], " ", "tx", " ", 
     RowBox[{"Sin", "[", "s", "]"}]}], "+", 
    RowBox[{"4", " ", "q0", " ", "q1", " ", "q2", " ", "q3", " ", "tx", " ", 
     RowBox[{"Sin", "[", "s", "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["q1", "2"], " ", 
     SuperscriptBox["q3", "2"], " ", "tx", " ", 
     RowBox[{"Sin", "[", "s", "]"}]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", "ty", " ", 
     RowBox[{"Sin", "[", "s", "]"}]}], "-", 
    RowBox[{"2", " ", "q0", " ", 
     SuperscriptBox["q1", "2"], " ", "q3", " ", "ty", " ", 
     RowBox[{"Sin", "[", "s", "]"}]}], "+", 
    RowBox[{"2", " ", "q0", " ", 
     SuperscriptBox["q2", "2"], " ", "q3", " ", "ty", " ", 
     RowBox[{"Sin", "[", "s", "]"}]}], "+", 
    RowBox[{"2", " ", "q1", " ", "q2", " ", 
     SuperscriptBox["q3", "2"], " ", "ty", " ", 
     RowBox[{"Sin", "[", "s", "]"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q1", "2"], " ", "tz", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "s"}], "]"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q2", "2"], " ", "tz", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "s"}], "]"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["q1", "2"], " ", 
     SuperscriptBox["q3", "2"], " ", "tz", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "s"}], "]"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["q2", "2"], " ", 
     SuperscriptBox["q3", "2"], " ", "tz", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "s"}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q1", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"4", " ", "s"}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q2", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"4", " ", "s"}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["q1", "2"], " ", 
     SuperscriptBox["q3", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"4", " ", "s"}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["q2", "2"], " ", 
     SuperscriptBox["q3", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"4", " ", "s"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q1", "2"], " ", "r1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "-", "\[Theta]1"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q2", "2"], " ", "r1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "-", "\[Theta]1"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q1", "2"], " ", 
     SuperscriptBox["q3", "2"], " ", "r1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "-", "\[Theta]1"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q2", "2"], " ", 
     SuperscriptBox["q3", "2"], " ", "r1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "-", "\[Theta]1"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q1", "2"], " ", "r1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "+", "\[Theta]1"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q2", "2"], " ", "r1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "+", "\[Theta]1"}], "]"}]}], "-", 
    RowBox[{"4", " ", "q0", " ", "q1", " ", "q2", " ", "q3", " ", "r1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "+", "\[Theta]1"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q1", "2"], " ", 
     SuperscriptBox["q3", "2"], " ", "r1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "+", "\[Theta]1"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q2", "2"], " ", 
     SuperscriptBox["q3", "2"], " ", "r1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "+", "\[Theta]1"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q0", "4"], " ", 
     SuperscriptBox["q1", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q1", "4"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q0", "4"], " ", 
     SuperscriptBox["q2", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q1", "2"], " ", 
     SuperscriptBox["q2", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q2", "4"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q1", "4"], " ", 
     SuperscriptBox["q3", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["q1", "2"], " ", 
     SuperscriptBox["q2", "2"], " ", 
     SuperscriptBox["q3", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q2", "4"], " ", 
     SuperscriptBox["q3", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q1", "2"], " ", 
     SuperscriptBox["q3", "4"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q2", "2"], " ", 
     SuperscriptBox["q3", "4"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "-", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q0", "4"], " ", 
     SuperscriptBox["q1", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q1", "4"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q0", "4"], " ", 
     SuperscriptBox["q2", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q2", "4"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q1", "2"], " ", 
     SuperscriptBox["q3", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q1", "4"], " ", 
     SuperscriptBox["q3", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q2", "2"], " ", 
     SuperscriptBox["q3", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q2", "4"], " ", 
     SuperscriptBox["q3", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q1", "2"], " ", 
     SuperscriptBox["q3", "4"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "+", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q2", "2"], " ", 
     SuperscriptBox["q3", "4"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", "+", "\[Theta]2"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.641862116704523*^9, 3.641863351837245*^9, 
  3.641863794979278*^9, 3.641863833172264*^9, 3.641864143889154*^9, 
  3.641865111454816*^9, 3.641865271461505*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq5c", "=", 
  RowBox[{"TrigExpand", "[", "eq5b", "]"}]}]], "Input",
 CellChangeTimes->{{3.641862121916759*^9, 3.64186215092039*^9}, {
  3.64186345243638*^9, 3.641863478413004*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", "tx", " ", 
   RowBox[{"Cos", "[", "s", "]"}]}], "+", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q1", "2"], " ", "q3", " ", "tx", " ", 
   RowBox[{"Cos", "[", "s", "]"}]}], "-", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q2", "2"], " ", "q3", " ", "tx", " ", 
   RowBox[{"Cos", "[", "s", "]"}]}], "-", 
  RowBox[{"q1", " ", "q2", " ", 
   SuperscriptBox["q3", "2"], " ", "tx", " ", 
   RowBox[{"Cos", "[", "s", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", "ty", " ", 
   RowBox[{"Cos", "[", "s", "]"}]}], "+", 
  RowBox[{"2", " ", "q0", " ", "q1", " ", "q2", " ", "q3", " ", "ty", " ", 
   RowBox[{"Cos", "[", "s", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "ty", " ", 
   RowBox[{"Cos", "[", "s", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", "r1", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q1", "2"], " ", "q3", " ", "r1", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q2", "2"], " ", "q3", " ", "r1", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"q1", " ", "q2", " ", 
   SuperscriptBox["q3", "2"], " ", "r1", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "4"], " ", "q1", " ", "q2", " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "3"], " ", "q2", " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "q1", " ", 
   SuperscriptBox["q2", "3"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "3"], " ", 
   SuperscriptBox["q1", "2"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q1", "4"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "3"], " ", 
   SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", "q0", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q2", "4"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q1", "3"], " ", "q2", " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q1", " ", 
   SuperscriptBox["q2", "3"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q3", "3"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "3"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q1", " ", "q2", " ", 
   SuperscriptBox["q3", "4"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "tx", " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "+", 
  RowBox[{"2", " ", "q0", " ", "q1", " ", "q2", " ", "q3", " ", "tx", " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "tx", " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", "ty", " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "-", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q1", "2"], " ", "q3", " ", "ty", " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "+", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q2", "2"], " ", "q3", " ", "ty", " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "+", 
  RowBox[{"q1", " ", "q2", " ", 
   SuperscriptBox["q3", "2"], " ", "ty", " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", "tz", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "tz", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "tz", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "tz", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "-", 
  RowBox[{"4", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "s", "]"}], "3"], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "-", 
  RowBox[{"4", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "s", "]"}], "3"], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "-", 
  RowBox[{"4", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "s", "]"}], "3"], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "-", 
  RowBox[{"4", " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "s", "]"}], "3"], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "-", 
  RowBox[{"2", " ", "q0", " ", "q1", " ", "q2", " ", "q3", " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q0", "4"], " ", 
   SuperscriptBox["q1", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "4"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q2", "4"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "4"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "s", "]"}]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "s", "]"}], "3"]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "s", "]"}], "3"]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "s", "]"}], "3"]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "s", "]"}], "3"]}], "-", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "r1", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"2", " ", "q0", " ", "q1", " ", "q2", " ", "q3", " ", "r1", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "r1", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", "r1", " ", 
   RowBox[{"Sin", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q1", "2"], " ", "q3", " ", "r1", " ", 
   RowBox[{"Sin", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q2", "2"], " ", "q3", " ", "r1", " ", 
   RowBox[{"Sin", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"q1", " ", "q2", " ", 
   SuperscriptBox["q3", "2"], " ", "r1", " ", 
   RowBox[{"Sin", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "4"], " ", 
   SuperscriptBox["q2", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q2", "4"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q1", "4"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q3", "4"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q0", "4"], " ", "q1", " ", "q2", " ", "r2", " ", 
   RowBox[{"Sin", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "3"], " ", "q2", " ", "r2", " ", 
   RowBox[{"Sin", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "q1", " ", 
   SuperscriptBox["q2", "3"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "3"], " ", 
   SuperscriptBox["q1", "2"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Sin", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q1", "4"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Sin", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "3"], " ", 
   SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Sin", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", "q0", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Sin", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q2", "4"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Sin", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q1", "3"], " ", "q2", " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"q1", " ", 
   SuperscriptBox["q2", "3"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q3", "3"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "3"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"q1", " ", "q2", " ", 
   SuperscriptBox["q3", "4"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "s", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.641862139866935*^9, 3.6418621513682947`*^9}, 
   3.641863351882348*^9, {3.641863453012185*^9, 3.641863479940466*^9}, 
   3.641863795053686*^9, 3.641863838619364*^9, 3.6418641441009903`*^9, 
   3.641865111486445*^9, 3.641865276523098*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Exponent", "[", 
  RowBox[{"eq5c", ",", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.641863482044476*^9, 3.641863500788909*^9}, {
  3.6418638440378942`*^9, 3.6418638516643953`*^9}, {3.6418652868933773`*^9, 
  3.641865293296567*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.641863489881106*^9, 3.641863501195835*^9}, 
   3.641863795062971*^9, {3.641863841184958*^9, 3.6418638522222557`*^9}, 
   3.641864144107925*^9, 3.641865111509308*^9, {3.64186528139261*^9, 
   3.641865293790636*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"size", "[", "eq5", "]"}]], "Input",
 CellChangeTimes->{{3.641861929385388*^9, 3.641861932808899*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Size of the expression is:\"\>", "\[InvisibleSpace]", "5.688`",
    "\[InvisibleSpace]", "\<\" KB.\"\>"}],
  SequenceForm["Size of the expression is:", 5.688, " KB."],
  Editable->False]], "Print",
 CellChangeTimes->{3.6418619332490463`*^9, 3.641863351899652*^9, 
  3.641863795142385*^9, 3.641864144207164*^9, 3.64186511153349*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", " ", "=", " ", 
   RowBox[{"TrigExpand", "[", 
    RowBox[{"eq1", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "r1"}], " ", ")"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"-", "r1"}], " ", "can", " ", "be", " ", "factored", " ", "out", 
    " ", "as", " ", "seen", " ", "in", " ", "eq1"}], " ", "*)"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"f2", " ", "=", " ", 
   RowBox[{"TrigExpand", "[", 
    RowBox[{"eq2", "/", 
     RowBox[{"(", 
      RowBox[{"2", "r2"}], "   ", ")"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"-", "r2"}], " ", "can", " ", "be", " ", "factored", " ", "out", 
    " ", "as", " ", "seen", " ", "in", " ", "eq2"}], " ", "*)"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"f3", " ", "=", " ", 
   RowBox[{"TrigExpand", "[", 
    RowBox[{"eq3", "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", "l1"}], "  ", ")"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
   "2", " ", "l1", " ", "can", " ", "be", " ", "factored", " ", "out", " ", 
    "as", " ", "seen", " ", "in", " ", "eq3"}], " ", "*)"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"f4", " ", "=", " ", 
   RowBox[{"TrigExpand", "[", 
    RowBox[{"eq4", "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", "l2"}], " ", ")"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
   "2", " ", "l2", " ", "can", " ", "be", " ", "factored", " ", "out", " ", 
    "as", " ", "seen", " ", "in", " ", "eq4"}], " ", "*)"}], ";"}]}], "Input",\

 CellChangeTimes->{{3.5580744196122627`*^9, 3.558074448476202*^9}, 
   3.5580745428124313`*^9, {3.558096923248156*^9, 3.558096923918198*^9}, 
   3.55817551056384*^9, {3.558708448092165*^9, 3.5587084484363127`*^9}, {
   3.558773490487608*^9, 3.558773491978403*^9}, 3.55877510185742*^9, 
   3.5587816491789417`*^9, 3.5587870955272017`*^9, {3.5698306893804836`*^9, 
   3.569830710763706*^9}, 3.5720612842268877`*^9, {3.574159230916068*^9, 
   3.574159240852637*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solt", "=", 
  RowBox[{"FullSimplify", "[", " ", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f3", ",", "f4"}], "}"}], " ", "\[Equal]", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"t1", ",", "t2"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "two", " ", "equations", " ", "linear", " ", "in", " ", "t1", " ", "and", 
    " ", "t2", " ", "are", " ", "solved", " ", "simultaneously"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.5580749122473717`*^9, 3.5580749735675898`*^9}, {
   3.558075121534004*^9, 3.558075123626783*^9}, {3.558175545397298*^9, 
   3.558175548263546*^9}, {3.5587085057971373`*^9, 3.558708509507172*^9}, {
   3.558771841030569*^9, 3.558771993647889*^9}, {3.558772187384592*^9, 
   3.558772197069064*^9}, {3.558772568755226*^9, 3.5587725886783743`*^9}, {
   3.5587728958109283`*^9, 3.558772923848027*^9}, {3.558773009241201*^9, 
   3.558773031634039*^9}, {3.558775142055781*^9, 3.558775144231162*^9}, {
   3.558787888701654*^9, 3.558787896789309*^9}, {3.558825164346663*^9, 
   3.558825166617366*^9}, {3.558837886933154*^9, 3.558837888110662*^9}, 
   3.55883794883505*^9, {3.569830758854457*^9, 3.569830786861059*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"t1", "\[Rule]", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"4", " ", "l1", " ", "l2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q1", "2"], "+", 
         SuperscriptBox["q2", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q0", "2"], "+", 
         SuperscriptBox["q3", "2"]}], ")"}]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "l2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["q0", "2"], "-", 
          SuperscriptBox["q1", "2"], "-", 
          SuperscriptBox["q2", "2"], "+", 
          SuperscriptBox["q3", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"q0", " ", "q2", " ", "tx"}], "+", 
             RowBox[{"q1", " ", "q3", " ", "tx"}], "-", 
             RowBox[{"q0", " ", "q1", " ", "ty"}], "+", 
             RowBox[{"q2", " ", "q3", " ", "ty"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["q0", "2"], "-", 
             SuperscriptBox["q1", "2"], "-", 
             SuperscriptBox["q2", "2"], "+", 
             SuperscriptBox["q3", "2"]}], ")"}], " ", "tz"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"q0", " ", "q2"}], "+", 
             RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r1", " ", 
           RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"q0", " ", "q1"}], "-", 
             RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r1", " ", 
           RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], ")"}]}], "+", 
       RowBox[{"l2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["q0", "2"], "+", 
           SuperscriptBox["q1", "2"], "+", 
           SuperscriptBox["q2", "2"], "+", 
           SuperscriptBox["q3", "2"]}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"tz", "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "q0"}], " ", "q2"}], "+", 
             RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r2", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"q0", " ", "q1"}], "+", 
             RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r2", " ", 
           RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
   ",", 
   RowBox[{"t2", "\[Rule]", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", " ", "l2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q1", "2"], "+", 
         SuperscriptBox["q2", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q0", "2"], "+", 
         SuperscriptBox["q3", "2"]}], ")"}]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q0", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "q2"}], " ", "tx"}], "+", 
          RowBox[{"q1", " ", "ty"}]}], ")"}]}], "-", 
       RowBox[{"q3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q1", " ", "tx"}], "+", 
          RowBox[{"q2", " ", "ty"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q0", " ", "q2"}], "+", 
          RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r1", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "q0"}], " ", "q1"}], "+", 
          RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r1", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["q0", "2"], "-", 
          SuperscriptBox["q1", "2"], "-", 
          SuperscriptBox["q2", "2"], "+", 
          SuperscriptBox["q3", "2"]}], ")"}], " ", "r2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "q0"}], " ", "q2"}], "+", 
             RowBox[{"q1", " ", "q3"}]}], ")"}], " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"q0", " ", "q1"}], "+", 
             RowBox[{"q2", " ", "q3"}]}], ")"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}]}]}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.558075761318028*^9, 3.558083390818747*^9, 3.558096967460684*^9, 
   3.558097067851766*^9, 3.558175558448155*^9, 3.558708519963051*^9, 
   3.558710370870763*^9, 3.558753753460732*^9, {3.558771846064519*^9, 
   3.558771888796585*^9}, 3.558771941185425*^9, {3.558771983360647*^9, 
   3.5587719940228662`*^9}, 3.558772210568729*^9, 3.558772599962852*^9, {
   3.558772907663917*^9, 3.558772924903552*^9}, {3.558773027702991*^9, 
   3.558773041239002*^9}, 3.558775154979561*^9, 3.5587879090173187`*^9, 
   3.558825176416081*^9, {3.558837881720862*^9, 3.5588378980948753`*^9}, 
   3.5588379498416023`*^9, 3.5698299591127143`*^9, 3.5719974383656807`*^9, 
   3.572061303631997*^9, 3.5720614762478704`*^9, 3.5720615132829885`*^9, 
   3.572061598733876*^9, 3.572062640701473*^9, 3.5720829586036496`*^9, 
   3.572097733181676*^9, 3.572098661409767*^9, 3.572100030555078*^9, 
   3.572101073295719*^9, 3.572102374134123*^9, 3.5723155374173822`*^9, 
   3.5723214680355945`*^9, 3.5723307942339907`*^9, 3.5723547302814083`*^9, 
   3.5729664295005293`*^9, 3.5741592555754786`*^9, 3.5741600968385963`*^9, 
   3.574733868911645*^9, 3.574941987449503*^9, 3.5749654007098856`*^9, 
   3.5810884634073563`*^9, 3.641860925232436*^9, {3.641861396424864*^9, 
   3.641861432395525*^9}, 3.641861502934197*^9, 3.641863371675446*^9, 
   3.641863801469296*^9, 3.6418641508167686`*^9, 3.641865117022538*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"g1", " ", "=", " ", 
   RowBox[{"Factor", "[", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{"Numerator", "[", 
        RowBox[{"Together", "[", 
         RowBox[{"f1", "/.", "solt"}], "]"}], "]"}], ",", " ", "algvars", ",",
        " ", "FullSimplify"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "substituting", " ", "t1", " ", "and", " ", "t2", " ", "back", " ", "in", 
    " ", "f1"}], "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.558075015702835*^9, 3.558075111043756*^9}, {
   3.5580751626656723`*^9, 3.5580753035533323`*^9}, 3.558837956778389*^9, {
   3.569830231898317*^9, 3.5698302332233925`*^9}, {3.569830810104388*^9, 
   3.5698308201239614`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"q0", " ", "q2", " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
    RowBox[{"q1", " ", "q3", " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
    RowBox[{"q0", " ", "q1", " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
    RowBox[{"q2", " ", "q3", " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"q0", " ", "q1", " ", "tx"}], "-", 
    RowBox[{"q2", " ", "q3", " ", "tx"}], "+", 
    RowBox[{"q0", " ", "q2", " ", "ty"}], "+", 
    RowBox[{"q1", " ", "q3", " ", "ty"}], "-", 
    RowBox[{"q0", " ", "q1", " ", "r1", " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
    RowBox[{"q2", " ", "q3", " ", "r1", " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q0", "3"], " ", "q1", " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"q0", " ", 
     SuperscriptBox["q1", "3"], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"q0", " ", "q1", " ", 
     SuperscriptBox["q2", "2"], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", "q2", " ", "q3", " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q1", "2"], " ", "q2", " ", "q3", " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q2", "3"], " ", "q3", " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"q0", " ", "q1", " ", 
     SuperscriptBox["q3", "2"], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"q2", " ", 
     SuperscriptBox["q3", "3"], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"q0", " ", "q2", " ", "r1", " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
    RowBox[{"q1", " ", "q3", " ", "r1", " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q0", "3"], " ", "q2", " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"q0", " ", 
     SuperscriptBox["q1", "2"], " ", "q2", " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"q0", " ", 
     SuperscriptBox["q2", "3"], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", "q1", " ", "q3", " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q1", "3"], " ", "q3", " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"q1", " ", 
     SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"q0", " ", "q2", " ", 
     SuperscriptBox["q3", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"q1", " ", 
     SuperscriptBox["q3", "3"], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.5698302663522873`*^9, 3.571997456060693*^9, 
  3.5720613851756616`*^9, 3.5720615338041625`*^9, 3.5720616182549925`*^9, 
  3.5720626694161158`*^9, 3.572082975645624*^9, 3.572097751287711*^9, 
  3.572098679029775*^9, 3.5721000620518794`*^9, 3.572101090316693*^9, 
  3.5721023904630566`*^9, 3.5723155544763584`*^9, 3.572321485741607*^9, 
  3.572330813052067*^9, 3.5723547466413436`*^9, 3.57296644595547*^9, 
  3.5741592720644217`*^9, 3.574160113934574*^9, 3.574733885970621*^9, 
  3.5749654184879026`*^9, 3.5810884829674754`*^9, 3.641860932598589*^9, 
  3.6418614347819233`*^9, 3.641861510483922*^9, 3.641863374199366*^9, 
  3.6418638034541683`*^9, 3.6418641530050917`*^9, 3.641865118684554*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"g2", " ", "=", " ", 
  RowBox[{
   RowBox[{"Factor", "[", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{"Numerator", "[", 
        RowBox[{"Together", "[", 
         RowBox[{"f2", "/.", "solt"}], "]"}], "]"}], ",", " ", "algvars", ",",
        " ", "FullSimplify"}], "]"}], "]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["q0", "2"], "+", 
      SuperscriptBox["q1", "2"], "+", 
      SuperscriptBox["q2", "2"], "+", 
      SuperscriptBox["q3", "2"]}], "\[Rule]", "1"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "substituting", " ", "t1", " ", "and", " ", "t2", " ", "back", " ", "in", 
    " ", "f2"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5580753112720947`*^9, 3.5580753162667503`*^9}, 
   3.5588379610483847`*^9, {3.569830274993782*^9, 3.5698302760918446`*^9}, {
   3.569830824223196*^9, 3.5698308268483458`*^9}, {3.5721010932448606`*^9, 
   3.572101105427557*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "q0"}], " ", "q2", " ", 
      RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
     RowBox[{"q1", " ", "q3", " ", 
      RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
     RowBox[{"q0", " ", "q1", " ", 
      RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
     RowBox[{"q2", " ", "q3", " ", 
      RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"q0", " ", "q1", " ", "tx"}], "-", 
    RowBox[{"q2", " ", "q3", " ", "tx"}], "+", 
    RowBox[{"q0", " ", "q2", " ", "ty"}], "+", 
    RowBox[{"q1", " ", "q3", " ", "ty"}], "-", 
    RowBox[{"q0", " ", "q1", " ", "r1", " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
    RowBox[{"q2", " ", "q3", " ", "r1", " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q0", "3"], " ", "q1", " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"q0", " ", 
     SuperscriptBox["q1", "3"], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"q0", " ", "q1", " ", 
     SuperscriptBox["q2", "2"], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", "q2", " ", "q3", " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q1", "2"], " ", "q2", " ", "q3", " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q2", "3"], " ", "q3", " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"q0", " ", "q1", " ", 
     SuperscriptBox["q3", "2"], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"q2", " ", 
     SuperscriptBox["q3", "3"], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"q0", " ", "q2", " ", "r1", " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
    RowBox[{"q1", " ", "q3", " ", "r1", " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q0", "3"], " ", "q2", " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"q0", " ", 
     SuperscriptBox["q1", "2"], " ", "q2", " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"q0", " ", 
     SuperscriptBox["q2", "3"], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", "q1", " ", "q3", " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q1", "3"], " ", "q3", " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"q1", " ", 
     SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"q0", " ", "q2", " ", 
     SuperscriptBox["q3", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"q1", " ", 
     SuperscriptBox["q3", "3"], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.5721011153671255`*^9, 3.5721024001996136`*^9, 
  3.57231556429992*^9, 3.572321496400217*^9, 3.5723308238706856`*^9, 
  3.572354756578912*^9, 3.572966456018046*^9, 3.574159282150999*^9, 
  3.5741601244101734`*^9, 3.5747338963772163`*^9, 3.5749654283314657`*^9, 
  3.5810884949751625`*^9, 3.64186093682513*^9, 3.641861514629208*^9, 
  3.641863376456608*^9, 3.641863804451214*^9, 3.641864154057334*^9, 
  3.641865119413456*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"solvetrig1", "[", 
    RowBox[{"eq_", ",", " ", "\[Theta]_", ",", 
     RowBox[{"simplify_:", " ", "Identity"}]}], "]"}], ":=", " ", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Inputs", " ", "are", " ", "the", " ", "equation", " ", "and", " ", "the",
      " ", "angle", " ", "\[Theta]"}], "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Solves", " ", "the", " ", "equation", " ", "a", " ", "cos", " ", 
       RowBox[{"(", "\[Theta]", ")"}]}], " ", "+", " ", 
      RowBox[{"b", " ", "sin", " ", 
       RowBox[{"(", "\[Theta]", ")"}]}], " ", "+", " ", "c"}], " ", "=", " ", 
     "0"}], " ", "*)"}], "\n", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "t1", ",", " ", "t2", ",", "a", ",", "b", ",", "c", ",", "\[Alpha]", 
       ",", "\[Phi]", ",", "sol\[Theta]"}], "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{"t1", " ", "=", " ", 
       RowBox[{"simplify", "[", 
        RowBox[{"Numerator", "[", 
         RowBox[{"Together", "[", "eq", "]"}], "]"}], "]"}]}], ";", "\n", 
      RowBox[{"t2", " ", "=", " ", 
       RowBox[{"TrigExpand", "[", "t1", "]"}]}], ";", "\n", "\n", 
      RowBox[{"a", "=", 
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{"eq", ",", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], "//", 
        "Simplify"}]}], ";", "\n", 
      RowBox[{"b", "=", 
       RowBox[{"Coefficient", "[", 
        RowBox[{"eq", ",", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"c", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"eq", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]", "]"}], "->", " ", "0"}], ",", " ", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Theta]", "]"}], "->", " ", "0"}]}], 
          "}"}]}], "]"}]}], "  ", ";", "\n", "\n", 
      RowBox[{"\[Alpha]", " ", "=", 
       RowBox[{"ArcTan", "[", " ", 
        RowBox[{
         RowBox[{"a", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"a", "^", "2"}], "+", 
            RowBox[{"b", "^", "2"}]}], "]"}]}], ",", 
         RowBox[{"b", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"a", "^", "2"}], "+", 
            RowBox[{"b", "^", "2"}]}], "]"}]}]}], "]"}]}], ";", "\n", 
      RowBox[{"\[Phi]", "=", " ", 
       RowBox[{"ArcCos", "[", 
        RowBox[{
         RowBox[{"-", "c"}], "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"a", "^", "2"}], " ", "+", " ", 
           RowBox[{"b", "^", "2"}]}], "]"}]}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"sol\[Theta]", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Theta]", "->", " ", 
           RowBox[{"\[Alpha]", " ", "+", " ", "\[Phi]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", "->", " ", 
           RowBox[{"\[Alpha]", " ", "-", " ", "\[Phi]"}]}], "}"}]}], "}"}]}], 
      ";", "\n", 
      RowBox[{"Return", "[", "sol\[Theta]", "]"}], ";"}]}], "\n", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"solvetrig2", "[", 
     RowBox[{"eq1_", ",", "eq2_", ",", " ", "\[Theta]_", ",", 
      RowBox[{"simplify_:", " ", "Identity"}]}], "]"}], ":=", " ", "\n", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Inputs", " ", "are", " ", "the", " ", "equations"}], " ", ",", 
      
      RowBox[{
      "the", " ", "angle", " ", "\[Theta]", " ", "and", " ", "an", " ", 
       "operator", " ", "x", " ", "which", " ", "decides", " ", "which", " ", 
       "output", " ", "has", " ", "to", " ", "be", " ", "returned"}]}], 
     "*)"}], "\n", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
        "Solves", " ", "the", " ", "equation", " ", "a1", " ", "cos", " ", 
         RowBox[{"(", "\[Theta]", ")"}]}], " ", "+", " ", 
        RowBox[{"b1", " ", "sin", " ", 
         RowBox[{"(", "\[Theta]", ")"}]}], " ", "+", " ", "c1"}], " ", "=", 
       " ", "0"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"a2", " ", "cos", " ", 
         RowBox[{"(", "\[Theta]", ")"}]}], " ", "+", " ", 
        RowBox[{"b2", " ", "sin", " ", 
         RowBox[{"(", "\[Theta]", ")"}]}], " ", "+", " ", "c2"}], " ", "=", 
       " ", "0"}]}], "  ", "*)"}], "\n", 
    RowBox[{"(*", " ", 
     RowBox[{"TODO", ":", " ", 
      RowBox[{
      "check", " ", "if", " ", "the", " ", "input", " ", "equation", " ", 
       "can", " ", "be", " ", "actually", " ", "cast", " ", "in", " ", "the", 
       " ", "desired", " ", "form"}]}], " ", "*)"}], "\n", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t1", ",", " ", "t2", ",", "t11", ",", "t22", ",", " ", "sol", ",", 
        " ", "sol\[Theta]", ",", "con"}], "}"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"t1", " ", "=", " ", 
        RowBox[{"simplify", "[", 
         RowBox[{"Numerator", "[", 
          RowBox[{"Together", "[", "eq1", "]"}], "]"}], "]"}]}], ";", "\n", 
       RowBox[{"t2", " ", "=", " ", 
        RowBox[{"TrigExpand", "[", "t1", "]"}]}], ";", "\n", "\n", 
       RowBox[{"t11", " ", "=", " ", 
        RowBox[{"simplify", "[", 
         RowBox[{"Numerator", "[", 
          RowBox[{"Together", "[", "eq2", "]"}], "]"}], "]"}]}], ";", "\n", 
       RowBox[{"t22", " ", "=", " ", 
        RowBox[{"TrigExpand", "[", "t11", "]"}]}], ";", "\n", 
       RowBox[{"sol", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t2", ",", " ", "t22"}], "}"}], " ", "==", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\n", "\n", 
       RowBox[{"sol\[Theta]", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Theta]", " ", "->", " ", 
           RowBox[{"ArcTan", "[", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "]"}]}], "}"}], "/.", 
         "sol"}]}], ";", "\n", 
       RowBox[{"con", "=", 
        RowBox[{"Numerator", "[", 
         RowBox[{"simplify", "[", 
          RowBox[{"Expand", "[", 
           RowBox[{"Together", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", "\[Theta]", "]"}], "^", "2"}], " ", "+", 
               " ", 
               RowBox[{
                RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", "2"}], " ", "-", 
               " ", "1"}], ")"}], "/.", "sol"}], "]"}], "]"}], "]"}], "]"}]}],
        ";", "\n", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"sol\[Theta]", ",", "con"}], "}"}], "]"}], ";"}]}], "\n", 
     " ", "\n", "]"}]}], ";"}], "\n"}], "\n"}], "Input",
 CellChangeTimes->{{3.5580774360905743`*^9, 3.558077440174471*^9}, {
  3.5580831468622303`*^9, 3.5580831607612867`*^9}, {3.5580832006640043`*^9, 
  3.558083223331644*^9}, {3.558220496443914*^9, 3.5582204970192413`*^9}, {
  3.5587503292200193`*^9, 3.5587503622785063`*^9}, {3.574159778620395*^9, 
  3.5741597788454084`*^9}, {3.5741598100041904`*^9, 3.5741598112272606`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Note", " ", "the", " ", "various", " ", "factors", " ", "of", " ", "g1", 
     " ", "and", " ", 
     RowBox[{"g2", ".", " ", "Instead"}], " ", "of", " ", "looking", " ", 
     "at", " ", "solutions", " ", "of", " ", "g1", " ", "and", " ", "g2"}], 
    ",", " ", 
    RowBox[{
    "look", " ", "at", " ", "the", " ", "solutions", " ", "of", " ", 
     "factors", " ", "of", " ", "g1", " ", "and", " ", "g2"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"tmp1", "=", 
    RowBox[{"FactorList", "[", "g1", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"tmp2", "=", 
    RowBox[{"FactorList", "[", "g2", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.5580774360905743`*^9, 3.558077440174471*^9}, {
  3.5580831468622303`*^9, 3.5580831607612867`*^9}, {3.5580832006640043`*^9, 
  3.558083229738935*^9}, {3.558083413336578*^9, 3.558083423446616*^9}, {
  3.5580837581018267`*^9, 3.558083782558837*^9}, {3.5698308415421867`*^9, 
  3.5698308787133126`*^9}, {3.569830924630939*^9, 3.569830974489791*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"q0", " ", "q2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"q1", " ", "q3", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{"q0", " ", "q1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"q2", " ", "q3", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"q0", " ", "q1", " ", "tx"}], "-", 
      RowBox[{"q2", " ", "q3", " ", "tx"}], "+", 
      RowBox[{"q0", " ", "q2", " ", "ty"}], "+", 
      RowBox[{"q1", " ", "q3", " ", "ty"}], "-", 
      RowBox[{"q0", " ", "q1", " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"q2", " ", "q3", " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q0", "3"], " ", "q1", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q0", " ", 
       SuperscriptBox["q1", "3"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q0", " ", "q1", " ", 
       SuperscriptBox["q2", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q0", "2"], " ", "q2", " ", "q3", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q1", "2"], " ", "q2", " ", "q3", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q2", "3"], " ", "q3", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q0", " ", "q1", " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q2", " ", 
       SuperscriptBox["q3", "3"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"q0", " ", "q2", " ", "r1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{"q1", " ", "q3", " ", "r1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q0", "3"], " ", "q2", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q0", " ", 
       SuperscriptBox["q1", "2"], " ", "q2", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q0", " ", 
       SuperscriptBox["q2", "3"], " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q0", "2"], " ", "q1", " ", "q3", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q1", "3"], " ", "q3", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"q1", " ", 
       SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q0", " ", "q2", " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"q1", " ", 
       SuperscriptBox["q3", "3"], " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.558083783992363*^9, {3.558097088447268*^9, 3.558097091387961*^9}, 
   3.558175601295726*^9, 3.558220542611833*^9, 3.558708595988408*^9, {
   3.558753771220283*^9, 3.558753790820266*^9}, 3.5587720182963133`*^9, 
   3.55877222247858*^9, 3.558772627095003*^9, 3.558773068474074*^9, 
   3.5587751765691643`*^9, 3.5587880373200274`*^9, 3.558825186677043*^9, 
   3.5588379672501507`*^9, 3.569830303025385*^9, 3.571997467492347*^9, 
   3.572061644635502*^9, 3.572062716078785*^9, 3.572082985619195*^9, 
   3.572097761808313*^9, 3.572098689238359*^9, 3.572100072114455*^9, 
   3.572101115517134*^9, 3.5721024004126263`*^9, 3.572315564498932*^9, 
   3.57232149664023*^9, 3.5723308240746975`*^9, 3.572354756773923*^9, 
   3.572966456110051*^9, 3.5741592822640057`*^9, 3.574160124549181*^9, 
   3.5747338964382195`*^9, 3.5810884951401715`*^9, 3.641860936864429*^9, 
   3.6418615146759157`*^9, 3.641863376492045*^9, 3.641863804638232*^9, 
   3.6418641542384577`*^9, 3.641865119470147*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"q0", " ", "q2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"q1", " ", "q3", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"q0", " ", "q1", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"q2", " ", "q3", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"q0", " ", "q1", " ", "tx"}], "-", 
      RowBox[{"q2", " ", "q3", " ", "tx"}], "+", 
      RowBox[{"q0", " ", "q2", " ", "ty"}], "+", 
      RowBox[{"q1", " ", "q3", " ", "ty"}], "-", 
      RowBox[{"q0", " ", "q1", " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"q2", " ", "q3", " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q0", "3"], " ", "q1", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q0", " ", 
       SuperscriptBox["q1", "3"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q0", " ", "q1", " ", 
       SuperscriptBox["q2", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q0", "2"], " ", "q2", " ", "q3", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q1", "2"], " ", "q2", " ", "q3", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q2", "3"], " ", "q3", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q0", " ", "q1", " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q2", " ", 
       SuperscriptBox["q3", "3"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"q0", " ", "q2", " ", "r1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{"q1", " ", "q3", " ", "r1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q0", "3"], " ", "q2", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q0", " ", 
       SuperscriptBox["q1", "2"], " ", "q2", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q0", " ", 
       SuperscriptBox["q2", "3"], " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q0", "2"], " ", "q1", " ", "q3", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q1", "3"], " ", "q3", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"q1", " ", 
       SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q0", " ", "q2", " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"q1", " ", 
       SuperscriptBox["q3", "3"], " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.558083783992363*^9, {3.558097088447268*^9, 3.558097091387961*^9}, 
   3.558175601295726*^9, 3.558220542611833*^9, 3.558708595988408*^9, {
   3.558753771220283*^9, 3.558753790820266*^9}, 3.5587720182963133`*^9, 
   3.55877222247858*^9, 3.558772627095003*^9, 3.558773068474074*^9, 
   3.5587751765691643`*^9, 3.5587880373200274`*^9, 3.558825186677043*^9, 
   3.5588379672501507`*^9, 3.569830303025385*^9, 3.571997467492347*^9, 
   3.572061644635502*^9, 3.572062716078785*^9, 3.572082985619195*^9, 
   3.572097761808313*^9, 3.572098689238359*^9, 3.572100072114455*^9, 
   3.572101115517134*^9, 3.5721024004126263`*^9, 3.572315564498932*^9, 
   3.57232149664023*^9, 3.5723308240746975`*^9, 3.572354756773923*^9, 
   3.572966456110051*^9, 3.5741592822640057`*^9, 3.574160124549181*^9, 
   3.5747338964382195`*^9, 3.5810884951401715`*^9, 3.641860936864429*^9, 
   3.6418615146759157`*^9, 3.641863376492045*^9, 3.641863804638232*^9, 
   3.6418641542384577`*^9, 3.6418651194766407`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solcs\[Theta]1", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eq5c", ",", 
        RowBox[{"tmp1", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], "\[Equal]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], ",", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.641862165098379*^9, 3.641862253217943*^9}, {
  3.641863892157178*^9, 3.641863892291531*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", "\[Theta]1", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q0", " ", "q1"}], "-", 
         RowBox[{"q2", " ", "q3"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["q0", "2"]}], " ", "q1", " ", "q2", " ", "tx", " ", 
          
          RowBox[{"Cos", "[", "s", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q1", "2"], " ", "q3", " ", "tx", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "+", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q2", "2"], " ", "q3", " ", "tx", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "+", 
         RowBox[{"q1", " ", "q2", " ", 
          SuperscriptBox["q3", "2"], " ", "tx", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "2"], " ", "ty", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "-", 
         RowBox[{
         "2", " ", "q0", " ", "q1", " ", "q2", " ", "q3", " ", "ty", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "ty", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "4"], " ", "q1", " ", "q2", " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "3"], " ", "q2", " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", "q1", " ", 
          SuperscriptBox["q2", "3"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "3"], " ", 
          SuperscriptBox["q1", "2"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q1", "4"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "3"], " ", 
          SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"2", " ", "q0", " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q2", "4"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q1", "3"], " ", "q2", " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q1", " ", 
          SuperscriptBox["q2", "3"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q3", "3"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "3"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q1", " ", "q2", " ", 
          SuperscriptBox["q3", "4"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", "tx", " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{
         "2", " ", "q0", " ", "q1", " ", "q2", " ", "q3", " ", "tx", " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "tx", " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", "ty", " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q1", "2"], " ", "q3", " ", "ty", " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q2", "2"], " ", "q3", " ", "ty", " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{"q1", " ", "q2", " ", 
          SuperscriptBox["q3", "2"], " ", "ty", " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "2"], " ", "tz", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", "tz", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "tz", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "tz", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "s", "]"}], "3"], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "s", "]"}], "3"], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "s", "]"}], "3"], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "s", "]"}], "3"], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "4"], " ", 
          SuperscriptBox["q1", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "4"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q2", "4"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "4"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "2"], " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "s", "]"}], "3"]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "s", "]"}], "3"]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "s", "]"}], "3"]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "s", "]"}], "3"]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "4"], " ", 
          SuperscriptBox["q2", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q2", "4"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q1", "4"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q3", "4"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "4"], " ", "q1", " ", "q2", " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "3"], " ", "q2", " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", "q1", " ", 
          SuperscriptBox["q2", "3"], " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "3"], " ", 
          SuperscriptBox["q1", "2"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q1", "4"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "3"], " ", 
          SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"2", " ", "q0", " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q2", "4"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q1", "3"], " ", "q2", " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{"q1", " ", 
          SuperscriptBox["q2", "3"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q3", "3"], " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "3"], " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{"q1", " ", "q2", " ", 
          SuperscriptBox["q3", "4"], " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q1", "2"], "+", 
         SuperscriptBox["q2", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q0", "2"], "+", 
         SuperscriptBox["q3", "2"]}], ")"}], " ", "r1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q0"}], " ", "q2", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "-", 
         RowBox[{"q1", " ", "q3", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "+", 
         RowBox[{"q0", " ", "q1", " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{"q2", " ", "q3", " ", 
          RowBox[{"Sin", "[", "s", "]"}]}]}], ")"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"Sin", "[", "\[Theta]1", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q0", " ", "q2"}], "+", 
         RowBox[{"q1", " ", "q3"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["q0", "2"]}], " ", "q1", " ", "q2", " ", "tx", " ", 
          
          RowBox[{"Cos", "[", "s", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q1", "2"], " ", "q3", " ", "tx", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "+", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q2", "2"], " ", "q3", " ", "tx", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "+", 
         RowBox[{"q1", " ", "q2", " ", 
          SuperscriptBox["q3", "2"], " ", "tx", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "2"], " ", "ty", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "-", 
         RowBox[{
         "2", " ", "q0", " ", "q1", " ", "q2", " ", "q3", " ", "ty", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "ty", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "4"], " ", "q1", " ", "q2", " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "3"], " ", "q2", " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", "q1", " ", 
          SuperscriptBox["q2", "3"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "3"], " ", 
          SuperscriptBox["q1", "2"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q1", "4"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "3"], " ", 
          SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"2", " ", "q0", " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q2", "4"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q1", "3"], " ", "q2", " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q1", " ", 
          SuperscriptBox["q2", "3"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q3", "3"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "3"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q1", " ", "q2", " ", 
          SuperscriptBox["q3", "4"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", "tx", " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{
         "2", " ", "q0", " ", "q1", " ", "q2", " ", "q3", " ", "tx", " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "tx", " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", "ty", " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q1", "2"], " ", "q3", " ", "ty", " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q2", "2"], " ", "q3", " ", "ty", " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{"q1", " ", "q2", " ", 
          SuperscriptBox["q3", "2"], " ", "ty", " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "2"], " ", "tz", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", "tz", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "tz", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "tz", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "s", "]"}], "3"], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "s", "]"}], "3"], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "s", "]"}], "3"], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "s", "]"}], "3"], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "4"], " ", 
          SuperscriptBox["q1", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "4"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q2", "4"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "4"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "2"], " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "s", "]"}], "3"]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "s", "]"}], "3"]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "s", "]"}], "3"]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "s", "]"}], "3"]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "4"], " ", 
          SuperscriptBox["q2", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q2", "4"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q1", "4"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q3", "4"], " ", "r2", " ", 
          RowBox[{"Cos", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "4"], " ", "q1", " ", "q2", " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", 
          SuperscriptBox["q1", "3"], " ", "q2", " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q0", "2"], " ", "q1", " ", 
          SuperscriptBox["q2", "3"], " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "3"], " ", 
          SuperscriptBox["q1", "2"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q1", "4"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{
          SuperscriptBox["q0", "3"], " ", 
          SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"2", " ", "q0", " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q2", "4"], " ", "q3", " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["q1", "3"], " ", "q2", " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{"q1", " ", 
          SuperscriptBox["q2", "3"], " ", 
          SuperscriptBox["q3", "2"], " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q1", "2"], " ", 
          SuperscriptBox["q3", "3"], " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
         RowBox[{"q0", " ", 
          SuperscriptBox["q2", "2"], " ", 
          SuperscriptBox["q3", "3"], " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{"q1", " ", "q2", " ", 
          SuperscriptBox["q3", "4"], " ", "r2", " ", 
          RowBox[{"Sin", "[", "s", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q1", "2"], "+", 
         SuperscriptBox["q2", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q0", "2"], "+", 
         SuperscriptBox["q3", "2"]}], ")"}], " ", "r1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q0"}], " ", "q2", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "-", 
         RowBox[{"q1", " ", "q3", " ", 
          RowBox[{"Cos", "[", "s", "]"}]}], "+", 
         RowBox[{"q0", " ", "q1", " ", 
          RowBox[{"Sin", "[", "s", "]"}]}], "-", 
         RowBox[{"q2", " ", "q3", " ", 
          RowBox[{"Sin", "[", "s", "]"}]}]}], ")"}]}], ")"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.641862235404642*^9, 3.6418622548500767`*^9}, 
   3.641863449935501*^9, 3.641863804732169*^9, 3.6418638928129263`*^9, 
   3.641864154476879*^9, 3.641865119538329*^9, 3.641865306878642*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq6", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Numerator", "[", 
    RowBox[{"Together", "[", 
     RowBox[{
      RowBox[{"eq5c", "/.", "solt"}], "/.", "solcs\[Theta]1"}], "]"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.641862267675399*^9, 3.641862288046224*^9}, {
  3.641862642278062*^9, 3.641862651515023*^9}, {3.6418637883980713`*^9, 
  3.641863788960946*^9}, {3.641863903724887*^9, 3.6418639195402822`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.6418623085572577`*^9, 3.641862709630392*^9, 3.641863804834181*^9, {
   3.6418639078576603`*^9, 3.641863927135418*^9}, 3.641864161556481*^9, 
   3.641865125456605*^9, 3.6418653133615007`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp2", "[", 
   RowBox[{"[", 
    RowBox[{"2", ",", "1"}], "]"}], "]"}], "/.", "solcs\[Theta]1"}]], "Input",\

 CellChangeTimes->{{3.6418653634093647`*^9, 3.6418653794904423`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"q0", " ", "q2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"q1", " ", "q3", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"q0", " ", "q1", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"q2", " ", "q3", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.641864342297435*^9, 3.6418651258374367`*^9, {3.641865368752791*^9, 
   3.64186537991718*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solcos\[Theta]2", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"tmp2", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.641864565119772*^9, 3.6418646000154*^9}, {
  3.641864642207615*^9, 3.641864685562009*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{"q0", " ", "q1", " ", 
      RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
     RowBox[{"q2", " ", "q3", " ", 
      RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], 
    RowBox[{
     RowBox[{"q0", " ", "q2"}], "-", 
     RowBox[{"q1", " ", "q3"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.6418645947400846`*^9, 3.641864600591855*^9}, {
   3.641864643581111*^9, 3.641864686421974*^9}, 3.6418651258841963`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"Numerator", "[", 
   RowBox[{"Together", "[", 
    RowBox[{
     RowBox[{"eq6a", "/.", "solt"}], "/.", "solcos\[Theta]2"}], "]"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.641864691843946*^9, 3.641864718949922*^9}, {
  3.6418652023956842`*^9, 3.641865203509959*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "r1"}], " ", 
  RowBox[{"Cos", "[", "s", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q0", " ", "q2"}], "+", 
       RowBox[{"q1", " ", "q3"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "q0"}], " ", "q1"}], "+", 
       RowBox[{"q2", " ", "q3"}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"q0", " ", "q1"}], "-", 
    RowBox[{"q2", " ", "q3"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q0", " ", "q2"}], "+", 
       RowBox[{"q1", " ", "q3"}]}], ")"}], " ", 
     RowBox[{"Tan", "[", "s", "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"q0", " ", "q2"}], "+", 
    RowBox[{"q1", " ", "q3"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "q0"}], " ", "q1"}], "+", 
       RowBox[{"q2", " ", "q3"}]}], ")"}], " ", 
     RowBox[{"Tan", "[", "s", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.64186469825296*^9, 3.641864721111167*^9}, 
   3.641865127196003*^9, 3.641865204372896*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solcs\[Theta]2", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eq6a", ",", 
       RowBox[{"tmp2", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], "\[Equal]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]2", "]"}], ",", 
      RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6418642474644423`*^9, 3.641864319785266*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.641864312981186*^9, 3.64186432072677*^9}, 
   3.641864384015996*^9, 3.6418644771806803`*^9, 3.641865127328211*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Solutions", " ", "of", " ", "factors", " ", "of", " ", "g1", " ", "and", 
    " ", "g2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sol\[Theta]1", "=", 
     RowBox[{"solvetrig1", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"tmp1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\[Theta]1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol\[Theta]21", "=", 
     RowBox[{
      RowBox[{"solvetrig1", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"tmp1", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "/.", 
            RowBox[{"sol\[Theta]1", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ")"}], ",", "\[Theta]2"}], "]"}], "//",
       "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol\[Theta]22", "=", 
     RowBox[{
      RowBox[{"solvetrig1", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"tmp1", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "/.", 
            RowBox[{"sol\[Theta]1", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ")"}], ",", "\[Theta]2"}], "]"}], "//",
       "Simplify"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"sol\[Theta]2", "=", 
     RowBox[{"solvetrig1", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"tmp2", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\[Theta]2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol\[Theta]11", "=", 
     RowBox[{"solvetrig1", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"tmp2", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "/.", 
           RowBox[{"sol\[Theta]2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ")"}], ",", "\[Theta]1"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"sol\[Theta]12", "=", 
    RowBox[{"solvetrig1", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"tmp2", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "/.", 
          RowBox[{"sol\[Theta]2", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ")"}], ",", "\[Theta]1"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.558753943413539*^9, 3.558753943757949*^9}, {
   3.558753998247332*^9, 3.558754015229039*^9}, {3.558754085574956*^9, 
   3.558754110224401*^9}, {3.558754177277114*^9, 3.558754271744235*^9}, 
   3.5587544796308327`*^9, {3.5587546163517036`*^9, 3.558754620847975*^9}, {
   3.558770116410509*^9, 3.5587701197894793`*^9}, 3.558770643962717*^9, {
   3.5698309857394342`*^9, 3.5698310148010964`*^9}, {3.5810885049417324`*^9, 
   3.5810885995151415`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]1", "\[Rule]", 
     RowBox[{
      RowBox[{"ArcCos", "[", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["q0", "4"]}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["q1", "2"], "+", 
               SuperscriptBox["q2", "2"]}], ")"}], " ", "r2"}], "-", 
            RowBox[{
             SuperscriptBox["q0", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["q1", "2"], "+", 
               SuperscriptBox["q2", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["q1", "2"], "+", 
               SuperscriptBox["q2", "2"], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["q3", "2"]}]}], ")"}], " ", "r2"}], "+", 
            RowBox[{"q0", " ", 
             SqrtBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["q1", "2"], "+", 
                 SuperscriptBox["q2", "2"]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["q0", "2"], "+", 
                 SuperscriptBox["q3", "2"]}], ")"}]}]], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"q1", " ", "tx"}], "+", 
               RowBox[{"q2", " ", "ty"}]}], ")"}]}], "-", 
            RowBox[{"q3", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["q1", "4"], " ", "q3", " ", "r2"}], "+", 
               RowBox[{
                SuperscriptBox["q1", "2"], " ", "q3", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", 
                   SuperscriptBox["q2", "2"]}], "+", 
                  SuperscriptBox["q3", "2"]}], ")"}], " ", "r2"}], "+", 
               RowBox[{"q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["q2", "3"], " ", "q3", " ", "r2"}], "+", 
                  RowBox[{"q2", " ", 
                   SuperscriptBox["q3", "3"], " ", "r2"}], "+", 
                  RowBox[{
                   SqrtBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["q1", "2"], "+", 
                    SuperscriptBox["q2", "2"]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["q0", "2"], "+", 
                    SuperscriptBox["q3", "2"]}], ")"}]}]], " ", "tx"}]}], 
                 ")"}]}], "-", 
               RowBox[{"q1", " ", 
                SqrtBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["q1", "2"], "+", 
                    SuperscriptBox["q2", "2"]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["q0", "2"], "+", 
                    SuperscriptBox["q3", "2"]}], ")"}]}]], " ", "ty"}]}], 
              ")"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["q1", "2"], "+", 
                SuperscriptBox["q2", "2"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["q0", "2"], "+", 
                SuperscriptBox["q3", "2"]}], ")"}]}]], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "q0"}], " ", "q2", " ", "r1"}], "-", 
                 RowBox[{"q1", " ", "q3", " ", "r1"}]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "q0"}], " ", "q1", " ", "r1"}], "+", 
                 RowBox[{"q2", " ", "q3", " ", "r1"}]}], ")"}], "2"]}]]}], 
           ")"}]}], ")"}]}], "]"}], "+", 
      RowBox[{"ArcTan", "[", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", "q0"}], " ", "q1", " ", "r1"}], "+", 
          RowBox[{"q2", " ", "q3", " ", "r1"}]}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "q0"}], " ", "q2", " ", "r1"}], "-", 
              RowBox[{"q1", " ", "q3", " ", "r1"}]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "q0"}], " ", "q1", " ", "r1"}], "+", 
              RowBox[{"q2", " ", "q3", " ", "r1"}]}], ")"}], "2"]}]]], ",", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", "q0"}], " ", "q2", " ", "r1"}], "-", 
          RowBox[{"q1", " ", "q3", " ", "r1"}]}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "q0"}], " ", "q2", " ", "r1"}], "-", 
              RowBox[{"q1", " ", "q3", " ", "r1"}]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "q0"}], " ", "q1", " ", "r1"}], "+", 
              RowBox[{"q2", " ", "q3", " ", "r1"}]}], ")"}], "2"]}]]]}], 
       "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]1", "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"ArcCos", "[", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["q0", "4"]}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["q1", "2"], "+", 
                SuperscriptBox["q2", "2"]}], ")"}], " ", "r2"}], "-", 
             RowBox[{
              SuperscriptBox["q0", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["q1", "2"], "+", 
                SuperscriptBox["q2", "2"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["q1", "2"], "+", 
                SuperscriptBox["q2", "2"], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["q3", "2"]}]}], ")"}], " ", "r2"}], "+", 
             RowBox[{"q0", " ", 
              SqrtBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["q1", "2"], "+", 
                  SuperscriptBox["q2", "2"]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["q0", "2"], "+", 
                  SuperscriptBox["q3", "2"]}], ")"}]}]], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"q1", " ", "tx"}], "+", 
                RowBox[{"q2", " ", "ty"}]}], ")"}]}], "-", 
             RowBox[{"q3", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["q1", "4"], " ", "q3", " ", "r2"}], "+", 
                RowBox[{
                 SuperscriptBox["q1", "2"], " ", "q3", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", " ", 
                    SuperscriptBox["q2", "2"]}], "+", 
                   SuperscriptBox["q3", "2"]}], ")"}], " ", "r2"}], "+", 
                RowBox[{"q2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["q2", "3"], " ", "q3", " ", "r2"}], "+", 
                   RowBox[{"q2", " ", 
                    SuperscriptBox["q3", "3"], " ", "r2"}], "+", 
                   RowBox[{
                    SqrtBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["q1", "2"], "+", 
                    SuperscriptBox["q2", "2"]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["q0", "2"], "+", 
                    SuperscriptBox["q3", "2"]}], ")"}]}]], " ", "tx"}]}], 
                  ")"}]}], "-", 
                RowBox[{"q1", " ", 
                 SqrtBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["q1", "2"], "+", 
                    SuperscriptBox["q2", "2"]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["q0", "2"], "+", 
                    SuperscriptBox["q3", "2"]}], ")"}]}]], " ", "ty"}]}], 
               ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["q1", "2"], "+", 
                 SuperscriptBox["q2", "2"]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["q0", "2"], "+", 
                 SuperscriptBox["q3", "2"]}], ")"}]}]], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "q0"}], " ", "q2", " ", "r1"}], "-", 
                  RowBox[{"q1", " ", "q3", " ", "r1"}]}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "q0"}], " ", "q1", " ", "r1"}], "+", 
                  RowBox[{"q2", " ", "q3", " ", "r1"}]}], ")"}], "2"]}]]}], 
            ")"}]}], ")"}]}], "]"}]}], "+", 
      RowBox[{"ArcTan", "[", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", "q0"}], " ", "q1", " ", "r1"}], "+", 
          RowBox[{"q2", " ", "q3", " ", "r1"}]}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "q0"}], " ", "q2", " ", "r1"}], "-", 
              RowBox[{"q1", " ", "q3", " ", "r1"}]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "q0"}], " ", "q1", " ", "r1"}], "+", 
              RowBox[{"q2", " ", "q3", " ", "r1"}]}], ")"}], "2"]}]]], ",", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", "q0"}], " ", "q2", " ", "r1"}], "-", 
          RowBox[{"q1", " ", "q3", " ", "r1"}]}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "q0"}], " ", "q2", " ", "r1"}], "-", 
              RowBox[{"q1", " ", "q3", " ", "r1"}]}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "q0"}], " ", "q1", " ", "r1"}], "+", 
              RowBox[{"q2", " ", "q3", " ", "r1"}]}], ")"}], "2"]}]]]}], 
       "]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.5810886001111755`*^9, 3.641860937991557*^9, 
  3.641861515730295*^9, 3.641863808036356*^9, 3.641864163595995*^9, 
  3.641865128505467*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"inputs", " ", "to", " ", "define", " ", "the", " ", "cylinders"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "shortest", " ", "distance", " ", "case2a", "\[IndentingNewLine]", 
      "input"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q0", "\[Rule]", 
        RowBox[{"-", "0.2"}]}], ",", 
       RowBox[{"q1", "\[Rule]", "0.3"}], ",", 
       RowBox[{"q2", "\[Rule]", "0.707"}], ",", 
       RowBox[{"q3", "\[Rule]", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"0.707", "^", "2"}], "-", 
          RowBox[{"0.3", "^", "2"}], "-", 
          RowBox[{".2", "^", "2"}]}], "]"}]}], ",", 
       RowBox[{"r1", "\[Rule]", "0.5"}], ",", 
       RowBox[{"r2", "\[Rule]", ".5"}], ",", 
       RowBox[{"l1", "\[Rule]", "7"}], ",", 
       RowBox[{"l2", "\[Rule]", "4"}], ",", 
       RowBox[{"tx", "\[Rule]", "2"}], ",", 
       RowBox[{"ty", "\[Rule]", 
        RowBox[{"-", "2"}]}], ",", 
       RowBox[{"tz", "\[Rule]", "2"}]}], "}"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "cyl", " ", "intersection", " ", "case2a", "\[IndentingNewLine]", 
      "input"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q0", "\[Rule]", "0.2"}], ",", 
       RowBox[{"q1", "\[Rule]", "0.2"}], ",", 
       RowBox[{"q2", "\[Rule]", "0.2"}], ",", 
       RowBox[{"q3", "\[Rule]", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"0.2", "^", "2"}], "-", 
          RowBox[{"0.2", "^", "2"}], "-", 
          RowBox[{"0.2", "^", "2"}]}], "]"}]}], ",", 
       RowBox[{"r1", "\[Rule]", "0.5"}], ",", 
       RowBox[{"r2", "\[Rule]", ".5"}], ",", 
       RowBox[{"l1", "\[Rule]", "7"}], ",", 
       RowBox[{"l2", "\[Rule]", "4"}], ",", 
       RowBox[{"tx", "\[Rule]", 
        RowBox[{"-", "0.7"}]}], ",", 
       RowBox[{"ty", "\[Rule]", 
        RowBox[{"-", "0.9"}]}], ",", 
       RowBox[{"tz", "\[Rule]", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "1.5", "+", "1.4"}]}]}], "}"}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "case2b", " ", "circle", " ", "line", "\[IndentingNewLine]", "input"}], 
     "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q0", "\[Rule]", "0"}], ",", 
       RowBox[{"q1", "\[Rule]", "0.4"}], ",", 
       RowBox[{"q2", "\[Rule]", 
        RowBox[{"-", "0.3"}]}], ",", 
       RowBox[{"q3", "\[Rule]", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"0", "^", "2"}], "-", 
          RowBox[{"0.3", "^", "2"}], "-", 
          RowBox[{"0.4", "^", "2"}]}], "]"}]}], ",", 
       RowBox[{"r1", "\[Rule]", "0.5"}], ",", 
       RowBox[{"r2", "\[Rule]", ".5"}], ",", 
       RowBox[{"l1", "\[Rule]", "7"}], ",", 
       RowBox[{"l2", "\[Rule]", "4"}], ",", 
       RowBox[{"tx", "\[Rule]", "2"}], ",", 
       RowBox[{"ty", "\[Rule]", 
        RowBox[{"-", "2"}]}], ",", 
       RowBox[{"tz", "\[Rule]", "3.5"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "case2c", " ", "circle", " ", "circle", "\[IndentingNewLine]", "input"}],
      "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q0", "\[Rule]", "0.8"}], ",", 
       RowBox[{"q1", "\[Rule]", "0.4"}], ",", 
       RowBox[{"q2", "\[Rule]", 
        RowBox[{"-", "0.3"}]}], ",", 
       RowBox[{"q3", "\[Rule]", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"0.8", "^", "2"}], "-", 
          RowBox[{"0.3", "^", "2"}], "-", 
          RowBox[{"0.4", "^", "2"}]}], "]"}]}], ",", 
       RowBox[{"r1", "\[Rule]", "0.5"}], ",", 
       RowBox[{"r2", "\[Rule]", ".5"}], ",", 
       RowBox[{"l1", "\[Rule]", "7"}], ",", 
       RowBox[{"l2", "\[Rule]", "4"}], ",", 
       RowBox[{"tx", "\[Rule]", "2"}], ",", 
       RowBox[{"ty", "\[Rule]", 
        RowBox[{"-", "2"}]}], ",", 
       RowBox[{"tz", "\[Rule]", "9.5"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"touching", " ", "cyl", "\[IndentingNewLine]", "input"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q0", "\[Rule]", 
        RowBox[{"-", "0.1"}]}], ",", 
       RowBox[{"q1", "\[Rule]", "0"}], ",", 
       RowBox[{"q2", "\[Rule]", 
        RowBox[{"-", "0.5"}]}], ",", 
       RowBox[{"q3", "\[Rule]", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"0.1", "^", "2"}], "-", 
          RowBox[{"0", "^", "2"}], "-", 
          RowBox[{"0", "^", "2"}]}], "]"}]}], ",", 
       RowBox[{"r1", "\[Rule]", "0.5"}], ",", 
       RowBox[{"r2", "\[Rule]", ".5"}], ",", 
       RowBox[{"l1", "\[Rule]", "7"}], ",", 
       RowBox[{"l2", "\[Rule]", "4"}], ",", 
       RowBox[{"tx", "\[Rule]", "1"}], ",", 
       RowBox[{"ty", "\[Rule]", "0"}], ",", 
       RowBox[{"tz", "\[Rule]", "6.7"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"common", " ", "edge", " ", "\[IndentingNewLine]", "input"}], 
     "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q0", "\[Rule]", "0"}], ",", 
       RowBox[{"q1", "\[Rule]", "0"}], ",", 
       RowBox[{"q2", "\[Rule]", "0"}], ",", 
       RowBox[{"q3", "\[Rule]", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"0", "^", "2"}], "-", 
          RowBox[{"0", "^", "2"}], "-", 
          RowBox[{"0", "^", "2"}]}], "]"}]}], ",", 
       RowBox[{"r1", "\[Rule]", "0.5"}], ",", 
       RowBox[{"r2", "\[Rule]", ".5"}], ",", 
       RowBox[{"l1", "\[Rule]", "7"}], ",", 
       RowBox[{"l2", "\[Rule]", "4"}], ",", 
       RowBox[{"tx", "\[Rule]", "0.5"}], ",", 
       RowBox[{"ty", "\[Rule]", "0"}], ",", 
       RowBox[{"tz", "\[Rule]", "7"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5588239415240726`*^9, 3.558823988304873*^9}, {
   3.558824030241153*^9, 3.5588240728567867`*^9}, {3.5588243754498453`*^9, 
   3.558824482328076*^9}, {3.5588246228224373`*^9, 3.558824635014586*^9}, {
   3.558824723176489*^9, 3.558824727162292*^9}, {3.558824784879406*^9, 
   3.558824848866665*^9}, {3.558825000633794*^9, 3.5588250846576347`*^9}, {
   3.5588258681507053`*^9, 3.558825887759346*^9}, {3.558825961729797*^9, 
   3.5588259825646544`*^9}, {3.558826013870875*^9, 3.558826045866074*^9}, {
   3.5588261276064453`*^9, 3.558826138865679*^9}, 3.558838076397911*^9, {
   3.558838243917041*^9, 3.558838260854479*^9}, {3.5698310202444077`*^9, 
   3.569831055352416*^9}, {3.5720627219461203`*^9, 3.5720627221061296`*^9}, {
   3.572062753984953*^9, 3.5720627585932164`*^9}, {3.572097681085696*^9, 
   3.5720976837718496`*^9}, {3.5720977574400635`*^9, 
   3.5720977914960113`*^9}, {3.5720981700906653`*^9, 
   3.5720982107929935`*^9}, {3.5720982797079353`*^9, 3.572098312748825*^9}, {
   3.5720985433310137`*^9, 3.5720986094467955`*^9}, {3.572098680412854*^9, 
   3.572098976285777*^9}, {3.572099285824482*^9, 3.5720993495251255`*^9}, {
   3.5720994003720336`*^9, 3.5720995908539286`*^9}, {3.5721011439407597`*^9, 
   3.5721011442607784`*^9}, {3.5721014251898465`*^9, 3.572101562187682*^9}, {
   3.572102066954553*^9, 3.5721021667882633`*^9}, {3.572102237663317*^9, 
   3.5721022950536*^9}, {3.572102374290132*^9, 3.5721023757732167`*^9}, {
   3.5721025813109727`*^9, 3.57210262969074*^9}, {3.5721261462756863`*^9, 
   3.5721261601004767`*^9}, {3.5721273274822474`*^9, 3.572127339572939*^9}, {
   3.57213045987741*^9, 3.5721304727361455`*^9}, {3.5721311785295143`*^9, 
   3.572131186088947*^9}, {3.5723217061342125`*^9, 3.572321708369341*^9}, {
   3.5723558611910925`*^9, 3.5723558686005163`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"input", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q0", "\[Rule]", 
      RowBox[{"-", "0.2"}]}], ",", 
     RowBox[{"q1", "\[Rule]", "0.3"}], ",", 
     RowBox[{"q2", "\[Rule]", "0.707"}], ",", 
     RowBox[{"q3", "\[Rule]", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"0.707", "^", "2"}], "-", 
        RowBox[{"0.3", "^", "2"}], "-", 
        RowBox[{".2", "^", "2"}]}], "]"}]}], ",", 
     RowBox[{"r1", "\[Rule]", "0.5"}], ",", 
     RowBox[{"r2", "\[Rule]", ".5"}], ",", 
     RowBox[{"l1", "\[Rule]", "7"}], ",", 
     RowBox[{"l2", "\[Rule]", "4"}], ",", 
     RowBox[{"tx", "\[Rule]", "2"}], ",", 
     RowBox[{"ty", "\[Rule]", 
      RowBox[{"-", "2"}]}], ",", 
     RowBox[{"tz", "\[Rule]", "2"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
      RowBox[{"Cylinder", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"l1", "/.", "input"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"r1", "/.", "input"}]}], "]"}]}], "}"}], "]"}], ",", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"Cylinder", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"{", 
           RowBox[{"tx", ",", "ty", ",", "tz"}], "}"}], ")"}], "/.", 
         "input"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tx", ",", "ty", ",", "tz"}], "}"}], "+", 
           RowBox[{"R", ".", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", 
              RowBox[{"l2", "/.", "input"}]}], "}"}]}]}], ")"}], "/.", 
         "input"}]}], "}"}], ",", 
      RowBox[{"r2", "/.", "input"}]}], "]"}], "]"}], ",", 
   RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5588239415240726`*^9, 3.558823988304873*^9}, {
   3.558824030241153*^9, 3.5588240728567867`*^9}, {3.5588243754498453`*^9, 
   3.558824482328076*^9}, {3.5588246228224373`*^9, 3.558824635014586*^9}, {
   3.558824723176489*^9, 3.558824727162292*^9}, {3.558824784879406*^9, 
   3.558824848866665*^9}, {3.558825000633794*^9, 3.5588250846576347`*^9}, {
   3.5588258681507053`*^9, 3.558825887759346*^9}, {3.558825961729797*^9, 
   3.5588259825646544`*^9}, {3.558826013870875*^9, 3.558826045866074*^9}, {
   3.5588261276064453`*^9, 3.558826138865679*^9}, 3.558838076397911*^9, {
   3.558838243917041*^9, 3.558838260854479*^9}, {3.5698310202444077`*^9, 
   3.569831055352416*^9}, {3.5720627219461203`*^9, 3.5720627221061296`*^9}, {
   3.572062753984953*^9, 3.5720627585932164`*^9}, {3.572097681085696*^9, 
   3.5720976837718496`*^9}, {3.5720977574400635`*^9, 
   3.5720977914960113`*^9}, {3.5720981700906653`*^9, 
   3.5720982107929935`*^9}, {3.5720982797079353`*^9, 3.572098312748825*^9}, {
   3.5720985433310137`*^9, 3.5720986094467955`*^9}, {3.572098680412854*^9, 
   3.572098976285777*^9}, {3.572099285824482*^9, 3.5720993495251255`*^9}, {
   3.5720994003720336`*^9, 3.5720995908539286`*^9}, {3.5721011439407597`*^9, 
   3.5721011442607784`*^9}, {3.5721014251898465`*^9, 3.572101562187682*^9}, {
   3.572102066954553*^9, 3.5721021667882633`*^9}, {3.572102237663317*^9, 
   3.5721022950536*^9}, {3.572102374290132*^9, 3.5721023757732167`*^9}, {
   3.5721025813109727`*^9, 3.57210262969074*^9}, {3.5721261462756863`*^9, 
   3.572126202554905*^9}, {3.572127358448018*^9, 3.572127388861758*^9}, {
   3.5721278611227694`*^9, 3.572127866864098*^9}, {3.572130478744489*^9, 
   3.5721304958664684`*^9}, {3.572130540615028*^9, 3.5721305956031733`*^9}, {
   3.572130826945405*^9, 3.5721308677867413`*^9}, {3.572130910498184*^9, 
   3.572130919776715*^9}, 3.5723145847948956`*^9, 3.5723154890296144`*^9, 
   3.5723214257591763`*^9, {3.572321520818613*^9, 3.5723215367765265`*^9}, 
   3.5723217158207664`*^9, {3.572329860884606*^9, 3.5723299003888655`*^9}, 
   3.572330650038743*^9, {3.5723308917035656`*^9, 3.57233089598781*^9}, 
   3.5723546783464375`*^9, {3.5723547686716037`*^9, 3.5723549082935896`*^9}, 
   3.572355479938286*^9, {3.5723555313172245`*^9, 3.572355531483234*^9}, {
   3.572355570350457*^9, 3.572355609998725*^9}, {3.5723557549440155`*^9, 
   3.57235578859694*^9}, {3.5729663917443695`*^9, 3.572966397310688*^9}, 
   3.572966480823465*^9, 3.5741592718474092`*^9, {3.5747338442282333`*^9, 
   3.5747338464513607`*^9}}],

Cell[BoxData[
 Graphics3DBox[{
   {Opacity[0.5], CylinderBox[{{0, 0, 0}, {0, 0, 7}}, 0.5]}, 
   CylinderBox[{{2, -2, 2}, {2.3289608678498404`, 1.921112445232791, 
     1.2812080000000001`}}, 0.5]},
  Boxed->False]], "Output",
 CellChangeTimes->{{3.572097767574643*^9, 3.572097792221052*^9}, 
   3.5720979194903316`*^9, {3.5720981706876993`*^9, 3.5720982136391563`*^9}, {
   3.5720982859932947`*^9, 3.572098313270855*^9}, {3.572098561324043*^9, 
   3.5720986097888145`*^9}, {3.5720986918175063`*^9, 
   3.5720989766187963`*^9}, {3.572099286305509*^9, 3.5720993498151417`*^9}, {
   3.572099401117076*^9, 3.5720995054610443`*^9}, {3.5720995432122035`*^9, 
   3.5720996062258077`*^9}, {3.5721011201493993`*^9, 3.57210114447079*^9}, {
   3.5721014262849092`*^9, 3.572101562606706*^9}, {3.572102106616822*^9, 
   3.572102167167285*^9}, {3.5721022685060816`*^9, 3.572102295651634*^9}, 
   3.572102403065778*^9, {3.5721025818140016`*^9, 3.572102630716799*^9}, 
   3.5721261469127226`*^9, {3.5721261801166215`*^9, 3.5721262031209373`*^9}, {
   3.5721273728628426`*^9, 3.572127392778982*^9}, {3.572127863901929*^9, 
   3.572127867653143*^9}, 3.572130497480561*^9, {3.57213054152708*^9, 
   3.5721305958891897`*^9}, 3.572130643085889*^9, {3.572130840563184*^9, 
   3.5721308835086403`*^9}, {3.5721309139313803`*^9, 3.5721309204357524`*^9}, 
   3.5723145898151827`*^9, 3.5723154943029165`*^9, 3.572315567196086*^9, {
   3.5723214995923996`*^9, 3.5723215219046755`*^9}, 3.572321554590545*^9, 
   3.572321721446089*^9, 3.5723298664619246`*^9, 3.5723299009658985`*^9, 
   3.5723308267178483`*^9, 3.5723308980839305`*^9, 3.5723546790584784`*^9, {
   3.572354759317069*^9, 3.572354908754616*^9}, 3.5723554807753334`*^9, 
   3.5723555330633245`*^9, {3.572355573443634*^9, 3.5723556104837523`*^9}, {
   3.5723557630374784`*^9, 3.5723557887809505`*^9}, 3.572966397971726*^9, 
   3.5729664588752093`*^9, 3.5729664965103617`*^9, 3.5741592852171745`*^9, 
   3.574160128618414*^9, 3.574733899220379*^9, 3.641860938084173*^9, 
   3.641861515793788*^9, 3.641863808514379*^9, 3.64186416390457*^9, 
   3.641865128555126*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"sol\[Theta]2", "/.", "input"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"tmp2", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], "/.", "input"}], ")"}], 
    "\[Equal]", "0"}], ",", "\[Theta]2"}], "]"}]}], "Input",
 CellChangeTimes->{{3.574161674138813*^9, 3.574161705312596*^9}, {
  3.574161735528324*^9, 3.5741617507311935`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]2", "\[Rule]", 
     RowBox[{"-", "0.7189041077458564`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]2", "\[Rule]", 
     RowBox[{"-", "3.8604967613356496`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5741616786290693`*^9, 3.574161705708618*^9}, {
   3.5741617360323524`*^9, 3.5741617511672187`*^9}, 3.5747339905686035`*^9, 
   3.641860938140517*^9, 3.6418615158001633`*^9, 3.6418638086558027`*^9, 
   3.641864164084662*^9, 3.641865128596058*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Solve", "::", "ifun"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Inverse functions are being used by \
\[NoBreak]\\!\\(Solve\\)\[NoBreak], so some solutions may not be found; use \
Reduce for complete solution information. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Solve/ifun\\\", ButtonNote -> \
\\\"Solve::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.641860938334518*^9, 3.641861515850095*^9, 
  3.641863808790147*^9, 3.641864164107521*^9, 3.64186512884708*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]2", "\[Rule]", 
     RowBox[{"-", "0.7189041077458563`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]2", "\[Rule]", "2.4226885458439367`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.5741616786290693`*^9, 3.574161705708618*^9}, {
   3.5741617360323524`*^9, 3.5741617511672187`*^9}, 3.5747339905686035`*^9, 
   3.641860938140517*^9, 3.6418615158001633`*^9, 3.6418638086558027`*^9, 
   3.641864164084662*^9, 3.641865128886965*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "combinations", " ", "of", " ", "all", " ", "possible", " ", "solutions"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nsolutions", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sol\[Theta]1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", "input"}], ",", 
          RowBox[{
           RowBox[{"sol\[Theta]21", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", "input"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sol\[Theta]1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", "input"}], ",", 
          RowBox[{
           RowBox[{"sol\[Theta]21", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", "input"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sol\[Theta]1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", "input"}], ",", 
          RowBox[{
           RowBox[{"sol\[Theta]22", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", "input"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sol\[Theta]1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", "input"}], ",", 
          RowBox[{
           RowBox[{"sol\[Theta]22", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", "input"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sol\[Theta]11", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", "input"}], ",", 
          RowBox[{
           RowBox[{"sol\[Theta]2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", "input"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sol\[Theta]11", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", "input"}], ",", 
          RowBox[{
           RowBox[{"sol\[Theta]2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", "input"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sol\[Theta]12", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", "input"}], ",", 
          RowBox[{
           RowBox[{"sol\[Theta]2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", "input"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sol\[Theta]12", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", "input"}], ",", 
          RowBox[{
           RowBox[{"sol\[Theta]2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", "input"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sol\[Theta]1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"sol\[Theta]2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "/.", "input"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sol\[Theta]1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"sol\[Theta]2", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "/.", "input"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sol\[Theta]1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"sol\[Theta]2", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "/.", "input"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sol\[Theta]1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"sol\[Theta]2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "/.", "input"}], "]"}]}],
       "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"ii", "=", "1"}], ",", 
     RowBox[{"ii", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "nsolutions", "]"}]}], ",", 
     RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"nsolutions", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], "=", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"nsolutions", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"solt", "/.", "input"}], "/.", 
          RowBox[{"nsolutions", "[", 
           RowBox[{"[", "ii", "]"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nsolutions", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"nsolutions", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "nsolutions"}]}]], "Input",
 CellChangeTimes->{{3.5588239415240726`*^9, 3.558823988304873*^9}, {
   3.558824030241153*^9, 3.5588240728567867`*^9}, {3.5588243754498453`*^9, 
   3.558824482328076*^9}, {3.5588246228224373`*^9, 3.558824635014586*^9}, {
   3.558824723176489*^9, 3.558824727162292*^9}, {3.558824784879406*^9, 
   3.558824848866665*^9}, {3.558825000633794*^9, 3.5588250846576347`*^9}, {
   3.5588258681507053`*^9, 3.558825887759346*^9}, {3.558825961729797*^9, 
   3.5588259825646544`*^9}, {3.558826013870875*^9, 3.558826045866074*^9}, {
   3.5588261276064453`*^9, 3.558826138865679*^9}, 3.558838076397911*^9, {
   3.558838243917041*^9, 3.558838260854479*^9}, {3.5698310202444077`*^9, 
   3.569831055352416*^9}, {3.5720627219461203`*^9, 3.5720627221061296`*^9}, {
   3.572062753984953*^9, 3.5720627585932164`*^9}, {3.572097681085696*^9, 
   3.5720976837718496`*^9}, {3.5720979043374653`*^9, 3.5720979091507406`*^9}, 
   3.5720986186113195`*^9, 3.5720994333149176`*^9, 3.5721015718612356`*^9, 
   3.5721026968205795`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "3.057893872563068`"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.7189041077458563`"}], "+", 
       RowBox[{"2.3557447705923846`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"t1", "\[Rule]", 
      RowBox[{"0.23806841713179716`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.37943208384739974`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"t2", "\[Rule]", 
      RowBox[{"0.4640022149348068`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.11932057655561758`", " ", "\[ImaginaryI]"}]}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "3.057893872563068`"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.7189041077458563`"}], "-", 
       RowBox[{"2.3557447705923846`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"t1", "\[Rule]", 
      RowBox[{"0.23806841713179716`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.37943208384739974`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"t2", "\[Rule]", 
      RowBox[{"0.4640022149348068`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.11932057655561758`", " ", "\[ImaginaryI]"}]}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{"-", "0.08369878102672534`"}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.7189041077458563`"}], "+", 
       RowBox[{"1.869744695145067`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"t1", "\[Rule]", 
      RowBox[{"0.23806841713179716`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.22990228616138966`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"t2", "\[Rule]", 
      RowBox[{"0.46400221493480687`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.07229771678260147`", " ", "\[ImaginaryI]"}]}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{"-", "0.08369878102672534`"}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.7189041077458563`"}], "-", 
       RowBox[{"1.869744695145067`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"t1", "\[Rule]", 
      RowBox[{"0.23806841713179716`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.22990228616138966`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"t2", "\[Rule]", 
      RowBox[{"0.46400221493480687`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.07229771678260147`", " ", "\[ImaginaryI]"}]}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.08369878102672537`"}], "+", 
       RowBox[{"1.869744695145067`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"-", "0.7189041077458564`"}]}], ",", 
     RowBox[{"t1", "\[Rule]", 
      RowBox[{"0.23806841713179713`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.0413129810186294`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"t2", "\[Rule]", 
      RowBox[{"0.4640022149348069`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.402329000782432`", " ", "\[ImaginaryI]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.08369878102672537`"}], "-", 
       RowBox[{"1.869744695145067`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"-", "0.7189041077458564`"}]}], ",", 
     RowBox[{"t1", "\[Rule]", 
      RowBox[{"0.23806841713179713`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0413129810186294`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"t2", "\[Rule]", 
      RowBox[{"0.4640022149348069`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.402329000782432`", " ", "\[ImaginaryI]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.08369878102672537`"}], "+", 
       RowBox[{"2.3557447705923846`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"-", "3.8604967613356496`"}]}], ",", 
     RowBox[{"t1", "\[Rule]", 
      RowBox[{"0.23806841713179716`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.06818318660321003`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"t2", "\[Rule]", 
      RowBox[{"0.4640022149348068`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6640061467329496`", " ", "\[ImaginaryI]"}]}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.08369878102672537`"}], "-", 
       RowBox[{"2.3557447705923846`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"-", "3.8604967613356496`"}]}], ",", 
     RowBox[{"t1", "\[Rule]", 
      RowBox[{"0.23806841713179716`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.06818318660321003`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"t2", "\[Rule]", 
      RowBox[{"0.4640022149348068`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.6640061467329496`", " ", "\[ImaginaryI]"}]}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "3.057893872563068`"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"-", "0.7189041077458564`"}]}], ",", 
     RowBox[{"t1", "\[Rule]", "0.23806841713179713`"}], ",", 
     RowBox[{"t2", "\[Rule]", "0.4640022149348068`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "3.057893872563068`"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"-", "3.8604967613356496`"}]}], ",", 
     RowBox[{"t1", "\[Rule]", "0.23806841713179716`"}], ",", 
     RowBox[{"t2", "\[Rule]", "0.4640022149348068`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{"-", "0.08369878102672534`"}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"-", "3.8604967613356496`"}]}], ",", 
     RowBox[{"t1", "\[Rule]", "0.23806841713179716`"}], ",", 
     RowBox[{"t2", "\[Rule]", "0.46400221493480687`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{"-", "0.08369878102672534`"}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"-", "0.7189041077458564`"}]}], ",", 
     RowBox[{"t1", "\[Rule]", "0.23806841713179713`"}], ",", 
     RowBox[{"t2", "\[Rule]", "0.46400221493480687`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.572102697336609*^9, 3.572315567396097*^9, 
  3.5723214997274075`*^9, 3.5723215598768473`*^9, 3.572321724594269*^9, 
  3.5723308304190598`*^9, 3.572330905546357*^9, 3.572354915802019*^9, 
  3.572355484850567*^9, 3.572355536372514*^9, 3.5723556187852273`*^9, 
  3.5741594061330905`*^9, 3.57416012872042*^9, 3.574733991413652*^9, 
  3.641860938415263*^9, 3.641861515886023*^9, 3.641863809033985*^9, 
  3.641864164367795*^9, 3.641865128926564*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"filtering", " ", "out", " ", "real", " ", "solutions"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"restol1", "=", 
     RowBox[{"10", "^", 
      RowBox[{"-", "3"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"realsolns", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"ii", "=", "1"}], ",", 
     RowBox[{"ii", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "nsolutions", "]"}]}], ",", 
     RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tmp", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Theta]1", ",", "\[Theta]2", ",", "t1", ",", "t2"}], "}"}],
         "/.", 
        RowBox[{"nsolutions", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Im", "[", "tmp", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "  ", "restol1"}], 
         " ", "&&", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Im", "[", "tmp", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", " ", "restol1"}], 
         " ", "&&", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Im", "[", "tmp", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "\[LessEqual]", " ", "restol1"}], 
         " ", "&&", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Im", "[", "tmp", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], "\[LessEqual]", " ", "restol1"}], 
         " ", "&&", 
         RowBox[{
          RowBox[{"tmp", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "\[LessEqual]", " ", "1"}], " ", "&&", 
         RowBox[{
          RowBox[{"tmp", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "\[LessEqual]", " ", "1"}], "&&", 
         RowBox[{
          RowBox[{"tmp", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "\[GreaterEqual]", "  ", "0"}], 
         " ", "&&", 
         RowBox[{
          RowBox[{"tmp", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "\[GreaterEqual]", "  ", "0"}]}], 
        ",", 
        RowBox[{"realsolns", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"realsolns", ",", 
           RowBox[{"nsolutions", "[", 
            RowBox[{"[", "ii", "]"}], "]"}]}], "]"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "realsolns", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.5588239415240726`*^9, 3.558823988304873*^9}, {
   3.558824030241153*^9, 3.5588240728567867`*^9}, {3.5588243754498453`*^9, 
   3.558824482328076*^9}, {3.5588246228224373`*^9, 3.558824635014586*^9}, {
   3.558824723176489*^9, 3.558824727162292*^9}, {3.558824784879406*^9, 
   3.558824848866665*^9}, {3.558825000633794*^9, 3.5588250846576347`*^9}, {
   3.5588258681507053`*^9, 3.558825887759346*^9}, {3.558825961729797*^9, 
   3.5588259825646544`*^9}, {3.558826013870875*^9, 3.558826045866074*^9}, {
   3.5588261276064453`*^9, 3.558826138865679*^9}, 3.558838076397911*^9, {
   3.558838243917041*^9, 3.558838260854479*^9}, {3.5698310202444077`*^9, 
   3.569831055352416*^9}, {3.5720627219461203`*^9, 3.5720627221061296`*^9}, {
   3.572062753984953*^9, 3.5720627585932164`*^9}, {3.572097681085696*^9, 
   3.5720976837718496`*^9}, 3.5720979043374653`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "3.057893872563068`"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"-", "0.7189041077458564`"}]}], ",", 
     RowBox[{"t1", "\[Rule]", "0.23806841713179713`"}], ",", 
     RowBox[{"t2", "\[Rule]", "0.4640022149348068`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "3.057893872563068`"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"-", "3.8604967613356496`"}]}], ",", 
     RowBox[{"t1", "\[Rule]", "0.23806841713179716`"}], ",", 
     RowBox[{"t2", "\[Rule]", "0.4640022149348068`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{"-", "0.08369878102672534`"}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"-", "3.8604967613356496`"}]}], ",", 
     RowBox[{"t1", "\[Rule]", "0.23806841713179716`"}], ",", 
     RowBox[{"t2", "\[Rule]", "0.46400221493480687`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{"-", "0.08369878102672534`"}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"-", "0.7189041077458564`"}]}], ",", 
     RowBox[{"t1", "\[Rule]", "0.23806841713179713`"}], ",", 
     RowBox[{"t2", "\[Rule]", "0.46400221493480687`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.558825863067546*^9, {3.558825966559875*^9, 3.558825990906122*^9}, 
   3.558826048609662*^9, 3.5588380816721354`*^9, {3.5588382480296803`*^9, 
   3.558838261439872*^9}, 3.569830389665341*^9, 3.5720616527159643`*^9, {
   3.5720627292685394`*^9, 3.572062759777284*^9}, 3.572097877785947*^9, {
   3.5720981908428526`*^9, 3.572098216523321*^9}, 3.57209829185863*^9, {
   3.57209873174479*^9, 3.572098778319454*^9}, 3.572099431050788*^9, {
   3.5721011242976365`*^9, 3.5721011483970146`*^9}, 3.5721015732743163`*^9, 
   3.5721022019172726`*^9, 3.5721027074611883`*^9, 3.572321499845414*^9, 
   3.5723215611829224`*^9, 3.5723217259523463`*^9, 3.5723308320871553`*^9, 
   3.572330906702423*^9, 3.572354917167097*^9, 3.5723554868656816`*^9, 
   3.5723555374325743`*^9, 3.572355619796285*^9, 3.5741594077301817`*^9, 
   3.574160128803425*^9, 3.574733995607892*^9, 3.641860938443594*^9, 
   3.64186151591512*^9, 3.64186380919909*^9, 3.6418641644961452`*^9, 
   3.6418651289522543`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "/.", "input"}], "/.", "nsolutions"}]], "Input",
 CellChangeTimes->{{3.572102719103854*^9, 3.5721027231650867`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"8.881784197001252`*^-16", "-", 
    RowBox[{"8.881784197001252`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"8.881784197001252`*^-16", "+", 
    RowBox[{"8.881784197001252`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "8.881784197001252`*^-16"}], "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "8.881784197001252`*^-16"}], "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.3322676295501878`*^-15"}], "+", 
    RowBox[{"1.7763568394002505`*^-15", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.3322676295501878`*^-15"}], "-", 
    RowBox[{"1.7763568394002505`*^-15", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"1.7763568394002505`*^-15", "-", 
    RowBox[{"3.552713678800501`*^-15", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"1.7763568394002505`*^-15", "+", 
    RowBox[{"3.552713678800501`*^-15", " ", "\[ImaginaryI]"}]}], ",", 
   "4.666467423425498`", ",", "9.98686898968089`", ",", "4.666467423425501`", 
   ",", "1.346065857170113`"}], "}"}]], "Output",
 CellChangeTimes->{3.5721027245871677`*^9, 3.5723214999844217`*^9, 
  3.5723215629490232`*^9, 3.572321727975462*^9, 3.5723308335592394`*^9, 
  3.5723549187151856`*^9, 3.572355488100753*^9, 3.5723555390236654`*^9, 
  3.5723556216373906`*^9, 3.574159409483282*^9, 3.574160128879429*^9, 
  3.5747339965609465`*^9, 3.6418609384653063`*^9, 3.641861515939294*^9, 
  3.641863809539028*^9, 3.641864164648734*^9, 3.64186512897224*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "substituting", " ", "the", " ", "realsolutions", " ", "back", " ", "to", 
    " ", "find", " ", "residue"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f1", "/.", "input"}], "/.", "realsolns"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f2", "/.", "input"}], "/.", "realsolns"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f3", "/.", "input"}], "/.", "realsolns"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f4", "/.", "input"}], "/.", "realsolns"}], "\[IndentingNewLine]", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"d", "/.", "input"}], "/.", "realsolns"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Min", "[", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"Chop", "[", 
      RowBox[{
       RowBox[{"d", "/.", "input"}], "/.", "realsolns"}], "]"}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.558220564288939*^9, 3.558220615496231*^9}, {
  3.5588259311485863`*^9, 3.558825942083714*^9}, {3.558826088658926*^9, 
  3.558826089138582*^9}, {3.569831061332758*^9, 3.56983107098531*^9}, {
  3.572101169939247*^9, 3.572101170187261*^9}, {3.5723308407076483`*^9, 
  3.5723308434758067`*^9}, {3.574159427249298*^9, 3.5741594577670436`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7.216449660063518`*^-16", ",", "8.604228440844963`*^-16", ",", 
   RowBox[{"-", "3.885780586188048`*^-16"}], ",", 
   RowBox[{"-", "3.608224830031759`*^-16"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.558220578046659*^9, 3.5582206164166193`*^9}, 
   3.558220651727797*^9, 3.5582206997669697`*^9, 3.558220860617251*^9, {
   3.558220972417678*^9, 3.5582209882159023`*^9}, 3.558709471152584*^9, {
   3.558749771748107*^9, 3.558749793241334*^9}, 3.558754356381092*^9, 
   3.558754693647749*^9, 3.55875482606494*^9, 3.558769284041566*^9, 
   3.5587698335966787`*^9, 3.558769935590838*^9, 3.558769981909786*^9, 
   3.558770069685959*^9, 3.558770231088286*^9, 3.5587702740046053`*^9, 
   3.558770618855234*^9, 3.5587721668407383`*^9, 3.558772705462768*^9, 
   3.5587731240347433`*^9, 3.558788098685474*^9, 3.5587881875713577`*^9, {
   3.558788243842575*^9, 3.55878828484134*^9}, 3.5587883393136263`*^9, 
   3.558825943105267*^9, 3.5588260581152067`*^9, 3.558826089871814*^9, 
   3.558838263439995*^9, 3.569830397270776*^9, 3.5720616553291135`*^9, {
   3.5720627352468815`*^9, 3.5720627616353903`*^9}, 3.572098218576439*^9, {
   3.57210112558671*^9, 3.5721011706242857`*^9}, 3.572101574419382*^9, 
   3.5721022032153473`*^9, 3.5723215000354247`*^9, 3.572321563492054*^9, 
   3.5723217303265963`*^9, {3.572330835042324*^9, 3.572330843840828*^9}, 
   3.5723549202532735`*^9, 3.57235548909781*^9, 3.5723555415468097`*^9, 
   3.572355622392434*^9, {3.5741594111903796`*^9, 3.5741594583230753`*^9}, 
   3.574160128910431*^9, 3.5747339972229843`*^9, 3.6418609384702473`*^9, 
   3.64186151596957*^9, 3.6418638095524817`*^9, 3.641864164856844*^9, 
   3.641865128979835*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", 
   RowBox[{"-", "4.440892098500626`*^-16"}], ",", 
   RowBox[{"-", "4.440892098500626`*^-16"}], ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.558220578046659*^9, 3.5582206164166193`*^9}, 
   3.558220651727797*^9, 3.5582206997669697`*^9, 3.558220860617251*^9, {
   3.558220972417678*^9, 3.5582209882159023`*^9}, 3.558709471152584*^9, {
   3.558749771748107*^9, 3.558749793241334*^9}, 3.558754356381092*^9, 
   3.558754693647749*^9, 3.55875482606494*^9, 3.558769284041566*^9, 
   3.5587698335966787`*^9, 3.558769935590838*^9, 3.558769981909786*^9, 
   3.558770069685959*^9, 3.558770231088286*^9, 3.5587702740046053`*^9, 
   3.558770618855234*^9, 3.5587721668407383`*^9, 3.558772705462768*^9, 
   3.5587731240347433`*^9, 3.558788098685474*^9, 3.5587881875713577`*^9, {
   3.558788243842575*^9, 3.55878828484134*^9}, 3.5587883393136263`*^9, 
   3.558825943105267*^9, 3.5588260581152067`*^9, 3.558826089871814*^9, 
   3.558838263439995*^9, 3.569830397270776*^9, 3.5720616553291135`*^9, {
   3.5720627352468815`*^9, 3.5720627616353903`*^9}, 3.572098218576439*^9, {
   3.57210112558671*^9, 3.5721011706242857`*^9}, 3.572101574419382*^9, 
   3.5721022032153473`*^9, 3.5723215000354247`*^9, 3.572321563492054*^9, 
   3.5723217303265963`*^9, {3.572330835042324*^9, 3.572330843840828*^9}, 
   3.5723549202532735`*^9, 3.57235548909781*^9, 3.5723555415468097`*^9, 
   3.572355622392434*^9, {3.5741594111903796`*^9, 3.5741594583230753`*^9}, 
   3.574160128910431*^9, 3.5747339972229843`*^9, 3.6418609384702473`*^9, 
   3.64186151596957*^9, 3.6418638095524817`*^9, 3.641864164856844*^9, 
   3.641865128981573*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "3.0531133177191805`*^-16"}], ",", 
   RowBox[{"-", "3.885780586188048`*^-16"}], ",", 
   RowBox[{"-", "3.3306690738754696`*^-16"}], ",", 
   RowBox[{"-", "2.498001805406602`*^-16"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.558220578046659*^9, 3.5582206164166193`*^9}, 
   3.558220651727797*^9, 3.5582206997669697`*^9, 3.558220860617251*^9, {
   3.558220972417678*^9, 3.5582209882159023`*^9}, 3.558709471152584*^9, {
   3.558749771748107*^9, 3.558749793241334*^9}, 3.558754356381092*^9, 
   3.558754693647749*^9, 3.55875482606494*^9, 3.558769284041566*^9, 
   3.5587698335966787`*^9, 3.558769935590838*^9, 3.558769981909786*^9, 
   3.558770069685959*^9, 3.558770231088286*^9, 3.5587702740046053`*^9, 
   3.558770618855234*^9, 3.5587721668407383`*^9, 3.558772705462768*^9, 
   3.5587731240347433`*^9, 3.558788098685474*^9, 3.5587881875713577`*^9, {
   3.558788243842575*^9, 3.55878828484134*^9}, 3.5587883393136263`*^9, 
   3.558825943105267*^9, 3.5588260581152067`*^9, 3.558826089871814*^9, 
   3.558838263439995*^9, 3.569830397270776*^9, 3.5720616553291135`*^9, {
   3.5720627352468815`*^9, 3.5720627616353903`*^9}, 3.572098218576439*^9, {
   3.57210112558671*^9, 3.5721011706242857`*^9}, 3.572101574419382*^9, 
   3.5721022032153473`*^9, 3.5723215000354247`*^9, 3.572321563492054*^9, 
   3.5723217303265963`*^9, {3.572330835042324*^9, 3.572330843840828*^9}, 
   3.5723549202532735`*^9, 3.57235548909781*^9, 3.5723555415468097`*^9, 
   3.572355622392434*^9, {3.5741594111903796`*^9, 3.5741594583230753`*^9}, 
   3.574160128910431*^9, 3.5747339972229843`*^9, 3.6418609384702473`*^9, 
   3.64186151596957*^9, 3.6418638095524817`*^9, 3.641864164856844*^9, 
   3.6418651289826307`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "5.967448757360216`*^-16"}], ",", 
   RowBox[{"-", "5.967448757360216`*^-16"}], ",", 
   RowBox[{"-", "4.649058915617843`*^-16"}], ",", 
   RowBox[{"-", "4.649058915617843`*^-16"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.558220578046659*^9, 3.5582206164166193`*^9}, 
   3.558220651727797*^9, 3.5582206997669697`*^9, 3.558220860617251*^9, {
   3.558220972417678*^9, 3.5582209882159023`*^9}, 3.558709471152584*^9, {
   3.558749771748107*^9, 3.558749793241334*^9}, 3.558754356381092*^9, 
   3.558754693647749*^9, 3.55875482606494*^9, 3.558769284041566*^9, 
   3.5587698335966787`*^9, 3.558769935590838*^9, 3.558769981909786*^9, 
   3.558770069685959*^9, 3.558770231088286*^9, 3.5587702740046053`*^9, 
   3.558770618855234*^9, 3.5587721668407383`*^9, 3.558772705462768*^9, 
   3.5587731240347433`*^9, 3.558788098685474*^9, 3.5587881875713577`*^9, {
   3.558788243842575*^9, 3.55878828484134*^9}, 3.5587883393136263`*^9, 
   3.558825943105267*^9, 3.5588260581152067`*^9, 3.558826089871814*^9, 
   3.558838263439995*^9, 3.569830397270776*^9, 3.5720616553291135`*^9, {
   3.5720627352468815`*^9, 3.5720627616353903`*^9}, 3.572098218576439*^9, {
   3.57210112558671*^9, 3.5721011706242857`*^9}, 3.572101574419382*^9, 
   3.5721022032153473`*^9, 3.5723215000354247`*^9, 3.572321563492054*^9, 
   3.5723217303265963`*^9, {3.572330835042324*^9, 3.572330843840828*^9}, 
   3.5723549202532735`*^9, 3.57235548909781*^9, 3.5723555415468097`*^9, 
   3.572355622392434*^9, {3.5741594111903796`*^9, 3.5741594583230753`*^9}, 
   3.574160128910431*^9, 3.5747339972229843`*^9, 3.6418609384702473`*^9, 
   3.64186151596957*^9, 3.6418638095524817`*^9, 3.641864164856844*^9, 
   3.641865128983646*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4.666467423425498`", ",", "9.98686898968089`", ",", "4.666467423425501`", 
   ",", "1.346065857170113`"}], "}"}]], "Output",
 CellChangeTimes->{{3.558220578046659*^9, 3.5582206164166193`*^9}, 
   3.558220651727797*^9, 3.5582206997669697`*^9, 3.558220860617251*^9, {
   3.558220972417678*^9, 3.5582209882159023`*^9}, 3.558709471152584*^9, {
   3.558749771748107*^9, 3.558749793241334*^9}, 3.558754356381092*^9, 
   3.558754693647749*^9, 3.55875482606494*^9, 3.558769284041566*^9, 
   3.5587698335966787`*^9, 3.558769935590838*^9, 3.558769981909786*^9, 
   3.558770069685959*^9, 3.558770231088286*^9, 3.5587702740046053`*^9, 
   3.558770618855234*^9, 3.5587721668407383`*^9, 3.558772705462768*^9, 
   3.5587731240347433`*^9, 3.558788098685474*^9, 3.5587881875713577`*^9, {
   3.558788243842575*^9, 3.55878828484134*^9}, 3.5587883393136263`*^9, 
   3.558825943105267*^9, 3.5588260581152067`*^9, 3.558826089871814*^9, 
   3.558838263439995*^9, 3.569830397270776*^9, 3.5720616553291135`*^9, {
   3.5720627352468815`*^9, 3.5720627616353903`*^9}, 3.572098218576439*^9, {
   3.57210112558671*^9, 3.5721011706242857`*^9}, 3.572101574419382*^9, 
   3.5721022032153473`*^9, 3.5723215000354247`*^9, 3.572321563492054*^9, 
   3.5723217303265963`*^9, {3.572330835042324*^9, 3.572330843840828*^9}, 
   3.5723549202532735`*^9, 3.57235548909781*^9, 3.5723555415468097`*^9, 
   3.572355622392434*^9, {3.5741594111903796`*^9, 3.5741594583230753`*^9}, 
   3.574160128910431*^9, 3.5747339972229843`*^9, 3.6418609384702473`*^9, 
   3.64186151596957*^9, 3.6418638095524817`*^9, 3.641864164856844*^9, 
   3.641865128984511*^9}],

Cell[BoxData["1.1602007831276933`"], "Output",
 CellChangeTimes->{{3.558220578046659*^9, 3.5582206164166193`*^9}, 
   3.558220651727797*^9, 3.5582206997669697`*^9, 3.558220860617251*^9, {
   3.558220972417678*^9, 3.5582209882159023`*^9}, 3.558709471152584*^9, {
   3.558749771748107*^9, 3.558749793241334*^9}, 3.558754356381092*^9, 
   3.558754693647749*^9, 3.55875482606494*^9, 3.558769284041566*^9, 
   3.5587698335966787`*^9, 3.558769935590838*^9, 3.558769981909786*^9, 
   3.558770069685959*^9, 3.558770231088286*^9, 3.5587702740046053`*^9, 
   3.558770618855234*^9, 3.5587721668407383`*^9, 3.558772705462768*^9, 
   3.5587731240347433`*^9, 3.558788098685474*^9, 3.5587881875713577`*^9, {
   3.558788243842575*^9, 3.55878828484134*^9}, 3.5587883393136263`*^9, 
   3.558825943105267*^9, 3.5588260581152067`*^9, 3.558826089871814*^9, 
   3.558838263439995*^9, 3.569830397270776*^9, 3.5720616553291135`*^9, {
   3.5720627352468815`*^9, 3.5720627616353903`*^9}, 3.572098218576439*^9, {
   3.57210112558671*^9, 3.5721011706242857`*^9}, 3.572101574419382*^9, 
   3.5721022032153473`*^9, 3.5723215000354247`*^9, 3.572321563492054*^9, 
   3.5723217303265963`*^9, {3.572330835042324*^9, 3.572330843840828*^9}, 
   3.5723549202532735`*^9, 3.57235548909781*^9, 3.5723555415468097`*^9, 
   3.572355622392434*^9, {3.5741594111903796`*^9, 3.5741594583230753`*^9}, 
   3.574160128910431*^9, 3.5747339972229843`*^9, 3.6418609384702473`*^9, 
   3.64186151596957*^9, 3.6418638095524817`*^9, 3.641864164856844*^9, 
   3.6418651289853773`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"np1", "=", 
  RowBox[{
   RowBox[{"p1", "/.", "input"}], "/.", 
   RowBox[{"realsolns", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"np2", "=", 
  RowBox[{
   RowBox[{"p2", "/.", "input"}], "/.", 
   RowBox[{"realsolns", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.558826065509202*^9, 3.558826113945031*^9}, {
  3.569831074889533*^9, 3.569831085343131*^9}, {3.5721011753505564`*^9, 
  3.572101176305611*^9}, {3.5723549319729443`*^9, 3.5723549329459996`*^9}, {
  3.574159474416996*^9, 3.5741594890378323`*^9}, {3.5747340327060137`*^9, 
  3.574734043006603*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.49824965070896277`", ",", 
   RowBox[{"-", "0.04180054507296065`"}], ",", "1.66647891992258`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.558826073752213*^9, 3.558826083715197*^9}, 
   3.558826115093013*^9, 3.5588382649179773`*^9, 3.5698304023080635`*^9, 
   3.572061658270282*^9, {3.5720627373840036`*^9, 3.572062762804457*^9}, 
   3.572098220277536*^9, {3.572101127904843*^9, 3.572101176776638*^9}, 
   3.572101581465785*^9, 3.572102206574539*^9, 3.572321567672293*^9, 
   3.5723217328437405`*^9, 3.572354933194014*^9, 3.572355491915971*^9, 
   3.5723556258506317`*^9, {3.574159461434253*^9, 3.5741594893418493`*^9}, 
   3.5741601289544334`*^9, 3.574733997924024*^9, {3.5747340336380672`*^9, 
   3.57473404330962*^9}, 3.6418609384916*^9, 3.6418615159993563`*^9, 
   3.6418638098703203`*^9, 3.641864165027137*^9, 3.6418651290169*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.6543889206002396`", ",", 
   RowBox[{"-", "0.13879459533058774`"}], ",", "1.6664789199225805`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.558826073752213*^9, 3.558826083715197*^9}, 
   3.558826115093013*^9, 3.5588382649179773`*^9, 3.5698304023080635`*^9, 
   3.572061658270282*^9, {3.5720627373840036`*^9, 3.572062762804457*^9}, 
   3.572098220277536*^9, {3.572101127904843*^9, 3.572101176776638*^9}, 
   3.572101581465785*^9, 3.572102206574539*^9, 3.572321567672293*^9, 
   3.5723217328437405`*^9, 3.572354933194014*^9, 3.572355491915971*^9, 
   3.5723556258506317`*^9, {3.574159461434253*^9, 3.5741594893418493`*^9}, 
   3.5741601289544334`*^9, 3.574733997924024*^9, {3.5747340336380672`*^9, 
   3.57473404330962*^9}, 3.6418609384916*^9, 3.6418615159993563`*^9, 
   3.6418638098703203`*^9, 3.641864165027137*^9, 3.6418651290179167`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", 
      RowBox[{"Cylinder", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"0", "/.", "input"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"l1", "/.", "input"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"r1", "/.", "input"}]}], "]"}], "}"}], "]"}], ",", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"Cylinder", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tx", ",", "ty", ",", "tz"}], "}"}], "-", 
            RowBox[{"R", ".", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"0", "/.", "input"}]}], "}"}]}]}], ")"}], "/.", 
          "input"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tx", ",", "ty", ",", "tz"}], "}"}], "+", 
            RowBox[{"R", ".", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"l2", "/.", "input"}]}], "}"}]}]}], ")"}], "/.", 
          "input"}]}], "}"}], ",", 
       RowBox[{"r2", "/.", "input"}]}], "]"}], "]"}], ",", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.01", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"np1", ",", "np2"}], "}"}], "]"}]}], "}"}], "]"}], ",", " ", 
    
    RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5587795093706617`*^9, 3.558779564496065*^9}, {
   3.55877967345051*^9, 3.558779784653714*^9}, {3.558788107977495*^9, 
   3.558788157697606*^9}, {3.55878819926399*^9, 3.5587882230783567`*^9}, {
   3.5721011892353506`*^9, 3.5721012031031437`*^9}, {3.5721012470306563`*^9, 
   3.572101248979768*^9}, {3.5721013155105734`*^9, 3.572101388389742*^9}, {
   3.5721015940635056`*^9, 3.572101596796662*^9}, 3.5721022155310516`*^9, {
   3.5723549421605268`*^9, 3.572354948124868*^9}, {3.5723549849579744`*^9, 
   3.572355004397086*^9}, 3.5723554958051934`*^9}],

Cell[BoxData[
 Graphics3DBox[{CylinderBox[{{0, 0, 0}, {0, 0, 7}}, 0.5], 
   CylinderBox[{{2, -2, 2}, {2.3289608678498404`, 1.921112445232791, 
     1.2812080000000001`}}, 0.5], 
   {Thickness[0.01], 
    Line3DBox[{{0.49824965070896277`, -0.04180054507296065, 
     1.66647891992258}, {1.6543889206002396`, -0.13879459533058774`, 
     1.6664789199225805`}}]}},
  AutomaticImageSize->True,
  Boxed->False,
  ImageSize->{414.3318617591831, 364.22078793848686`},
  ViewPoint->{0.20324163788117022`, 3.0465941526647087`, 1.4584090323296186`},
  
  ViewVertical->{1.6392927413471685`, 0.06922242339226348, 
   0.625456843233328}]], "Output",
 CellChangeTimes->{{3.5587795291426973`*^9, 3.558779565368815*^9}, {
   3.5587796744213743`*^9, 3.558779702765456*^9}, {3.558779734454988*^9, 
   3.558779785558836*^9}, 3.5587881085765963`*^9, {3.558788140575094*^9, 
   3.558788158276354*^9}, {3.5587881888493977`*^9, 3.5587882865879107`*^9}, 
   3.5587883401810703`*^9, 3.558826117257182*^9, 3.558838266044379*^9, 
   3.569830406058278*^9, 3.572061661427462*^9, {3.572062747522583*^9, 
   3.5720627639615235`*^9}, 3.572098222669673*^9, 3.572101129552937*^9, {
   3.5721011796198006`*^9, 3.572101203578171*^9}, 3.5721012494807963`*^9, {
   3.572101320324848*^9, 3.5721013886507564`*^9}, {3.572101582639852*^9, 
   3.572101597341693*^9}, {3.572102207846612*^9, 3.5721022161520867`*^9}, 
   3.572321568989369*^9, 3.572321735002864*^9, {3.5723549365972085`*^9, 
   3.5723549484698877`*^9}, {3.572354985826024*^9, 3.5723550050651245`*^9}, 
   3.572355496396227*^9, 3.57235562722571*^9, {3.5741594653464775`*^9, 
   3.574159478462227*^9}, 3.574160129048439*^9, 3.5747339986530657`*^9, {
   3.574734034760131*^9, 3.5747340441166663`*^9}, 3.641860938513413*^9, 
   3.641861516030356*^9, 3.6418638099983673`*^9, 3.641864165177137*^9, 
   3.641865129047007*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5580858843897543`*^9, 3.5580858844151278`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"np", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t0", " ", 
         RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], ",", 
        RowBox[{"t0", " ", 
         RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], ",", 
        RowBox[{"l1", " ", "t1"}]}], "}"}], "-", "np2"}], ")"}], "/.", 
    "input"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.572355147519273*^9, 3.5723552090607924`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1.6543889206002396`"}], "+", 
    RowBox[{"t0", " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}]}], ",", 
   RowBox[{"0.13879459533058774`", "\[VeryThinSpace]", "+", 
    RowBox[{"t0", " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.6664789199225805`"}], "+", 
    RowBox[{"7", " ", "t1"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.572355197928156*^9, 3.5723552098008347`*^9}, 
   3.6418609385228653`*^9, 3.6418615160457153`*^9, 3.6418638100380507`*^9, 
   3.6418641652476587`*^9, 3.641865129057702*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"np", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], ",", "t1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.572355211149912*^9, 3.572355218769348*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"t1", "\[Rule]", "0.23806841713179722`"}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{{3.572355212395983*^9, 3.5723552190953665`*^9}, 
   3.641860938548255*^9, 3.641861516073447*^9, 3.641863810268079*^9, 
   3.641864165453418*^9, 3.6418651290865803`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Numerator", "[", 
     RowBox[{"Together", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"np", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"np", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], "^", "2"}], "-", 
       "1"}], "]"}], "]"}], "\[Equal]", "0"}], ",", "t0"}], "]"}]], "Input",
 CellChangeTimes->{{3.5723552455958824`*^9, 3.5723553146238303`*^9}},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"t0", "\[Rule]", 
     RowBox[{"-", "1.6602007831276937`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t0", "\[Rule]", "1.6602007831276937`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.5723552426307125`*^9, {3.572355274310525*^9, 3.5723553149888515`*^9}, 
   3.6418609387597523`*^9, 3.641861516101606*^9, 3.641863810535452*^9, 
   3.641864165578616*^9, 3.641865129208065*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.641863338044094*^9, 3.641863341528809*^9}}]
},
WindowSize->{1535, 876},
WindowMargins->{{-10, Automatic}, {Automatic, -10}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> True}},
ShowSelection->True,
Magnification->1.5,
FrontEndVersion->"10.0 for Linux x86 (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 400, 10, 115, "Input",
 Evaluatable->False],
Cell[960, 32, 496, 16, 44, "Input"],
Cell[CellGroupData[{
Cell[1481, 52, 1838, 40, 241, "Input"],
Cell[3322, 94, 1527, 26, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4886, 125, 5001, 120, 605, "Input"],
Cell[9890, 247, 1996, 56, 123, "Output"],
Cell[11889, 305, 2416, 69, 120, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14342, 379, 2001, 65, 493, "Input"],
Cell[16346, 446, 380, 11, 44, "Output"],
Cell[16729, 459, 856, 29, 72, "Output"],
Cell[17588, 490, 1528, 50, 72, "Output"],
Cell[19119, 542, 2712, 89, 110, "Output"],
Cell[21834, 633, 2331, 77, 143, "Output"],
Cell[24168, 712, 4789, 154, 319, "Output"],
Cell[28960, 868, 4789, 154, 319, "Output"]
}, Open  ]],
Cell[33764, 1025, 257, 7, 44, "Input"],
Cell[CellGroupData[{
Cell[34046, 1036, 573, 15, 44, "Input"],
Cell[34622, 1053, 600, 16, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35259, 1074, 273, 7, 44, "Input"],
Cell[35535, 1083, 2635, 85, 171, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38207, 1173, 300, 8, 44, "Input"],
Cell[38510, 1183, 2459, 71, 120, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41006, 1259, 126, 2, 44, "Input"],
Cell[41135, 1263, 623, 19, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41795, 1287, 353, 9, 44, "Input"],
Cell[42151, 1298, 759, 22, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42947, 1325, 1649, 47, 73, "Input"],
Cell[44599, 1374, 4646, 144, 331, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49282, 1523, 1560, 39, 213, "Input"],
Cell[50845, 1564, 9301, 272, 393, "Output"],
Cell[60149, 1838, 602, 10, 34, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60788, 1853, 657, 15, 44, "Input"],
Cell[61448, 1870, 9017, 261, 351, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70502, 2136, 459, 10, 44, "Input"],
Cell[70964, 2148, 2569, 53, 110, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73570, 2206, 480, 12, 73, "Input"],
Cell[74053, 2220, 4245, 88, 173, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78335, 2313, 444, 10, 44, "Input"],
Cell[78782, 2325, 2194, 39, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81013, 2369, 445, 11, 73, "Input"],
Cell[81461, 2382, 3216, 71, 116, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84714, 2458, 357, 7, 44, "Input"],
Cell[85074, 2467, 3443, 99, 133, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88554, 2571, 159, 3, 44, "Input"],
Cell[88716, 2576, 3421, 81, 144, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92174, 2662, 305, 7, 44, "Input"],
Cell[92482, 2671, 20415, 627, 1008, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112934, 3303, 329, 7, 44, "Input"],
Cell[113266, 3312, 11901, 316, 431, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125204, 3633, 205, 4, 44, "Input"],
Cell[125412, 3639, 15556, 395, 640, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141005, 4039, 296, 6, 44, "Input"],
Cell[141304, 4047, 265, 4, 99, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141606, 4056, 125, 2, 44, "Input"],
Cell[141734, 4060, 380, 7, 34, "Print"]
}, Open  ]],
Cell[142129, 4070, 1928, 49, 129, "Input"],
Cell[CellGroupData[{
Cell[144082, 4123, 1350, 28, 73, "Input"],
Cell[145435, 4153, 6151, 157, 250, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151623, 4315, 799, 18, 101, "Input"],
Cell[152425, 4335, 3862, 83, 174, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156324, 4423, 1027, 27, 80, "Input"],
Cell[157354, 4452, 3644, 82, 174, "Output"]
}, Open  ]],
Cell[161013, 4537, 7506, 187, 1081, "Input"],
Cell[CellGroupData[{
Cell[168544, 4728, 1076, 23, 129, "Input"],
Cell[169623, 4753, 4426, 94, 178, "Output"],
Cell[174052, 4849, 4428, 94, 178, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178517, 4948, 670, 19, 44, "Input"],
Cell[179190, 4969, 32760, 742, 1266, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[211987, 5716, 452, 10, 44, "Input"],
Cell[212442, 5728, 243, 4, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212722, 5737, 215, 6, 44, "Input"],
Cell[212940, 5745, 484, 12, 99, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[213461, 5762, 452, 12, 44, "Input"],
Cell[213916, 5776, 548, 14, 69, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214501, 5795, 326, 8, 44, "Input"],
Cell[214830, 5805, 1259, 41, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[216126, 5851, 557, 16, 44, "Input"],
Cell[216686, 5869, 182, 3, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[216905, 5877, 3167, 88, 213, "Input"],
Cell[220075, 5967, 11746, 314, 650, "Output"]
}, Open  ]],
Cell[231836, 6284, 8008, 189, 745, "Input"],
Cell[CellGroupData[{
Cell[239869, 6477, 4627, 96, 157, "Input"],
Cell[244499, 6575, 2096, 31, 670, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[246632, 6611, 458, 12, 73, "Input"],
Cell[247093, 6625, 545, 12, 44, "Output"],
Cell[247641, 6639, 621, 12, 34, "Message"],
Cell[248265, 6653, 527, 12, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[248829, 6670, 6345, 167, 353, "Input"],
Cell[255177, 6839, 6941, 156, 325, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[262155, 7000, 3642, 86, 353, "Input"],
Cell[265800, 7088, 2381, 48, 101, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[268218, 7141, 155, 3, 44, "Input"],
Cell[268376, 7146, 1560, 30, 117, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[269973, 7181, 1256, 29, 213, "Input"],
Cell[271232, 7212, 1698, 25, 52, "Output"],
Cell[272933, 7239, 1658, 25, 52, "Output"],
Cell[274594, 7266, 1740, 27, 52, "Output"],
Cell[276337, 7295, 1736, 27, 52, "Output"],
Cell[278076, 7324, 1646, 25, 44, "Output"],
Cell[279725, 7351, 1527, 21, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[281289, 7377, 655, 15, 73, "Input"],
Cell[281947, 7394, 878, 14, 44, "Output"],
Cell[282828, 7410, 883, 14, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[283748, 7429, 2322, 59, 129, "Input"],
Cell[286073, 7490, 1840, 31, 568, "Output"]
}, Open  ]],
Cell[287928, 7524, 96, 1, 44, "Input"],
Cell[CellGroupData[{
Cell[288049, 7529, 487, 14, 73, "Input"],
Cell[288539, 7545, 624, 15, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[289200, 7565, 239, 7, 44, "Input"],
Cell[289442, 7574, 313, 7, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[289792, 7586, 1049, 29, 73, "Input"],
Cell[290844, 7617, 460, 12, 44, "Output"]
}, Open  ]],
Cell[291319, 7632, 92, 1, 44, "Input"]
}
]
*)

(* End of internal cache information *)
