(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    259789,       6686]
NotebookOptionsPosition[    253023,       6464]
NotebookOutlinePosition[    253478,       6482]
CellTagsIndexPosition[    253435,       6479]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.6419963050220633`*^9}],

Cell["\<\
(*
Programme for finding the least distance (i.e., finding the proximity) \
between two infinite cylindrical surfaces
*)\[LineSeparator]\
\>", "Input",
 Evaluatable->False,
 CellChangeTimes->{
  3.558075401021812*^9, {3.558075433176977*^9, 3.55807549337778*^9}, 
   3.5580756045375433`*^9, {3.5698304191010246`*^9, 3.569830422737232*^9}, {
   3.5704363618914156`*^9, 3.570436361997422*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"norm", "[", "v_", "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "+", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6417734660048923`*^9, 3.641773505431644*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "define", " ", "the", " ", "first", " ", "cylinder", " ", "in", " ", "its",
     " ", "local", " ", "frame", " ", "of", " ", "reference"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", " ", "y1"}], "}"}], " ", "=", " ", 
     RowBox[{"r1", " ", "*", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], ",", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z1", " ", "=", " ", 
     RowBox[{"l1", "*", "t1"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "define", " ", "a", " ", "point", " ", "on", " ", "the", " ", 
     "cylinder"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   
   RowBox[{"p1", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.558073458170795*^9, 3.558073553293523*^9}, {
   3.55807371917924*^9, 3.5580737362448263`*^9}, {3.558096992182033*^9, 
   3.558096992876449*^9}, {3.5580976551705437`*^9, 3.5580976563218107`*^9}, 
   3.5580976996167173`*^9, {3.558098725578822*^9, 3.5580987512630997`*^9}, {
   3.558142950725593*^9, 3.558142991505747*^9}, {3.5587083423965797`*^9, 
   3.558708342701953*^9}, 3.5587084020411243`*^9, {3.55877071174793*^9, 
   3.558770719365891*^9}, 3.558771208567287*^9, {3.558772402537244*^9, 
   3.5587724069393177`*^9}, {3.558773240379507*^9, 3.558773272034829*^9}, 
   3.5587750721059427`*^9, {3.558781569802609*^9, 3.55878158664182*^9}, {
   3.558786957930822*^9, 3.558786962508292*^9}, {3.55882511647033*^9, 
   3.558825117438373*^9}, 3.558837829436367*^9, {3.6417305077566357`*^9, 
   3.6417305154721937`*^9}, {3.6419848169211407`*^9, 3.641984817029873*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"r1", " ", 
    RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], ",", 
   RowBox[{"r1", " ", 
    RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], ",", 
   RowBox[{"l1", " ", "t1"}]}], "}"}]], "Output",
 CellChangeTimes->{3.641984834854495*^9, 3.641985725530674*^9, 
  3.641986606539859*^9, 3.641987994209868*^9, 3.641996307741263*^9, 
  3.6419987014073277`*^9, 3.6419990176088543`*^9, 3.6419991932988234`*^9, 
  3.642292491654409*^9, 3.642292546609992*^9, 3.6426676368228827`*^9, 
  3.642667688661045*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "define", " ", "the", " ", "second", " ", "cylinder", " ", "likewise"}], 
   " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x2", ",", " ", "y2"}], "}"}], " ", "=", " ", 
     RowBox[{"r2", " ", "*", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]2", "]"}], ",", " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z2", " ", "=", " ", 
     RowBox[{"l2", "*", "t2"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "take", " ", "the", " ", "second", " ", "cylinder", " ", "to", " ", "a", 
     " ", "generic", " ", "configuration"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"define", " ", "the", " ", "orientation"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"q0", "^", "2"}], "+", 
          RowBox[{"q1", "^", "2"}], "-", 
          RowBox[{"q2", "^", "2"}], "-", 
          RowBox[{"q3", "^", "2"}]}], ",", 
         RowBox[{
          RowBox[{"2", " ", "q1", " ", "q2"}], "-", 
          RowBox[{"2", " ", "q0", " ", "q3"}]}], ",", 
         RowBox[{
          RowBox[{"2", " ", "q1", " ", "q3"}], "+", 
          RowBox[{"2", " ", "q0", " ", "q2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
          RowBox[{"2", " ", "q0", " ", "q3"}]}], ",", 
         RowBox[{
          RowBox[{"q0", "^", "2"}], "-", 
          RowBox[{"q1", "^", "2"}], "+", 
          RowBox[{"q2", "^", "2"}], "-", 
          RowBox[{"q3", "^", "2"}]}], ",", 
         RowBox[{
          RowBox[{"2", " ", "q2", " ", "q3"}], "-", 
          RowBox[{"2", "q0", " ", "q1"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", "q1", " ", "q3"}], "-", 
          RowBox[{"2", " ", "q0", " ", "q2"}]}], ",", 
         RowBox[{
          RowBox[{"2", "q2", " ", "q3"}], "+", 
          RowBox[{"2", " ", "q0", " ", "q1"}]}], ",", " ", 
         RowBox[{
          RowBox[{"q0", "^", "2"}], "-", 
          RowBox[{"q1", "^", "2"}], "-", 
          RowBox[{"q2", "^", "2"}], "+", 
          RowBox[{"q3", "^", "2"}]}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"const1", "=", 
     RowBox[{
      RowBox[{"q0", "^", "2"}], "+", 
      RowBox[{"q1", "^", "2"}], "+", 
      RowBox[{"q2", "^", "2"}], "+", 
      RowBox[{"q3", "^", "2"}], "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "R", "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "define", " ", "the", " ", "position", " ", "of", " ", "the", " ", 
     "\"\<origin\>\""}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"o2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"o2x", ",", "o2y", ",", "o2z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "define", " ", "a", " ", "point", " ", "on", " ", "the", " ", "second", 
      " ", "cylinder"}], ",", " ", 
     RowBox[{
     "expressed", " ", "in", " ", "the", " ", "frame", " ", "of", " ", 
      "reference", " ", "of", " ", "the", " ", "first", " ", "cylinder"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"p2", " ", "=", " ", 
    RowBox[{"o2", "+", " ", 
     RowBox[{"R", ".", 
      RowBox[{"{", 
       RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], "}"}]}]}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.558073458170795*^9, 3.558073709507827*^9}, {
   3.558073740454792*^9, 3.5580738049933653`*^9}, 3.558082148926989*^9, {
   3.558096355912854*^9, 3.55809635695401*^9}, {3.558096434825989*^9, 
   3.5580964407635508`*^9}, {3.558096566201684*^9, 3.558096566383749*^9}, 
   3.5580968035030537`*^9, {3.558143008551819*^9, 3.5581430129027843`*^9}, {
   3.558221056875045*^9, 3.558221058367564*^9}, {3.558707871191598*^9, 
   3.5587080532057667`*^9}, {3.558708086242559*^9, 3.558708138196657*^9}, {
   3.5587081864836493`*^9, 3.558708197922638*^9}, {3.5587082919003572`*^9, 
   3.558708296868143*^9}, 3.558708403965981*^9, {3.558770730864664*^9, 
   3.5587707355707817`*^9}, 3.558771211427903*^9, {3.558772411253378*^9, 
   3.5587724139794683`*^9}, {3.558773268116036*^9, 3.558773271162249*^9}, 
   3.558775076077957*^9, {3.558781591525593*^9, 3.558781593321697*^9}, {
   3.558787035778143*^9, 3.558787038400735*^9}, {3.558825124510339*^9, 
   3.5588251252333527`*^9}, 3.5588378353835907`*^9, {3.572061196104847*^9, 
   3.572061196569874*^9}, {3.572062554819561*^9, 3.572062606148497*^9}, {
   3.6417242002796507`*^9, 3.641724200561116*^9}, {3.641724258488736*^9, 
   3.641724260835505*^9}, {3.641724367145602*^9, 3.641724371255323*^9}, {
   3.641724458014904*^9, 3.6417244731663218`*^9}, {3.641730231495648*^9, 
   3.6417302694360237`*^9}, {3.6417305231269083`*^9, 3.641730527454173*^9}, {
   3.641984821917067*^9, 3.641984822034424*^9}, {3.6419855591799583`*^9, 
   3.641985560436849*^9}, {3.642292538653015*^9, 3.642292542497696*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q1", "2"], "-", 
       SuperscriptBox["q2", "2"], "-", 
       SuperscriptBox["q3", "2"]}], 
      RowBox[{
       RowBox[{"2", " ", "q1", " ", "q2"}], "-", 
       RowBox[{"2", " ", "q0", " ", "q3"}]}], 
      RowBox[{
       RowBox[{"2", " ", "q0", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q1", " ", "q3"}]}]},
     {
      RowBox[{
       RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q0", " ", "q3"}]}], 
      RowBox[{
       SuperscriptBox["q0", "2"], "-", 
       SuperscriptBox["q1", "2"], "+", 
       SuperscriptBox["q2", "2"], "-", 
       SuperscriptBox["q3", "2"]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q0", " ", "q1"}], "+", 
       RowBox[{"2", " ", "q2", " ", "q3"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q0", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q1", " ", "q3"}]}], 
      RowBox[{
       RowBox[{"2", " ", "q0", " ", "q1"}], "+", 
       RowBox[{"2", " ", "q2", " ", "q3"}]}], 
      RowBox[{
       SuperscriptBox["q0", "2"], "-", 
       SuperscriptBox["q1", "2"], "-", 
       SuperscriptBox["q2", "2"], "+", 
       SuperscriptBox["q3", "2"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6419848360129757`*^9, 3.641985560936475*^9, 
  3.641985725561706*^9, 3.641986606574771*^9, 3.641987994238468*^9, 
  3.641996307810343*^9, 3.641998701510869*^9, 3.641999017633368*^9, 
  3.641999193428728*^9, 3.6422924917065773`*^9, 3.6422925466332293`*^9, 
  3.642667636856022*^9, 3.6426676886956167`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"o2x", "+", 
    RowBox[{"l2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q0", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q1", " ", "q3"}]}], ")"}], " ", "t2"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q1", "2"], "-", 
       SuperscriptBox["q2", "2"], "-", 
       SuperscriptBox["q3", "2"]}], ")"}], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q1", " ", "q2"}], "-", 
       RowBox[{"2", " ", "q0", " ", "q3"}]}], ")"}], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
   RowBox[{"o2y", "+", 
    RowBox[{"l2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q0", " ", "q1"}], "+", 
       RowBox[{"2", " ", "q2", " ", "q3"}]}], ")"}], " ", "t2"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q0", " ", "q3"}]}], ")"}], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "-", 
       SuperscriptBox["q1", "2"], "+", 
       SuperscriptBox["q2", "2"], "-", 
       SuperscriptBox["q3", "2"]}], ")"}], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
   RowBox[{"o2z", "+", 
    RowBox[{"l2", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "-", 
       SuperscriptBox["q1", "2"], "-", 
       SuperscriptBox["q2", "2"], "+", 
       SuperscriptBox["q3", "2"]}], ")"}], " ", "t2"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q0", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q1", " ", "q3"}]}], ")"}], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q0", " ", "q1"}], "+", 
       RowBox[{"2", " ", "q2", " ", "q3"}]}], ")"}], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6419848360129757`*^9, 3.641985560936475*^9, 
  3.641985725561706*^9, 3.641986606574771*^9, 3.641987994238468*^9, 
  3.641996307810343*^9, 3.641998701510869*^9, 3.641999017633368*^9, 
  3.641999193428728*^9, 3.6422924917065773`*^9, 3.6422925466332293`*^9, 
  3.642667636856022*^9, 3.642667688697253*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qi", "=", 
   RowBox[{"{", 
    RowBox[{"q0i", ",", "q1i", ",", "q2i", ",", "q3i"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qf", "=", 
   RowBox[{"{", 
    RowBox[{"q0f", ",", "q1f", ",", "q2f", ",", "q3f"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"omega", "=", 
   RowBox[{"ArcCos", "[", 
    RowBox[{"qi", ".", "qf"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qt", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "u"}], ")"}], "*", "omega"}], "]"}], "*", "qi"}], 
     "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"u", "*", "omega"}], "]"}], "*", "qf"}]}], ")"}], "/", 
   RowBox[{"Sin", "[", "omega", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"qsubs", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q0", "\[Rule]", " ", 
      RowBox[{"qt", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"q1", "\[Rule]", " ", 
      RowBox[{"qt", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", 
     RowBox[{"q2", "\[Rule]", " ", 
      RowBox[{"qt", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ",", 
     RowBox[{"q3", "\[Rule]", " ", 
      RowBox[{"qt", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.642292299764509*^9, 3.6422925028711042`*^9}, {
  3.642667681721826*^9, 3.642667684121457*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"q0i", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "u"}], ")"}], " ", 
        RowBox[{"ArcCos", "[", 
         RowBox[{
          RowBox[{"q0f", " ", "q0i"}], "+", 
          RowBox[{"q1f", " ", "q1i"}], "+", 
          RowBox[{"q2f", " ", "q2i"}], "+", 
          RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}], "+", 
     RowBox[{"q0f", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"u", " ", 
        RowBox[{"ArcCos", "[", 
         RowBox[{
          RowBox[{"q0f", " ", "q0i"}], "+", 
          RowBox[{"q1f", " ", "q1i"}], "+", 
          RowBox[{"q2f", " ", "q2i"}], "+", 
          RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}]}], 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q0f", " ", "q0i"}], "+", 
         RowBox[{"q1f", " ", "q1i"}], "+", 
         RowBox[{"q2f", " ", "q2i"}], "+", 
         RowBox[{"q3f", " ", "q3i"}]}], ")"}], "2"]}]]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"q1i", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "u"}], ")"}], " ", 
        RowBox[{"ArcCos", "[", 
         RowBox[{
          RowBox[{"q0f", " ", "q0i"}], "+", 
          RowBox[{"q1f", " ", "q1i"}], "+", 
          RowBox[{"q2f", " ", "q2i"}], "+", 
          RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}], "+", 
     RowBox[{"q1f", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"u", " ", 
        RowBox[{"ArcCos", "[", 
         RowBox[{
          RowBox[{"q0f", " ", "q0i"}], "+", 
          RowBox[{"q1f", " ", "q1i"}], "+", 
          RowBox[{"q2f", " ", "q2i"}], "+", 
          RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}]}], 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q0f", " ", "q0i"}], "+", 
         RowBox[{"q1f", " ", "q1i"}], "+", 
         RowBox[{"q2f", " ", "q2i"}], "+", 
         RowBox[{"q3f", " ", "q3i"}]}], ")"}], "2"]}]]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"q2i", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "u"}], ")"}], " ", 
        RowBox[{"ArcCos", "[", 
         RowBox[{
          RowBox[{"q0f", " ", "q0i"}], "+", 
          RowBox[{"q1f", " ", "q1i"}], "+", 
          RowBox[{"q2f", " ", "q2i"}], "+", 
          RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}], "+", 
     RowBox[{"q2f", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"u", " ", 
        RowBox[{"ArcCos", "[", 
         RowBox[{
          RowBox[{"q0f", " ", "q0i"}], "+", 
          RowBox[{"q1f", " ", "q1i"}], "+", 
          RowBox[{"q2f", " ", "q2i"}], "+", 
          RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}]}], 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q0f", " ", "q0i"}], "+", 
         RowBox[{"q1f", " ", "q1i"}], "+", 
         RowBox[{"q2f", " ", "q2i"}], "+", 
         RowBox[{"q3f", " ", "q3i"}]}], ")"}], "2"]}]]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"q3i", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "u"}], ")"}], " ", 
        RowBox[{"ArcCos", "[", 
         RowBox[{
          RowBox[{"q0f", " ", "q0i"}], "+", 
          RowBox[{"q1f", " ", "q1i"}], "+", 
          RowBox[{"q2f", " ", "q2i"}], "+", 
          RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}], "+", 
     RowBox[{"q3f", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"u", " ", 
        RowBox[{"ArcCos", "[", 
         RowBox[{
          RowBox[{"q0f", " ", "q0i"}], "+", 
          RowBox[{"q1f", " ", "q1i"}], "+", 
          RowBox[{"q2f", " ", "q2i"}], "+", 
          RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}]}], 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q0f", " ", "q0i"}], "+", 
         RowBox[{"q1f", " ", "q1i"}], "+", 
         RowBox[{"q2f", " ", "q2i"}], "+", 
         RowBox[{"q3f", " ", "q3i"}]}], ")"}], "2"]}]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.642292491727005*^9, 3.642292503424939*^9}, 
   3.642292546660767*^9, 3.6426676368820257`*^9, 3.642667688720049*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"q0", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"q0i", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "u"}], ")"}], " ", 
         RowBox[{"ArcCos", "[", 
          RowBox[{
           RowBox[{"q0f", " ", "q0i"}], "+", 
           RowBox[{"q1f", " ", "q1i"}], "+", 
           RowBox[{"q2f", " ", "q2i"}], "+", 
           RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}], "+", 
      RowBox[{"q0f", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"u", " ", 
         RowBox[{"ArcCos", "[", 
          RowBox[{
           RowBox[{"q0f", " ", "q0i"}], "+", 
           RowBox[{"q1f", " ", "q1i"}], "+", 
           RowBox[{"q2f", " ", "q2i"}], "+", 
           RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}]}], 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q0f", " ", "q0i"}], "+", 
          RowBox[{"q1f", " ", "q1i"}], "+", 
          RowBox[{"q2f", " ", "q2i"}], "+", 
          RowBox[{"q3f", " ", "q3i"}]}], ")"}], "2"]}]]]}], ",", 
   RowBox[{"q1", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"q1i", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "u"}], ")"}], " ", 
         RowBox[{"ArcCos", "[", 
          RowBox[{
           RowBox[{"q0f", " ", "q0i"}], "+", 
           RowBox[{"q1f", " ", "q1i"}], "+", 
           RowBox[{"q2f", " ", "q2i"}], "+", 
           RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}], "+", 
      RowBox[{"q1f", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"u", " ", 
         RowBox[{"ArcCos", "[", 
          RowBox[{
           RowBox[{"q0f", " ", "q0i"}], "+", 
           RowBox[{"q1f", " ", "q1i"}], "+", 
           RowBox[{"q2f", " ", "q2i"}], "+", 
           RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}]}], 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q0f", " ", "q0i"}], "+", 
          RowBox[{"q1f", " ", "q1i"}], "+", 
          RowBox[{"q2f", " ", "q2i"}], "+", 
          RowBox[{"q3f", " ", "q3i"}]}], ")"}], "2"]}]]]}], ",", 
   RowBox[{"q2", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"q2i", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "u"}], ")"}], " ", 
         RowBox[{"ArcCos", "[", 
          RowBox[{
           RowBox[{"q0f", " ", "q0i"}], "+", 
           RowBox[{"q1f", " ", "q1i"}], "+", 
           RowBox[{"q2f", " ", "q2i"}], "+", 
           RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}], "+", 
      RowBox[{"q2f", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"u", " ", 
         RowBox[{"ArcCos", "[", 
          RowBox[{
           RowBox[{"q0f", " ", "q0i"}], "+", 
           RowBox[{"q1f", " ", "q1i"}], "+", 
           RowBox[{"q2f", " ", "q2i"}], "+", 
           RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}]}], 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q0f", " ", "q0i"}], "+", 
          RowBox[{"q1f", " ", "q1i"}], "+", 
          RowBox[{"q2f", " ", "q2i"}], "+", 
          RowBox[{"q3f", " ", "q3i"}]}], ")"}], "2"]}]]]}], ",", 
   RowBox[{"q3", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"q3i", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "u"}], ")"}], " ", 
         RowBox[{"ArcCos", "[", 
          RowBox[{
           RowBox[{"q0f", " ", "q0i"}], "+", 
           RowBox[{"q1f", " ", "q1i"}], "+", 
           RowBox[{"q2f", " ", "q2i"}], "+", 
           RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}], "+", 
      RowBox[{"q3f", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"u", " ", 
         RowBox[{"ArcCos", "[", 
          RowBox[{
           RowBox[{"q0f", " ", "q0i"}], "+", 
           RowBox[{"q1f", " ", "q1i"}], "+", 
           RowBox[{"q2f", " ", "q2i"}], "+", 
           RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}]}], 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q0f", " ", "q0i"}], "+", 
          RowBox[{"q1f", " ", "q1i"}], "+", 
          RowBox[{"q2f", " ", "q2i"}], "+", 
          RowBox[{"q3f", " ", "q3i"}]}], ")"}], "2"]}]]]}]}], "}"}]], "Output",\

 CellChangeTimes->{{3.642292491727005*^9, 3.642292503424939*^9}, 
   3.642292546660767*^9, 3.6426676368820257`*^9, 3.642667688775035*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"algvars", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "t1", ",", "t2", ",", "\[Alpha]", ",", " ", "r1", ",", " ", "r2", ",", 
       " ", "l1", ",", " ", "l2"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"size", "[", "x_", "]"}], " ", ":=", "  ", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Size of the expression is:\>\"", ",", " ", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"ByteCount", "[", "x", "]"}], "/", "1000"}], "]"}], ",", 
       "  ", "\"\< KB.\>\""}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.558074291890336*^9, 3.5580743032330713`*^9}, 
   3.57209863436522*^9, {3.6417245374521227`*^9, 3.641724543749633*^9}, 
   3.641774337876727*^9, {3.641985665902939*^9, 3.641985678941285*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "define", " ", "the", " ", "distance", " ", "between", " ", "p1"}], ",", 
    " ", "p2"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"d", " ", "=", " ", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"Numerator", "[", 
       RowBox[{"Together", "[", 
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p1", " ", "-", " ", "p2"}], ")"}], ".", " ", 
          RowBox[{"(", 
           RowBox[{"p1", " ", "-", " ", "p2"}], ")"}]}], "]"}], "]"}], "]"}], 
      ",", "algvars", " ", ",", " ", "Simplify"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"size", "[", "d", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.558074291890336*^9, 3.5580743032330713`*^9}, 
   3.57209863436522*^9, {3.6417245374521227`*^9, 3.641724543749633*^9}, {
   3.641774337876727*^9, 3.641774354680709*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["o2x", "2"], "+", 
  SuperscriptBox["o2y", "2"], "+", 
  SuperscriptBox["o2z", "2"], "+", 
  SuperscriptBox["r1", "2"], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["q0", "2"], "+", 
      SuperscriptBox["q1", "2"], "+", 
      SuperscriptBox["q2", "2"], "+", 
      SuperscriptBox["q3", "2"]}], ")"}], "2"], " ", 
   SuperscriptBox["r2", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["l1", "2"], " ", 
   SuperscriptBox["t1", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["l2", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["q0", "2"], "+", 
      SuperscriptBox["q1", "2"], "+", 
      SuperscriptBox["q2", "2"], "+", 
      SuperscriptBox["q3", "2"]}], ")"}], "2"], " ", 
   SuperscriptBox["t2", "2"]}], "+", 
  RowBox[{"t2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "l2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "o2y"}], " ", "q0", " ", "q1"}], "+", 
           RowBox[{"o2x", " ", "q0", " ", "q2"}], "+", 
           RowBox[{"o2x", " ", "q1", " ", "q3"}], "+", 
           RowBox[{"o2y", " ", "q2", " ", "q3"}]}], ")"}]}], "+", 
        RowBox[{"o2z", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["q0", "2"], "-", 
           SuperscriptBox["q1", "2"], "-", 
           SuperscriptBox["q2", "2"], "+", 
           SuperscriptBox["q3", "2"]}], ")"}]}]}], ")"}]}], "-", 
     RowBox[{"4", " ", "l2", " ", "r1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q0", " ", "q2"}], "+", 
           RowBox[{"q1", " ", "q3"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "q0"}], " ", "q1"}], "+", 
           RowBox[{"q2", " ", "q3"}]}], ")"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
  
  RowBox[{"2", " ", "r2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "o2z"}], " ", "q0", " ", "q2"}], "+", 
           RowBox[{"o2y", " ", "q1", " ", "q2"}], "+", 
           RowBox[{"o2y", " ", "q0", " ", "q3"}], "+", 
           RowBox[{"o2z", " ", "q1", " ", "q3"}]}], ")"}]}], "+", 
        RowBox[{"o2x", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["q0", "2"], "+", 
           SuperscriptBox["q1", "2"], "-", 
           SuperscriptBox["q2", "2"], "-", 
           SuperscriptBox["q3", "2"]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"o2z", " ", "q0", " ", "q1"}], "+", 
           RowBox[{"o2x", " ", "q1", " ", "q2"}], "-", 
           RowBox[{"o2x", " ", "q0", " ", "q3"}], "+", 
           RowBox[{"o2z", " ", "q2", " ", "q3"}]}], ")"}]}], "+", 
        RowBox[{"o2y", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["q0", "2"], "-", 
           SuperscriptBox["q1", "2"], "+", 
           SuperscriptBox["q2", "2"], "-", 
           SuperscriptBox["q3", "2"]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"t1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "l1", " ", "o2z"}], "-", 
     RowBox[{"2", " ", "l1", " ", "l2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["q0", "2"], "-", 
        SuperscriptBox["q1", "2"], "-", 
        SuperscriptBox["q2", "2"], "+", 
        SuperscriptBox["q3", "2"]}], ")"}], " ", "t2"}], "-", 
     RowBox[{"4", " ", "l1", " ", "r2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "q0"}], " ", "q2"}], "+", 
           RowBox[{"q1", " ", "q3"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q0", " ", "q1"}], "+", 
           RowBox[{"q2", " ", "q3"}]}], ")"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
  
  RowBox[{"r1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"o2x", " ", 
         RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
        RowBox[{"o2y", " ", 
         RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "r2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["q0", "2"], "-", 
           SuperscriptBox["q3", "2"]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["q1", "2"], "-", 
           SuperscriptBox["q2", "2"]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q0", " ", "q3", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
           RowBox[{"q1", " ", "q2", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.6419866103512783`*^9, 3.641987997601005*^9, 
  3.64199631485452*^9, 3.641998708081543*^9, 3.641999200055489*^9, 
  3.642292492181814*^9, 3.642292546949415*^9, 3.642667637185279*^9, 
  3.6426676890036983`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Size of the expression is:\"\>", "\[InvisibleSpace]", "9.76`", 
   "\[InvisibleSpace]", "\<\" KB.\"\>"}],
  SequenceForm["Size of the expression is:", 9.76, " KB."],
  Editable->False]], "Print",
 CellChangeTimes->{3.641985716631278*^9, 3.641986610352398*^9, 
  3.64198799760397*^9, 3.641996314860435*^9, 3.641998708088933*^9, 
  3.641999200063726*^9, 3.642292492183682*^9, 3.642292546950943*^9, 
  3.642667637186762*^9, 3.642667689005167*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq1", " ", "=", " ", 
  RowBox[{"FactorList", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{"d", ",", " ", "\[Theta]1"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5580742152226553`*^9, 3.55807428163601*^9}, {
   3.558074321689114*^9, 3.5580743711156588`*^9}, 3.558075720377026*^9, {
   3.558773386697381*^9, 3.558773387591748*^9}, {3.641774549438589*^9, 
   3.641774550295906*^9}, {3.6419866526310253`*^9, 3.641986659303056*^9}, {
   3.641986723857966*^9, 3.641986724449026*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"r1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"o2y", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{"2", " ", "l2", " ", "q0", " ", "q1", " ", "t2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"2", " ", "l2", " ", "q2", " ", "q3", " ", "t2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"2", " ", "q0", " ", "q3", " ", "r2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
      RowBox[{"2", " ", "q1", " ", "q2", " ", "r2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "-", 
      RowBox[{"o2x", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{"2", " ", "l2", " ", "q0", " ", "q2", " ", "t2", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{"2", " ", "l2", " ", "q1", " ", "q3", " ", "t2", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q0", "2"], " ", "r2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q1", "2"], " ", "r2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q2", "2"], " ", "r2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}]}], ",", "1"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.641985590041954*^9, 3.641985729693899*^9, 
  3.64198661102043*^9, 3.6419866615036173`*^9, 3.641986725897863*^9, 
  3.6419879988814287`*^9, 3.64199631675218*^9, 3.6419987099876947`*^9, 
  3.641999202256199*^9, 3.64229249236236*^9, 3.642292547140049*^9, 
  3.642667637378104*^9, 3.642667689192658*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq1a", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"eq1", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "1"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.641986729253344*^9, 3.641986745077979*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"o2y", "+", 
     RowBox[{"2", " ", "l2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q0"}], " ", "q1"}], "+", 
        RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "t2"}]}], ")"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"2", " ", "q0", " ", "q3", " ", "r2", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{"2", " ", "q1", " ", "q2", " ", "r2", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "-", 
  RowBox[{"o2x", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"2", " ", "l2", " ", "q0", " ", "q2", " ", "t2", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"2", " ", "l2", " ", "q1", " ", "q3", " ", "t2", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "r2", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q1", "2"], " ", "r2", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q2", "2"], " ", "r2", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.641986749564711*^9, 3.6419880025964727`*^9, 
  3.641996321864112*^9, 3.6419987150712843`*^9, 3.641999208072665*^9, 
  3.6422924924417143`*^9, 3.642292547275989*^9, 3.642667637465967*^9, 
  3.642667689296833*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eq2", " ", "=", " ", 
   RowBox[{"FactorList", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{"d", ",", " ", "\[Theta]2"}], "]"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.558074373968647*^9, 3.558074388579677*^9}, {
  3.5580744571006203`*^9, 3.558074478763012*^9}, {3.558773392592637*^9, 
  3.5587733935033207`*^9}, {3.641774554824882*^9, 3.6417745561030817`*^9}, {
  3.641986666208748*^9, 3.64198667191978*^9}, {3.641986715406502*^9, 
  3.641986716018444*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"r2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"2", " ", "q0", " ", "q3", " ", "r1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
      RowBox[{"o2y", " ", 
       SuperscriptBox["q0", "2"], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "o2z", " ", "q0", " ", "q1", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"o2y", " ", 
       SuperscriptBox["q1", "2"], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "o2x", " ", "q1", " ", "q2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"o2y", " ", 
       SuperscriptBox["q2", "2"], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "o2x", " ", "q0", " ", "q3", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "o2z", " ", "q2", " ", "q3", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"o2y", " ", 
       SuperscriptBox["q3", "2"], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "l1", " ", "q0", " ", "q1", " ", "t1", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "l1", " ", "q2", " ", "q3", " ", "t1", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "q1", " ", "q2", " ", "r1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q0", "2"], " ", "r1", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q3", "2"], " ", "r1", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "-", 
      RowBox[{"o2x", " ", 
       SuperscriptBox["q0", "2"], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"o2x", " ", 
       SuperscriptBox["q1", "2"], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "o2z", " ", "q0", " ", "q2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "o2y", " ", "q1", " ", "q2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"o2x", " ", 
       SuperscriptBox["q2", "2"], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "o2y", " ", "q0", " ", "q3", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "o2z", " ", "q1", " ", "q3", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"o2x", " ", 
       SuperscriptBox["q3", "2"], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "l1", " ", "q0", " ", "q2", " ", "t1", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "l1", " ", "q1", " ", "q3", " ", "t1", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q1", "2"], " ", "r1", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q2", "2"], " ", "r1", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}]}], ",", "1"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.641985593892342*^9, 3.641985730546342*^9, 
  3.6419866117956877`*^9, 3.641986676460444*^9, 3.641986719996879*^9, 
  3.64198683106773*^9, 3.641988005448947*^9, 3.6419963260592747`*^9, 
  3.64199871919716*^9, 3.64199921227201*^9, 3.642292492835493*^9, 
  3.642292547714117*^9, 3.642667637801991*^9, 3.6426676896303253`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq2t", "=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"eq2", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "1"}], "]"}], "]"}], "]"}], "//", 
   "FactorList"}]}]], "Input",
 CellChangeTimes->{{3.6419867645618763`*^9, 3.641986812959392*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "q0", " ", "q3", " ", "r1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "-", 
      RowBox[{"o2y", " ", 
       SuperscriptBox["q0", "2"], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "o2z", " ", "q0", " ", "q1", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"o2y", " ", 
       SuperscriptBox["q1", "2"], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "o2x", " ", "q1", " ", "q2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"o2y", " ", 
       SuperscriptBox["q2", "2"], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "o2x", " ", "q0", " ", "q3", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "o2z", " ", "q2", " ", "q3", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"o2y", " ", 
       SuperscriptBox["q3", "2"], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "l1", " ", "q0", " ", "q1", " ", "t1", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "l1", " ", "q2", " ", "q3", " ", "t1", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "q1", " ", "q2", " ", "r1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q0", "2"], " ", "r1", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q3", "2"], " ", "r1", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
      RowBox[{"o2x", " ", 
       SuperscriptBox["q0", "2"], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"o2x", " ", 
       SuperscriptBox["q1", "2"], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "o2z", " ", "q0", " ", "q2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "o2y", " ", "q1", " ", "q2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"o2x", " ", 
       SuperscriptBox["q2", "2"], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "o2y", " ", "q0", " ", "q3", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "o2z", " ", "q1", " ", "q3", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"o2x", " ", 
       SuperscriptBox["q3", "2"], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "l1", " ", "q0", " ", "q2", " ", "t1", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "l1", " ", "q1", " ", "q3", " ", "t1", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q1", "2"], " ", "r1", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q2", "2"], " ", "r1", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}]}], ",", "1"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.641986778356052*^9, 3.641986834058462*^9}, 
   3.6419880096535482`*^9, 3.6419963326114607`*^9, 3.641998725644526*^9, 
   3.641999218385045*^9, 3.642292493022419*^9, 3.642292547846738*^9, 
   3.64266763791645*^9, 3.6426676897198257`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq2a", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"eq2t", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.641986850089078*^9, {3.642292561850909*^9, 3.642292562053211*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", "q0", " ", "q3", " ", "r1", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"o2y", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["q0", "2"]}], "+", 
        SuperscriptBox["q1", "2"], "-", 
        SuperscriptBox["q2", "2"], "+", 
        SuperscriptBox["q3", "2"]}], ")"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "o2x"}], " ", "q1", " ", "q2"}], "+", 
        RowBox[{"o2x", " ", "q0", " ", "q3"}], "-", 
        RowBox[{"o2z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q0", " ", "q1"}], "+", 
           RowBox[{"q2", " ", "q3"}]}], ")"}]}], "+", 
        RowBox[{"l1", " ", "q0", " ", "q1", " ", "t1"}], "+", 
        RowBox[{"l1", " ", "q2", " ", "q3", " ", "t1"}]}], ")"}]}]}], ")"}], 
   " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", "q1", " ", "q2", " ", "r1", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "r1", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q3", "2"], " ", "r1", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{"o2x", " ", 
   SuperscriptBox["q0", "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"o2x", " ", 
   SuperscriptBox["q1", "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", "o2z", " ", "q0", " ", "q2", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", "o2y", " ", "q1", " ", "q2", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"o2x", " ", 
   SuperscriptBox["q2", "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", "o2y", " ", "q0", " ", "q3", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", "o2z", " ", "q1", " ", "q3", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"o2x", " ", 
   SuperscriptBox["q3", "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", "l1", " ", "q0", " ", "q2", " ", "t1", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", "l1", " ", "q1", " ", "q3", " ", "t1", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q1", "2"], " ", "r1", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q2", "2"], " ", "r1", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.641986837879508*^9, 3.641986851253396*^9}, 
   3.64198800973201*^9, 3.6419963327978067`*^9, 3.641998725857512*^9, 
   3.64199921850635*^9, 3.642292493494185*^9, {3.6422925481795273`*^9, 
   3.642292563050187*^9}, 3.642667638130495*^9, 3.6426676899221573`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq3", " ", "=", " ", 
  RowBox[{
   RowBox[{"FactorList", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{"d", ",", " ", "t1"}], "]"}], "]"}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.5580744013003883`*^9, 3.558074405469269*^9}, 
   3.55870837743467*^9, 3.558708416285698*^9, {3.558773407055828*^9, 
   3.5587734080537367`*^9}, 3.558787081920381*^9, 3.558837870196101*^9, {
   3.641774129117745*^9, 3.641774129936483*^9}, {3.6417770257290573`*^9, 
   3.641777027008615*^9}, {3.6419855972833767`*^9, 3.641985597427698*^9}, {
   3.6419866828336763`*^9, 3.64198668785037*^9}, {3.641986865106879*^9, 
   3.641986866063281*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"l1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "o2z"}], "+", 
      RowBox[{"l1", " ", "t1"}], "-", 
      RowBox[{"l2", " ", 
       SuperscriptBox["q0", "2"], " ", "t2"}], "+", 
      RowBox[{"l2", " ", 
       SuperscriptBox["q1", "2"], " ", "t2"}], "+", 
      RowBox[{"l2", " ", 
       SuperscriptBox["q2", "2"], " ", "t2"}], "-", 
      RowBox[{"l2", " ", 
       SuperscriptBox["q3", "2"], " ", "t2"}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q0", " ", "q2"}], "-", 
         RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q0", " ", "q1"}], "+", 
         RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.641985598134066*^9, 3.641985732184486*^9, 
  3.641986612724353*^9, 3.641986693023334*^9, 3.641986867407702*^9, 
  3.6419880106532307`*^9, 3.641996334265493*^9, 3.641998727306209*^9, 
  3.641999219947486*^9, 3.6422924935968657`*^9, 3.6422925483495607`*^9, 
  3.642667638208192*^9, 3.642667690000298*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq3t", "=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"eq3", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "1"}], "]"}], "]"}], "]"}], "//", 
   "FactorList"}]}]], "Input",
 CellChangeTimes->{{3.641986871737224*^9, 3.641986898304194*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"o2z", "-", 
      RowBox[{"l1", " ", "t1"}], "+", 
      RowBox[{"l2", " ", 
       SuperscriptBox["q0", "2"], " ", "t2"}], "-", 
      RowBox[{"l2", " ", 
       SuperscriptBox["q1", "2"], " ", "t2"}], "-", 
      RowBox[{"l2", " ", 
       SuperscriptBox["q2", "2"], " ", "t2"}], "+", 
      RowBox[{"l2", " ", 
       SuperscriptBox["q3", "2"], " ", "t2"}], "-", 
      RowBox[{"2", " ", "q0", " ", "q2", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "q1", " ", "q3", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "q0", " ", "q1", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "q2", " ", "q3", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.641986881679762*^9, 3.641986898891296*^9}, 
   3.641988010759676*^9, 3.641996334492016*^9, 3.641998727598941*^9, 
   3.6419992201707983`*^9, 3.6422924936232452`*^9, 3.642292548383378*^9, 
   3.642667638249473*^9, 3.642667690030106*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq3a", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"eq3t", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.641986910936598*^9, 3.641986927820532*^9}, {
  3.642292576345096*^9, 3.642292576978724*^9}}],

Cell[BoxData[
 RowBox[{"o2z", "-", 
  RowBox[{"l1", " ", "t1"}], "+", 
  RowBox[{"l2", " ", 
   SuperscriptBox["q0", "2"], " ", "t2"}], "-", 
  RowBox[{"l2", " ", 
   SuperscriptBox["q1", "2"], " ", "t2"}], "-", 
  RowBox[{"l2", " ", 
   SuperscriptBox["q2", "2"], " ", "t2"}], "+", 
  RowBox[{"l2", " ", 
   SuperscriptBox["q3", "2"], " ", "t2"}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"q0", " ", "q2"}], "-", 
     RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"q0", " ", "q1"}], "+", 
     RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.641986917091667*^9, 3.64198692851829*^9}, 
   3.6419880110831738`*^9, 3.641996334880663*^9, 3.641998728024872*^9, 
   3.641999220658194*^9, 3.642292493665976*^9, {3.6422925484797688`*^9, 
   3.642292577521154*^9}, 3.642667638315899*^9, 3.64266769008565*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eq4", " ", "=", " ", 
   RowBox[{
    RowBox[{"FactorList", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"d", ",", " ", "t2"}], "]"}], "]"}], "]"}], "//", 
    "Simplify"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5580743911825647`*^9, 3.558074416807541*^9}, {
   3.558773425006267*^9, 3.5587734266129627`*^9}, 3.5587870904717903`*^9, 
   3.558837873116452*^9, {3.6417741340888557`*^9, 3.641774135270379*^9}, {
   3.641777041737417*^9, 3.641777043318923*^9}, {3.6419856007143097`*^9, 
   3.641985601592362*^9}, {3.6419866975124207`*^9, 3.641986701903989*^9}, {
   3.641986932873191*^9, 3.641986933406398*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"l2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"o2z", " ", 
       SuperscriptBox["q0", "2"]}], "-", 
      RowBox[{"2", " ", "o2y", " ", "q0", " ", "q1"}], "-", 
      RowBox[{"o2z", " ", 
       SuperscriptBox["q1", "2"]}], "+", 
      RowBox[{"2", " ", "o2x", " ", "q0", " ", "q2"}], "-", 
      RowBox[{"o2z", " ", 
       SuperscriptBox["q2", "2"]}], "+", 
      RowBox[{"2", " ", "o2x", " ", "q1", " ", "q3"}], "+", 
      RowBox[{"2", " ", "o2y", " ", "q2", " ", "q3"}], "+", 
      RowBox[{"o2z", " ", 
       SuperscriptBox["q3", "2"]}], "-", 
      RowBox[{"l1", " ", 
       SuperscriptBox["q0", "2"], " ", "t1"}], "+", 
      RowBox[{"l1", " ", 
       SuperscriptBox["q1", "2"], " ", "t1"}], "+", 
      RowBox[{"l1", " ", 
       SuperscriptBox["q2", "2"], " ", "t1"}], "-", 
      RowBox[{"l1", " ", 
       SuperscriptBox["q3", "2"], " ", "t1"}], "+", 
      RowBox[{"l2", " ", 
       SuperscriptBox["q0", "4"], " ", "t2"}], "+", 
      RowBox[{"2", " ", "l2", " ", 
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q1", "2"], " ", "t2"}], "+", 
      RowBox[{"l2", " ", 
       SuperscriptBox["q1", "4"], " ", "t2"}], "+", 
      RowBox[{"2", " ", "l2", " ", 
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q2", "2"], " ", "t2"}], "+", 
      RowBox[{"2", " ", "l2", " ", 
       SuperscriptBox["q1", "2"], " ", 
       SuperscriptBox["q2", "2"], " ", "t2"}], "+", 
      RowBox[{"l2", " ", 
       SuperscriptBox["q2", "4"], " ", "t2"}], "+", 
      RowBox[{"2", " ", "l2", " ", 
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q3", "2"], " ", "t2"}], "+", 
      RowBox[{"2", " ", "l2", " ", 
       SuperscriptBox["q1", "2"], " ", 
       SuperscriptBox["q3", "2"], " ", "t2"}], "+", 
      RowBox[{"2", " ", "l2", " ", 
       SuperscriptBox["q2", "2"], " ", 
       SuperscriptBox["q3", "2"], " ", "t2"}], "+", 
      RowBox[{"l2", " ", 
       SuperscriptBox["q3", "4"], " ", "t2"}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q0", " ", "q2"}], "+", 
         RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q0", " ", "q1"}], "-", 
         RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.641985602245061*^9, 3.641985732477724*^9, 
  3.6419866130013523`*^9, 3.6419867031275663`*^9, 3.6419869344483347`*^9, 
  3.64198801147279*^9, 3.64199633531993*^9, 3.641998728452044*^9, 
  3.641999221169304*^9, 3.642292493800969*^9, 3.642292548595739*^9, 
  3.64266763843526*^9, 3.6426676901960287`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq4t", "=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"eq4", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "1"}], "]"}], "]"}], "]"}], "//", 
   "FactorList"}]}]], "Input",
 CellChangeTimes->{{3.641986948034562*^9, 3.641986985278644*^9}, {
  3.642292583308669*^9, 3.642292584405357*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"o2z", " ", 
       SuperscriptBox["q0", "2"]}], "-", 
      RowBox[{"2", " ", "o2y", " ", "q0", " ", "q1"}], "-", 
      RowBox[{"o2z", " ", 
       SuperscriptBox["q1", "2"]}], "+", 
      RowBox[{"2", " ", "o2x", " ", "q0", " ", "q2"}], "-", 
      RowBox[{"o2z", " ", 
       SuperscriptBox["q2", "2"]}], "+", 
      RowBox[{"2", " ", "o2x", " ", "q1", " ", "q3"}], "+", 
      RowBox[{"2", " ", "o2y", " ", "q2", " ", "q3"}], "+", 
      RowBox[{"o2z", " ", 
       SuperscriptBox["q3", "2"]}], "-", 
      RowBox[{"l1", " ", 
       SuperscriptBox["q0", "2"], " ", "t1"}], "+", 
      RowBox[{"l1", " ", 
       SuperscriptBox["q1", "2"], " ", "t1"}], "+", 
      RowBox[{"l1", " ", 
       SuperscriptBox["q2", "2"], " ", "t1"}], "-", 
      RowBox[{"l1", " ", 
       SuperscriptBox["q3", "2"], " ", "t1"}], "+", 
      RowBox[{"l2", " ", 
       SuperscriptBox["q0", "4"], " ", "t2"}], "+", 
      RowBox[{"2", " ", "l2", " ", 
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q1", "2"], " ", "t2"}], "+", 
      RowBox[{"l2", " ", 
       SuperscriptBox["q1", "4"], " ", "t2"}], "+", 
      RowBox[{"2", " ", "l2", " ", 
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q2", "2"], " ", "t2"}], "+", 
      RowBox[{"2", " ", "l2", " ", 
       SuperscriptBox["q1", "2"], " ", 
       SuperscriptBox["q2", "2"], " ", "t2"}], "+", 
      RowBox[{"l2", " ", 
       SuperscriptBox["q2", "4"], " ", "t2"}], "+", 
      RowBox[{"2", " ", "l2", " ", 
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q3", "2"], " ", "t2"}], "+", 
      RowBox[{"2", " ", "l2", " ", 
       SuperscriptBox["q1", "2"], " ", 
       SuperscriptBox["q3", "2"], " ", "t2"}], "+", 
      RowBox[{"2", " ", "l2", " ", 
       SuperscriptBox["q2", "2"], " ", 
       SuperscriptBox["q3", "2"], " ", "t2"}], "+", 
      RowBox[{"l2", " ", 
       SuperscriptBox["q3", "4"], " ", "t2"}], "-", 
      RowBox[{"2", " ", "q0", " ", "q2", " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{"2", " ", "q1", " ", "q3", " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"2", " ", "q0", " ", "q1", " ", "r1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{"2", " ", "q2", " ", "q3", " ", "r1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.641986957578663*^9, 3.641986986973768*^9}, 
   3.641987029164522*^9, 3.6419880115331783`*^9, 3.64199633553491*^9, 
   3.641998728658352*^9, 3.641999221302867*^9, 3.64229249387084*^9, 
   3.6422925486599607`*^9, 3.642292584853611*^9, 3.6426676384840727`*^9, 
   3.64266769023836*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq4a", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"eq4t", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.641986996592457*^9, 3.641987009009019*^9}, {
  3.641987046318974*^9, 3.6419870579197187`*^9}, {3.642292590460404*^9, 
  3.6422925906269836`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"o2z", " ", 
   SuperscriptBox["q0", "2"]}], "-", 
  RowBox[{"2", " ", "o2y", " ", "q0", " ", "q1"}], "-", 
  RowBox[{"o2z", " ", 
   SuperscriptBox["q1", "2"]}], "+", 
  RowBox[{"2", " ", "o2x", " ", "q0", " ", "q2"}], "-", 
  RowBox[{"o2z", " ", 
   SuperscriptBox["q2", "2"]}], "+", 
  RowBox[{"2", " ", "o2x", " ", "q1", " ", "q3"}], "+", 
  RowBox[{"2", " ", "o2y", " ", "q2", " ", "q3"}], "+", 
  RowBox[{"o2z", " ", 
   SuperscriptBox["q3", "2"]}], "-", 
  RowBox[{"l1", " ", 
   SuperscriptBox["q0", "2"], " ", "t1"}], "+", 
  RowBox[{"l1", " ", 
   SuperscriptBox["q1", "2"], " ", "t1"}], "+", 
  RowBox[{"l1", " ", 
   SuperscriptBox["q2", "2"], " ", "t1"}], "-", 
  RowBox[{"l1", " ", 
   SuperscriptBox["q3", "2"], " ", "t1"}], "+", 
  RowBox[{"l2", " ", 
   SuperscriptBox["q0", "4"], " ", "t2"}], "+", 
  RowBox[{"2", " ", "l2", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", "t2"}], "+", 
  RowBox[{"l2", " ", 
   SuperscriptBox["q1", "4"], " ", "t2"}], "+", 
  RowBox[{"2", " ", "l2", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "t2"}], "+", 
  RowBox[{"2", " ", "l2", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "t2"}], "+", 
  RowBox[{"l2", " ", 
   SuperscriptBox["q2", "4"], " ", "t2"}], "+", 
  RowBox[{"2", " ", "l2", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "t2"}], "+", 
  RowBox[{"2", " ", "l2", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "t2"}], "+", 
  RowBox[{"2", " ", "l2", " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "t2"}], "+", 
  RowBox[{"l2", " ", 
   SuperscriptBox["q3", "4"], " ", "t2"}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"q0", " ", "q2"}], "+", 
     RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"q0", " ", "q1"}], "-", 
     RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r1", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.641987001700253*^9, 3.641987058516488*^9}, 
   3.6419880115699463`*^9, 3.641996335550549*^9, 3.641998728675785*^9, 
   3.641999221583259*^9, 3.642292493950289*^9, 3.6422925487082567`*^9, 
   3.64229259102761*^9, 3.6426676385154667`*^9, 3.642667690273026*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq5", " ", "=", " ", 
  RowBox[{"FactorList", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"d", "/.", "qsubs"}], ",", " ", "u"}], "]"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6417242288751783`*^9, 3.641724235041214*^9}, 
   3.641724268875647*^9, {3.64177413853196*^9, 3.641774139000786*^9}, {
   3.6419870669637423`*^9, 3.641987067535713*^9}, {3.64229260102949*^9, 
   3.642292639748308*^9}, 3.642667832412602*^9}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"q0f", " ", "q0i"}], "+", 
              RowBox[{"q1f", " ", "q1i"}], "+", 
              RowBox[{"q2f", " ", "q2i"}], "+", 
              RowBox[{"q3f", " ", "q3i"}]}], ",", 
             RowBox[{"-", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "+", 
              RowBox[{"q0f", " ", "q0i"}], "+", 
              RowBox[{"q1f", " ", "q1i"}], "+", 
              RowBox[{"q2f", " ", "q2i"}], "+", 
              RowBox[{"q3f", " ", "q3i"}]}], ",", 
             RowBox[{"-", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ArcCos", "[", 
              RowBox[{
               RowBox[{"q0f", " ", "q0i"}], "+", 
               RowBox[{"q1f", " ", "q1i"}], "+", 
               RowBox[{"q2f", " ", "q2i"}], "+", 
               RowBox[{"q3f", " ", "q3i"}]}], "]"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "q0i", " ", "q3f", " ", "r1", " ", 
               "r2", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]1", "-", "\[Theta]2", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"2", " ", "u"}]}], ")"}], " ", 
                  RowBox[{"ArcCos", "[", 
                   RowBox[{
                    RowBox[{"q0f", " ", "q0i"}], "+", 
                    RowBox[{"q1f", " ", "q1i"}], "+", 
                    RowBox[{"q2f", " ", "q2i"}], "+", 
                    RowBox[{"q3f", " ", "q3i"}]}], "]"}]}]}], "]"}]}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["q0f", "2"], " ", 
               SuperscriptBox["q0i", "3"], " ", "q3f", " ", "r1", " ", "r2", 
               " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]1", "-", "\[Theta]2", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"2", " ", "u"}]}], ")"}], " ", 
                  RowBox[{"ArcCos", "[", 
                   RowBox[{
                    RowBox[{"q0f", " ", "q0i"}], "+", 
                    RowBox[{"q1f", " ", "q1i"}], "+", 
                    RowBox[{"q2f", " ", "q2i"}], "+", 
                    RowBox[{"q3f", " ", "q3i"}]}], "]"}]}]}], "]"}]}], "+", 
              TemplateBox[{"3305"},
               "OutputSizeLimit`Skeleton",
               DisplayFunction->(FrameBox[
                 
                 RowBox[{
                  "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                 Background -> GrayLevel[0.75], 
                 BaseStyle -> {
                  "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                   ShowStringCharacters -> False}, BaselinePosition -> 
                 Baseline, ContentPadding -> False, FrameMargins -> 1, 
                 FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )]}], 
             ",", "1"}], "}"}]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{101., {3., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{92., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 90, 15091368272746186960, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{104., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{104., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 90, 15091368272746186960, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{79., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{79., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 90, 15091368272746186960, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{141., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{141., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[90]]], "Output",
 CellChangeTimes->{
  3.641998731407961*^9, 3.64199922347094*^9, 3.6422924939969*^9, 
   3.642292548733406*^9, {3.642292608242423*^9, 3.642292632259007*^9}, {
   3.642667675639085*^9, 3.642667690295909*^9}, 3.6426678856711617`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq5t", "=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"eq5", "[", 
     RowBox[{"[", 
      RowBox[{"5", ",", "1"}], "]"}], "]"}], "]"}], "//", 
   "FactorList"}]}]], "Input",
 CellChangeTimes->{
  3.641986583204204*^9, {3.641987080669343*^9, 3.641987101713922*^9}, 
   3.641987136616971*^9, {3.6426680030500603`*^9, 3.6426680032309437`*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", "4"}], " ", "q0i", " ", "q3f", " ", "r1", " ", 
               "r2", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]1", "-", "\[Theta]2", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"2", " ", "u"}]}], ")"}], " ", 
                  RowBox[{"ArcCos", "[", 
                   RowBox[{
                    RowBox[{"q0f", " ", "q0i"}], "+", 
                    RowBox[{"q1f", " ", "q1i"}], "+", 
                    RowBox[{"q2f", " ", "q2i"}], "+", 
                    RowBox[{"q3f", " ", "q3i"}]}], "]"}]}]}], "]"}]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["q0f", "2"], " ", 
               SuperscriptBox["q0i", "3"], " ", "q3f", " ", "r1", " ", "r2", 
               " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]1", "-", "\[Theta]2", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"2", " ", "u"}]}], ")"}], " ", 
                  RowBox[{"ArcCos", "[", 
                   RowBox[{
                    RowBox[{"q0f", " ", "q0i"}], "+", 
                    RowBox[{"q1f", " ", "q1i"}], "+", 
                    RowBox[{"q2f", " ", "q2i"}], "+", 
                    RowBox[{"q3f", " ", "q3i"}]}], "]"}]}]}], "]"}]}], "+", 
              TemplateBox[{"3304"},
               "OutputSizeLimit`Skeleton",
               DisplayFunction->(FrameBox[
                 
                 RowBox[{
                  "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                 Background -> GrayLevel[0.75], 
                 BaseStyle -> {
                  "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                   ShowStringCharacters -> False}, BaselinePosition -> 
                 Baseline, ContentPadding -> False, FrameMargins -> 1, 
                 FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], "+", 
              RowBox[{
               SuperscriptBox["l2", "2"], " ", 
               SuperscriptBox["q3f", "4"], " ", 
               SuperscriptBox["t2", "2"], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"4", " ", "u", " ", 
                 RowBox[{"ArcCos", "[", 
                  RowBox[{
                   RowBox[{"q0f", " ", "q0i"}], "+", 
                   RowBox[{"q1f", " ", "q1i"}], "+", 
                   RowBox[{"q2f", " ", "q2i"}], "+", 
                   RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}]}], ",", 
             "1"}], "}"}]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{101., {3., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{92., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{92., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 92, 15091368272746186960, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{104., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{104., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 92, 15091368272746186960, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{79., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{79., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 92, 15091368272746186960, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{141., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[92]]], "Output",
 CellChangeTimes->{3.64199874778174*^9, 3.641999238853154*^9, 
  3.6422924945820303`*^9, 3.6422925487795477`*^9, 3.6426676904008303`*^9, 
  3.642667937525083*^9, 3.6426681878945093`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq5a", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"eq5t", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.641987138676517*^9, 3.641987171448965*^9}, 
   3.64266819585185*^9}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"q0i", " ", "q3f"}], "+", 
             RowBox[{"q0f", " ", "q3i"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{
              SuperscriptBox["q0f", "2"], " ", 
              SuperscriptBox["q0i", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["q1f", "2"], " ", 
              SuperscriptBox["q1i", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["q2f", "2"], " ", 
              SuperscriptBox["q2i", "2"]}], "+", 
             RowBox[{"2", " ", "q2f", " ", "q2i", " ", "q3f", " ", "q3i"}], 
             "+", 
             RowBox[{
              SuperscriptBox["q3f", "2"], " ", 
              SuperscriptBox["q3i", "2"]}], "+", 
             RowBox[{"2", " ", "q1f", " ", "q1i", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"q2f", " ", "q2i"}], "+", 
                RowBox[{"q3f", " ", "q3i"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", "q0f", " ", "q0i", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"q1f", " ", "q1i"}], "+", 
                RowBox[{"q2f", " ", "q2i"}], "+", 
                RowBox[{"q3f", " ", "q3i"}]}], ")"}]}]}], ")"}], " ", "r1", 
           " ", "r2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]1", "-", "\[Theta]2", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", " ", "u"}]}], ")"}], " ", 
              RowBox[{"ArcCos", "[", 
               RowBox[{
                RowBox[{"q0f", " ", "q0i"}], "+", 
                RowBox[{"q1f", " ", "q1i"}], "+", 
                RowBox[{"q2f", " ", "q2i"}], "+", 
                RowBox[{"q3f", " ", "q3i"}]}], "]"}]}]}], "]"}]}], "+", 
          TemplateBox[{"3260"},
           "OutputSizeLimit`Skeleton",
           DisplayFunction->(FrameBox[
             RowBox[{"\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
             Background -> GrayLevel[0.75], 
             BaseStyle -> {
              "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
               ShowStringCharacters -> False}, BaselinePosition -> Baseline, 
             ContentPadding -> False, FrameMargins -> 1, FrameStyle -> 
             GrayLevel[0.75], RoundingRadius -> 7]& )], "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", 
           SuperscriptBox["q3f", "4"], " ", 
           SuperscriptBox["t2", "2"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"4", " ", "u", " ", 
             RowBox[{"ArcCos", "[", 
              RowBox[{
               RowBox[{"q0f", " ", "q0i"}], "+", 
               RowBox[{"q1f", " ", "q1i"}], "+", 
               RowBox[{"q2f", " ", "q2i"}], "+", 
               RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}]}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{101., {3., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{92., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 93, 15091368272746186960, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{104., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 93, 15091368272746186960, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{79., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 93, 15091368272746186960, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{141., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[93]]], "Output",
 CellChangeTimes->{3.641998751692171*^9, 3.641999245051845*^9, 
  3.642292494655013*^9, 3.6422925488272953`*^9, 3.642667690475559*^9, 
  3.642668366630464*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq5b", "=", 
  RowBox[{"Expand", "[", 
   RowBox[{"eq5a", ",", 
    RowBox[{"Trig", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.641829338186646*^9, 3.64182934740379*^9}, {
  3.641829391763011*^9, 3.641829394396278*^9}, {3.641987342086841*^9, 
  3.641987355604494*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", "4"}], " ", 
           SuperscriptBox["q0f", "3"], " ", "q0i", " ", 
           SuperscriptBox["r2", "2"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"2", " ", "u"}]}], ")"}], " ", 
             RowBox[{"ArcCos", "[", 
              RowBox[{
               RowBox[{"q0f", " ", "q0i"}], "+", 
               RowBox[{"q1f", " ", "q1i"}], "+", 
               RowBox[{"q2f", " ", "q2i"}], "+", 
               RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}], "-", 
          RowBox[{"4", " ", "q0f", " ", 
           SuperscriptBox["q0i", "3"], " ", 
           SuperscriptBox["r2", "2"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"2", " ", "u"}]}], ")"}], " ", 
             RowBox[{"ArcCos", "[", 
              RowBox[{
               RowBox[{"q0f", " ", "q0i"}], "+", 
               RowBox[{"q1f", " ", "q1i"}], "+", 
               RowBox[{"q2f", " ", "q2i"}], "+", 
               RowBox[{"q3f", " ", "q3i"}]}], "]"}]}], "]"}]}], "+", 
          TemplateBox[{"3796"},
           "OutputSizeLimit`Skeleton",
           DisplayFunction->(FrameBox[
             RowBox[{"\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
             Background -> GrayLevel[0.75], 
             BaseStyle -> {
              "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
               ShowStringCharacters -> False}, BaselinePosition -> Baseline, 
             ContentPadding -> False, FrameMargins -> 1, FrameStyle -> 
             GrayLevel[0.75], RoundingRadius -> 7]& )]}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{101., {3., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{92., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 94, 15091368272746186960, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{104., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 94, 15091368272746186960, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{79., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 94, 15091368272746186960, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{141., {0., 12.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[94]]], "Output",
 CellChangeTimes->{3.6418295747078114`*^9, 3.6419857339717627`*^9, 
  3.6419866145571547`*^9, 3.641987297172287*^9, 3.6419873576768*^9, 
  3.641988028055264*^9, 3.64199636066219*^9, 3.6419992463822527`*^9, 
  3.6422924946797037`*^9, 3.642292548850808*^9, 3.6426676904985857`*^9, 
  3.642668377377593*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"size", "[", "eq5b", "]"}]], "Input",
 CellChangeTimes->{{3.642668383471455*^9, 3.64266838751584*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Size of the expression is:\"\>", "\[InvisibleSpace]", 
   "3060.168`", "\[InvisibleSpace]", "\<\" KB.\"\>"}],
  SequenceForm["Size of the expression is:", 3060.168, " KB."],
  Editable->False]], "Print",
 CellChangeTimes->{3.6426683882863894`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Exponent", "[", 
  RowBox[{"eq5b", ",", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Theta]1", "]"}], "*", 
    RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6419874992967567`*^9, 3.641987509866384*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.6419875106503067`*^9, 3.641988028122179*^9, 
  3.6419963607444067`*^9, 3.6419992468907337`*^9, 3.642292494696225*^9, 
  3.642292548870036*^9, 3.642667690519795*^9, 3.642668392147751*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Exponent", "[", 
  RowBox[{"eq5b", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]1", "]"}], ",", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.641829358665092*^9, 3.641829383679007*^9}, {
  3.641987383156316*^9, 3.641987394504971*^9}, {3.641987432185133*^9, 
  3.641987476688139*^9}, {3.642668399711088*^9, 3.6426684175781116`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.6426684180653048`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"f1", " ", "=", " ", 
    RowBox[{"TrigExpand", "[", 
     RowBox[{"eq1", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "r1"}], " ", ")"}]}], "]"}]}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"-", "r1"}], " ", "can", " ", "be", " ", "factored", " ", "out", 
     " ", "as", " ", "seen", " ", "in", " ", "eq1"}], " ", "*)"}], ";", "\n", 
   
   RowBox[{"f2", " ", "=", " ", 
    RowBox[{"TrigExpand", "[", 
     RowBox[{"eq2", "/", 
      RowBox[{"(", 
       RowBox[{"2", "r2"}], "   ", ")"}]}], "]"}]}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"-", "r2"}], " ", "can", " ", "be", " ", "factored", " ", "out", 
     " ", "as", " ", "seen", " ", "in", " ", "eq2"}], " ", "*)"}], ";", "\n", 
   
   RowBox[{"f3", " ", "=", " ", 
    RowBox[{"TrigExpand", "[", 
     RowBox[{"eq3", "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "l1"}], "  ", ")"}]}], "]"}]}], 
   RowBox[{"(*", 
    RowBox[{
    "2", " ", "l1", " ", "can", " ", "be", " ", "factored", " ", "out", " ", 
     "as", " ", "seen", " ", "in", " ", "eq3"}], " ", "*)"}], ";", "\n", 
   RowBox[{"f4", " ", "=", " ", 
    RowBox[{"TrigExpand", "[", 
     RowBox[{"eq4", "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "l2"}], " ", ")"}]}], "]"}]}], 
   RowBox[{"(*", 
    RowBox[{
    "2", " ", "l2", " ", "can", " ", "be", " ", "factored", " ", "out", " ", 
     "as", " ", "seen", " ", "in", " ", "eq4"}], " ", "*)"}], ";", 
   RowBox[{"f5", "=", " ", 
    RowBox[{"TrigExpand", "[", 
     RowBox[{"eq5", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "tz"}], " ", ")"}]}], "]"}]}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"-", "2"}], " ", "tz", " ", "can", " ", "be", " ", "factored", 
     " ", "out", " ", "as", " ", "seen", " ", "in", " ", "eq4"}], " ", "*)"}],
    ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.5580744196122627`*^9, 3.558074448476202*^9}, 
   3.5580745428124313`*^9, {3.558096923248156*^9, 3.558096923918198*^9}, 
   3.55817551056384*^9, {3.558708448092165*^9, 3.5587084484363127`*^9}, {
   3.558773490487608*^9, 3.558773491978403*^9}, 3.55877510185742*^9, 
   3.5587816491789417`*^9, 3.5587870955272017`*^9, {3.5698306893804836`*^9, 
   3.569830710763706*^9}, 3.5720612842268877`*^9, {3.574159230916068*^9, 
   3.574159240852637*^9}, {3.641724571783086*^9, 3.641724595700536*^9}, 
   3.641987987378502*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solt", "=", 
  RowBox[{"Simplify", "[", " ", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eq3a", ",", "eq4a"}], "}"}], " ", "\[Equal]", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"t1", ",", "t2"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "two", " ", "equations", " ", "linear", " ", "in", " ", "t1", " ", "and", 
    " ", "t2", " ", "are", " ", "solved", " ", "simultaneously"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.5580749122473717`*^9, 3.5580749735675898`*^9}, {
   3.558075121534004*^9, 3.558075123626783*^9}, {3.558175545397298*^9, 
   3.558175548263546*^9}, {3.5587085057971373`*^9, 3.558708509507172*^9}, {
   3.558771841030569*^9, 3.558771993647889*^9}, {3.558772187384592*^9, 
   3.558772197069064*^9}, {3.558772568755226*^9, 3.5587725886783743`*^9}, {
   3.5587728958109283`*^9, 3.558772923848027*^9}, {3.558773009241201*^9, 
   3.558773031634039*^9}, {3.558775142055781*^9, 3.558775144231162*^9}, {
   3.558787888701654*^9, 3.558787896789309*^9}, {3.558825164346663*^9, 
   3.558825166617366*^9}, {3.558837886933154*^9, 3.558837888110662*^9}, 
   3.55883794883505*^9, {3.569830758854457*^9, 3.569830786861059*^9}, {
   3.641987545601713*^9, 3.641987584991713*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"t1", "\[Rule]", 
    RowBox[{"-", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"4", " ", "l1", " ", "l2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["q1", "2"], "+", 
          SuperscriptBox["q2", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["q0", "2"], "+", 
          SuperscriptBox["q3", "2"]}], ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"l2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["q0", "2"], "-", 
           SuperscriptBox["q1", "2"], "-", 
           SuperscriptBox["q2", "2"], "+", 
           SuperscriptBox["q3", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"o2z", " ", 
            SuperscriptBox["q0", "2"]}], "-", 
           RowBox[{"2", " ", "o2y", " ", "q0", " ", "q1"}], "-", 
           RowBox[{"o2z", " ", 
            SuperscriptBox["q1", "2"]}], "+", 
           RowBox[{"2", " ", "o2x", " ", "q0", " ", "q2"}], "-", 
           RowBox[{"o2z", " ", 
            SuperscriptBox["q2", "2"]}], "+", 
           RowBox[{"2", " ", "o2x", " ", "q1", " ", "q3"}], "+", 
           RowBox[{"2", " ", "o2y", " ", "q2", " ", "q3"}], "+", 
           RowBox[{"o2z", " ", 
            SuperscriptBox["q3", "2"]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"q0", " ", "q2"}], "+", 
              RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r1", " ", 
            RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"q0", " ", "q1"}], "-", 
              RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r1", " ", 
            RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], ")"}]}], "-", 
        RowBox[{"l2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["q0", "2"], "+", 
            SuperscriptBox["q1", "2"], "+", 
            SuperscriptBox["q2", "2"], "+", 
            SuperscriptBox["q3", "2"]}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{"o2z", "-", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"q0", " ", "q2"}], "-", 
              RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r2", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"q0", " ", "q1"}], "+", 
              RowBox[{"q2", " ", "q3"}]}], ")"}], " ", "r2", " ", 
            RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], 
       ")"}]}]}]}], ",", 
   RowBox[{"t2", "\[Rule]", 
    RowBox[{"-", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", "l2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["q1", "2"], "+", 
          SuperscriptBox["q2", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["q0", "2"], "+", 
          SuperscriptBox["q3", "2"]}], ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "o2y"}], " ", "q0", " ", "q1"}], "+", 
        RowBox[{"o2x", " ", "q0", " ", "q2"}], "+", 
        RowBox[{"o2x", " ", "q1", " ", "q3"}], "+", 
        RowBox[{"o2y", " ", "q2", " ", "q3"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q0", " ", "q2"}], "+", 
           RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "r1", " ", 
         RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["q0", "3"], " ", "q2"}], "-", 
           RowBox[{
            SuperscriptBox["q0", "2"], " ", "q1", " ", "q3"}], "-", 
           RowBox[{"q0", " ", "q2", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["q1", "2"], "+", 
              SuperscriptBox["q2", "2"], "-", 
              SuperscriptBox["q3", "2"]}], ")"}]}], "+", 
           RowBox[{"q1", " ", "q3", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["q1", "2"], "+", 
              SuperscriptBox["q2", "2"], "-", 
              SuperscriptBox["q3", "2"]}], ")"}]}]}], ")"}], " ", "r2", " ", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
        RowBox[{"q0", " ", "q1", " ", "r1", " ", 
         RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
        RowBox[{"q2", " ", "q3", " ", "r1", " ", 
         RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
        RowBox[{
         SuperscriptBox["q0", "3"], " ", "q1", " ", "r2", " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
        RowBox[{"q0", " ", 
         SuperscriptBox["q1", "3"], " ", "r2", " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
        RowBox[{"q0", " ", "q1", " ", 
         SuperscriptBox["q2", "2"], " ", "r2", " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
        RowBox[{
         SuperscriptBox["q0", "2"], " ", "q2", " ", "q3", " ", "r2", " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["q1", "2"], " ", "q2", " ", "q3", " ", "r2", " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["q2", "3"], " ", "q3", " ", "r2", " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
        RowBox[{"q0", " ", "q1", " ", 
         SuperscriptBox["q3", "2"], " ", "r2", " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
        RowBox[{"q2", " ", 
         SuperscriptBox["q3", "3"], " ", "r2", " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.64198575796592*^9, 3.641986641353924*^9, {3.641987579932148*^9, 
   3.641987588419435*^9}, 3.641988030657402*^9, 3.641996366542481*^9, 
   3.641999251450436*^9, 3.6422924950106487`*^9, 3.642292548980015*^9, 
   3.642667691276474*^9, 3.6426684301827717`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"g1", " ", "=", " ", 
   RowBox[{"FactorList", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{"Numerator", "[", 
        RowBox[{"Together", "[", 
         RowBox[{"eq1a", "/.", "solt"}], "]"}], "]"}], ",", " ", "algvars", 
       ",", " ", "Simplify"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "substituting", " ", "t1", " ", "and", " ", "t2", " ", "back", " ", "in", 
    " ", "f1"}], "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.558075015702835*^9, 3.558075111043756*^9}, {
   3.5580751626656723`*^9, 3.5580753035533323`*^9}, 3.558837956778389*^9, {
   3.569830231898317*^9, 3.5698302332233925`*^9}, {3.569830810104388*^9, 
   3.5698308201239614`*^9}, {3.641724811749831*^9, 3.641724812833148*^9}, {
   3.641987647326981*^9, 3.641987699112607*^9}, {3.641987977071383*^9, 
   3.641987977910722*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "o2x", " ", 
       SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{"2", " ", "o2y", " ", 
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q2", "2"], " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{"2", " ", "o2x", " ", "q0", " ", 
       SuperscriptBox["q1", "2"], " ", "q3", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{
      "4", " ", "o2y", " ", "q0", " ", "q1", " ", "q2", " ", "q3", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"2", " ", "o2x", " ", "q0", " ", 
       SuperscriptBox["q2", "2"], " ", "q3", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{"2", " ", "o2y", " ", 
       SuperscriptBox["q1", "2"], " ", 
       SuperscriptBox["q3", "2"], " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"2", " ", "o2x", " ", "q1", " ", "q2", " ", 
       SuperscriptBox["q3", "2"], " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", "r1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Theta]1"}], "]"}]}], "+", 
      RowBox[{"2", " ", "q0", " ", 
       SuperscriptBox["q1", "2"], " ", "q3", " ", "r1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Theta]1"}], "]"}]}], "-", 
      RowBox[{"2", " ", "q0", " ", 
       SuperscriptBox["q2", "2"], " ", "q3", " ", "r1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Theta]1"}], "]"}]}], "-", 
      RowBox[{"2", " ", "q1", " ", "q2", " ", 
       SuperscriptBox["q3", "2"], " ", "r1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Theta]1"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "4"], " ", "q1", " ", "q2", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q1", "3"], " ", "q2", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "2"], " ", "q1", " ", 
       SuperscriptBox["q2", "3"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "3"], " ", 
       SuperscriptBox["q1", "2"], " ", "q3", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "q0", " ", 
       SuperscriptBox["q1", "4"], " ", "q3", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "3"], " ", 
       SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"4", " ", "q0", " ", 
       SuperscriptBox["q1", "2"], " ", 
       SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "q0", " ", 
       SuperscriptBox["q2", "4"], " ", "q3", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["q1", "3"], " ", "q2", " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "q1", " ", 
       SuperscriptBox["q2", "3"], " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "q0", " ", 
       SuperscriptBox["q1", "2"], " ", 
       SuperscriptBox["q3", "3"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "q0", " ", 
       SuperscriptBox["q2", "2"], " ", 
       SuperscriptBox["q3", "3"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "q1", " ", "q2", " ", 
       SuperscriptBox["q3", "4"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "o2x", " ", 
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q1", "2"], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"2", " ", "o2y", " ", 
       SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"2", " ", "o2y", " ", "q0", " ", 
       SuperscriptBox["q1", "2"], " ", "q3", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{
      "4", " ", "o2x", " ", "q0", " ", "q1", " ", "q2", " ", "q3", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{"2", " ", "o2y", " ", "q0", " ", 
       SuperscriptBox["q2", "2"], " ", "q3", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{"2", " ", "o2y", " ", "q1", " ", "q2", " ", 
       SuperscriptBox["q3", "2"], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"2", " ", "o2x", " ", 
       SuperscriptBox["q2", "2"], " ", 
       SuperscriptBox["q3", "2"], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "4"], " ", 
       SuperscriptBox["q1", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q1", "4"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q1", "2"], " ", 
       SuperscriptBox["q2", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q1", "2"], " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q2", "2"], " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["q1", "2"], " ", 
       SuperscriptBox["q2", "2"], " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["q2", "4"], " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["q2", "2"], " ", 
       SuperscriptBox["q3", "4"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q1", "2"], " ", "r1", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Theta]1"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q2", "2"], " ", "r1", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Theta]1"}], "]"}]}], "+", 
      RowBox[{"4", " ", "q0", " ", "q1", " ", "q2", " ", "q3", " ", "r1", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Theta]1"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q1", "2"], " ", 
       SuperscriptBox["q3", "2"], " ", "r1", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Theta]1"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q2", "2"], " ", 
       SuperscriptBox["q3", "2"], " ", "r1", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Theta]1"}], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "4"], " ", 
       SuperscriptBox["q2", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q1", "2"], " ", 
       SuperscriptBox["q2", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q2", "4"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q1", "2"], " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["q1", "4"], " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q2", "2"], " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["q1", "2"], " ", 
       SuperscriptBox["q2", "2"], " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["q1", "2"], " ", 
       SuperscriptBox["q3", "4"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "4"], " ", "q1", " ", "q2", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "2"], " ", 
       SuperscriptBox["q1", "3"], " ", "q2", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "2"], " ", "q1", " ", 
       SuperscriptBox["q2", "3"], " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "3"], " ", 
       SuperscriptBox["q1", "2"], " ", "q3", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "q0", " ", 
       SuperscriptBox["q1", "4"], " ", "q3", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["q0", "3"], " ", 
       SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"4", " ", "q0", " ", 
       SuperscriptBox["q1", "2"], " ", 
       SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "q0", " ", 
       SuperscriptBox["q2", "4"], " ", "q3", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["q1", "3"], " ", "q2", " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "q1", " ", 
       SuperscriptBox["q2", "3"], " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "q0", " ", 
       SuperscriptBox["q1", "2"], " ", 
       SuperscriptBox["q3", "3"], " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "q0", " ", 
       SuperscriptBox["q2", "2"], " ", 
       SuperscriptBox["q3", "3"], " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "q1", " ", "q2", " ", 
       SuperscriptBox["q3", "4"], " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.641987657418302*^9, 3.6419876856202*^9}, 
   3.641987716155958*^9, 3.641988031990292*^9, 3.6419963799123497`*^9, 
   3.6419992538765373`*^9, 3.642292495176952*^9, 3.642292549034727*^9, 
   3.6426676915760202`*^9, 3.642668433272849*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g1a", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"g1", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "1"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.641987735937056*^9, 3.641987757333856*^9}, {
  3.641988053863316*^9, 3.641988066798936*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q0", " ", "q2"}], "+", 
       RowBox[{"q1", " ", "q3"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "q0"}], " ", "q1"}], "+", 
       RowBox[{"q2", " ", "q3"}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"o2x", " ", "q0", " ", "q1"}], "+", 
    RowBox[{"o2y", " ", "q0", " ", "q2"}], "+", 
    RowBox[{"o2y", " ", "q1", " ", "q3"}], "-", 
    RowBox[{"o2x", " ", "q2", " ", "q3"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "q0"}], " ", "q1", " ", "r1"}], "+", 
       RowBox[{"q2", " ", "q3", " ", "r1"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["q0", "3"], " ", "q1"}], "+", 
       RowBox[{
        SuperscriptBox["q0", "2"], " ", "q2", " ", "q3"}], "+", 
       RowBox[{"q0", " ", "q1", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["q1", "2"], "+", 
          SuperscriptBox["q2", "2"], "+", 
          SuperscriptBox["q3", "2"]}], ")"}]}], "+", 
       RowBox[{"q2", " ", "q3", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["q1", "2"], "+", 
          SuperscriptBox["q2", "2"], "+", 
          SuperscriptBox["q3", "2"]}], ")"}]}]}], ")"}], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"q0", " ", "q2", " ", "r1", " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
    RowBox[{"q1", " ", "q3", " ", "r1", " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q0", "3"], " ", "q2", " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"q0", " ", 
     SuperscriptBox["q1", "2"], " ", "q2", " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"q0", " ", 
     SuperscriptBox["q2", "3"], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", "q1", " ", "q3", " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q1", "3"], " ", "q3", " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"q1", " ", 
     SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"q0", " ", "q2", " ", 
     SuperscriptBox["q3", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"q1", " ", 
     SuperscriptBox["q3", "3"], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.64198775215166*^9, 3.641987758253574*^9}, {
   3.6419880325742283`*^9, 3.641988067787022*^9}, 3.6419963805328493`*^9, 
   3.641999254672008*^9, 3.64229249520877*^9, 3.64229254908298*^9, 
   3.642667691806879*^9, 3.6426684368874273`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"g2", " ", "=", " ", 
  RowBox[{"FactorList", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Numerator", "[", 
     RowBox[{"Together", "[", 
      RowBox[{"eq2a", "/.", "solt"}], "]"}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "substituting", " ", "t1", " ", "and", " ", "t2", " ", "back", " ", "in", 
    " ", "f2"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5580753112720947`*^9, 3.5580753162667503`*^9}, 
   3.5588379610483847`*^9, {3.569830274993782*^9, 3.5698302760918446`*^9}, {
   3.569830824223196*^9, 3.5698308268483458`*^9}, {3.5721010932448606`*^9, 
   3.572101105427557*^9}, {3.641724818912415*^9, 3.6417248209385967`*^9}, {
   3.641987822052169*^9, 3.641987839899743*^9}, {3.641987891074768*^9, 
   3.641987891725922*^9}, {3.641987936076963*^9, 3.641987941679102*^9}, {
   3.641988071325534*^9, 3.6419880721753187`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["q0", "2"], "+", 
      SuperscriptBox["q1", "2"], "+", 
      SuperscriptBox["q2", "2"], "+", 
      SuperscriptBox["q3", "2"]}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "q0"}], " ", "q2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q1", " ", "q3", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q0", " ", "q1", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q2", " ", "q3", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"o2x", " ", "q0", " ", "q1"}], "+", 
      RowBox[{"o2y", " ", "q0", " ", "q2"}], "+", 
      RowBox[{"o2y", " ", "q1", " ", "q3"}], "-", 
      RowBox[{"o2x", " ", "q2", " ", "q3"}], "-", 
      RowBox[{"q0", " ", "q1", " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"q2", " ", "q3", " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q0", "3"], " ", "q1", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q0", " ", 
       SuperscriptBox["q1", "3"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q0", " ", "q1", " ", 
       SuperscriptBox["q2", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q0", "2"], " ", "q2", " ", "q3", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q1", "2"], " ", "q2", " ", "q3", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q2", "3"], " ", "q3", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q0", " ", "q1", " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q2", " ", 
       SuperscriptBox["q3", "3"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"q0", " ", "q2", " ", "r1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{"q1", " ", "q3", " ", "r1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q0", "3"], " ", "q2", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q0", " ", 
       SuperscriptBox["q1", "2"], " ", "q2", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q0", " ", 
       SuperscriptBox["q2", "3"], " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q0", "2"], " ", "q1", " ", "q3", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q1", "3"], " ", "q3", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"q1", " ", 
       SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"q0", " ", "q2", " ", 
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"q1", " ", 
       SuperscriptBox["q3", "3"], " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6419878878814*^9, 3.6419879325909033`*^9, 
  3.6419879682138023`*^9, 3.641988032615553*^9, 3.641988077370788*^9, 
  3.641996389158897*^9, 3.6419992604238358`*^9, 3.642292495283348*^9, 
  3.642292549166788*^9, 3.642667692007152*^9, 3.6426684384732437`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g2a", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"g2", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "1"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.641988094382884*^9, 3.641988131566038*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"o2x", " ", "q0", " ", "q1"}], "+", 
  RowBox[{"o2y", " ", "q0", " ", "q2"}], "+", 
  RowBox[{"o2y", " ", "q1", " ", "q3"}], "-", 
  RowBox[{"o2x", " ", "q2", " ", "q3"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "q0"}], " ", "q1", " ", "r1"}], "+", 
     RowBox[{"q2", " ", "q3", " ", "r1"}]}], ")"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["q0", "3"], " ", "q1"}], "+", 
     RowBox[{
      SuperscriptBox["q0", "2"], " ", "q2", " ", "q3"}], "+", 
     RowBox[{"q0", " ", "q1", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["q1", "2"], "+", 
        SuperscriptBox["q2", "2"], "+", 
        SuperscriptBox["q3", "2"]}], ")"}]}], "+", 
     RowBox[{"q2", " ", "q3", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["q1", "2"], "+", 
        SuperscriptBox["q2", "2"], "+", 
        SuperscriptBox["q3", "2"]}], ")"}]}]}], ")"}], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"q0", " ", "q2", " ", "r1", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"q1", " ", "q3", " ", "r1", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "3"], " ", "q2", " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q1", "2"], " ", "q2", " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q2", "3"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "q1", " ", "q3", " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q1", "3"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"q1", " ", 
   SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q0", " ", "q2", " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"q1", " ", 
   SuperscriptBox["q3", "3"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.641988108030942*^9, 3.641988133123103*^9}, 
   3.641996389347471*^9, 3.6419992608644657`*^9, 3.642292495318071*^9, 
   3.642292549201015*^9, 3.642667692015851*^9, 3.642668439563128*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g3", "=", 
  RowBox[{"FactorList", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Numerator", "[", 
     RowBox[{"Together", "[", 
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{"eq5a", ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "t2"}], "}"}]}], "]"}], "/.", "solt"}], "]"}], 
     "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.641996034304914*^9, 3.6419960463565807`*^9}, {
  3.641996439475047*^9, 3.641996452609312*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Simplify", "::", "time"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Time spent on a transformation exceeded \
\[NoBreak]\\!\\(300.`\\)\[NoBreak] seconds, and the transformation was \
aborted. Increasing the value of TimeConstraint option may improve the result \
of simplification. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\
\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Simplify/time\\\", ButtonNote -> \
\\\"Simplify::time\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.642668930662004*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"g3a", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"g3", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "1"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6420015659345207`*^9, 3.6420015992320642`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g1b", "=", 
  RowBox[{"Expand", "[", 
   RowBox[{"g1a", ",", 
    RowBox[{"Trig", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.642001627622017*^9, 3.642001657392989*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", "o2x", " ", 
   SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"2", " ", "o2y", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"2", " ", "o2x", " ", "q0", " ", 
   SuperscriptBox["q1", "2"], " ", "q3", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"4", " ", "o2y", " ", "q0", " ", "q1", " ", "q2", " ", "q3", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"2", " ", "o2x", " ", "q0", " ", 
   SuperscriptBox["q2", "2"], " ", "q3", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"2", " ", "o2y", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"2", " ", "o2x", " ", "q1", " ", "q2", " ", 
   SuperscriptBox["q3", "2"], " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", "r1", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]1", "]"}], "2"]}], "+", 
  RowBox[{"2", " ", "q0", " ", 
   SuperscriptBox["q1", "2"], " ", "q3", " ", "r1", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]1", "]"}], "2"]}], "-", 
  RowBox[{"2", " ", "q0", " ", 
   SuperscriptBox["q2", "2"], " ", "q3", " ", "r1", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]1", "]"}], "2"]}], "-", 
  RowBox[{"2", " ", "q1", " ", "q2", " ", 
   SuperscriptBox["q3", "2"], " ", "r1", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]1", "]"}], "2"]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "4"], " ", "q1", " ", "q2", " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "3"], " ", "q2", " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "2"], " ", "q1", " ", 
   SuperscriptBox["q2", "3"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "3"], " ", 
   SuperscriptBox["q1", "2"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", "q0", " ", 
   SuperscriptBox["q1", "4"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "3"], " ", 
   SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"4", " ", "q0", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", "q0", " ", 
   SuperscriptBox["q2", "4"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"4", " ", 
   SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q1", "3"], " ", "q2", " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", "q1", " ", 
   SuperscriptBox["q2", "3"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", "q0", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q3", "3"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", "q0", " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "3"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", "q1", " ", "q2", " ", 
   SuperscriptBox["q3", "4"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", "o2x", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"2", " ", "o2y", " ", 
   SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"2", " ", "o2y", " ", "q0", " ", 
   SuperscriptBox["q1", "2"], " ", "q3", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"4", " ", "o2x", " ", "q0", " ", "q1", " ", "q2", " ", "q3", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"2", " ", "o2y", " ", "q0", " ", 
   SuperscriptBox["q2", "2"], " ", "q3", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"2", " ", "o2y", " ", "q1", " ", "q2", " ", 
   SuperscriptBox["q3", "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"2", " ", "o2x", " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"8", " ", "q0", " ", "q1", " ", "q2", " ", "q3", " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "4"], " ", 
   SuperscriptBox["q1", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "4"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q2", "4"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "4"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", "r1", " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]1", "]"}], "2"]}], "-", 
  RowBox[{"2", " ", "q0", " ", 
   SuperscriptBox["q1", "2"], " ", "q3", " ", "r1", " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]1", "]"}], "2"]}], "+", 
  RowBox[{"2", " ", "q0", " ", 
   SuperscriptBox["q2", "2"], " ", "q3", " ", "r1", " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]1", "]"}], "2"]}], "+", 
  RowBox[{"2", " ", "q1", " ", "q2", " ", 
   SuperscriptBox["q3", "2"], " ", "r1", " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]1", "]"}], "2"]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "4"], " ", 
   SuperscriptBox["q2", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q2", "4"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q1", "4"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q3", "4"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "4"], " ", "q1", " ", "q2", " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "3"], " ", "q2", " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "2"], " ", "q1", " ", 
   SuperscriptBox["q2", "3"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "3"], " ", 
   SuperscriptBox["q1", "2"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", "q0", " ", 
   SuperscriptBox["q1", "4"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["q0", "3"], " ", 
   SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"4", " ", "q0", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", "q0", " ", 
   SuperscriptBox["q2", "4"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["q1", "3"], " ", "q2", " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", "q1", " ", 
   SuperscriptBox["q2", "3"], " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", "q0", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q3", "3"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", "q0", " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "3"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", "q1", " ", "q2", " ", 
   SuperscriptBox["q3", "4"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]], "Output",
 CellChangeTimes->{3.64229249541604*^9, 3.642292549342997*^9, 
  3.642667692085951*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Exponent", "[", 
  RowBox[{"g1b", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]1", "]"}], ",", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}], ",", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}], ",", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]1", "]"}], "*", 
      RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.642001668499868*^9, 3.642001703608342*^9}, {
  3.642001804183741*^9, 3.642001809721917*^9}, {3.6420020115986853`*^9, 
  3.642002012321925*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "1", ",", "1", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.642001704243681*^9, 3.6420020136290693`*^9, 
  3.642292495420992*^9, 3.642292549368256*^9, 3.642667692106031*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g2b", "=", 
  RowBox[{"Expand", "[", 
   RowBox[{"g2a", ",", 
    RowBox[{"Trig", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.642001712049155*^9, 3.64200171509627*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"o2x", " ", "q0", " ", "q1"}], "+", 
  RowBox[{"o2y", " ", "q0", " ", "q2"}], "+", 
  RowBox[{"o2y", " ", "q1", " ", "q3"}], "-", 
  RowBox[{"o2x", " ", "q2", " ", "q3"}], "-", 
  RowBox[{"q0", " ", "q1", " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{"q2", " ", "q3", " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "3"], " ", "q1", " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q1", "3"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q0", " ", "q1", " ", 
   SuperscriptBox["q2", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "q2", " ", "q3", " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q1", "2"], " ", "q2", " ", "q3", " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q2", "3"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q0", " ", "q1", " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q2", " ", 
   SuperscriptBox["q3", "3"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"q0", " ", "q2", " ", "r1", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"q1", " ", "q3", " ", "r1", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "3"], " ", "q2", " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q1", "2"], " ", "q2", " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q0", " ", 
   SuperscriptBox["q2", "3"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "q1", " ", "q3", " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q1", "3"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"q1", " ", 
   SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"q0", " ", "q2", " ", 
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"q1", " ", 
   SuperscriptBox["q3", "3"], " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]], "Output",
 CellChangeTimes->{3.6422924954478607`*^9, 3.6422925494004374`*^9, 
  3.642667692128481*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Exponent", "[", 
  RowBox[{"g2b", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]1", "]"}], ",", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}], ",", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}], ",", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.642001725382942*^9, 3.642001725541212*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.642001726132189*^9, 3.642292495453014*^9, 
  3.642292549432097*^9, 3.642667692133398*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g3b", "=", 
  RowBox[{"Expand", "[", 
   RowBox[{"g3a", ",", 
    RowBox[{"Trig", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.642001732384997*^9, 3.642001735824939*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], "}"}], "\[LeftDoubleBracket]", 
            RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}], ",", "1"}], 
          "}"}]}], "}"}], "\[LeftDoubleBracket]", 
       RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], ",", "1"}], 
     "}"}]}], "}"}], "\[LeftDoubleBracket]", 
  RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}]], "Output",
 CellChangeTimes->{3.642002360447111*^9, 3.6422924955075817`*^9, 
  3.64229254946074*^9, 3.642667692153373*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Exponent", "[", 
  RowBox[{"g3b", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]1", "]"}], ",", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}], ",", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}], ",", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.642001746364205*^9, 3.642001746507635*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.6420017470172653`*^9, 3.6422924955124283`*^9, 
  3.6422925494655533`*^9, 3.6426676921723537`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"solvetrig1", "[", 
    RowBox[{"eq_", ",", " ", "\[Theta]_", ",", 
     RowBox[{"simplify_:", " ", "Identity"}]}], "]"}], ":=", " ", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Inputs", " ", "are", " ", "the", " ", "equation", " ", "and", " ", "the",
      " ", "angle", " ", "\[Theta]"}], "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Solves", " ", "the", " ", "equation", " ", "a", " ", "cos", " ", 
       RowBox[{"(", "\[Theta]", ")"}]}], " ", "+", " ", 
      RowBox[{"b", " ", "sin", " ", 
       RowBox[{"(", "\[Theta]", ")"}]}], " ", "+", " ", "c"}], " ", "=", " ", 
     "0"}], " ", "*)"}], "\n", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "t1", ",", " ", "t2", ",", "a", ",", "b", ",", "c", ",", "\[Alpha]", 
       ",", "\[Phi]", ",", "sol\[Theta]"}], "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{"t1", " ", "=", " ", 
       RowBox[{"simplify", "[", 
        RowBox[{"Numerator", "[", 
         RowBox[{"Together", "[", "eq", "]"}], "]"}], "]"}]}], ";", "\n", 
      RowBox[{"t2", " ", "=", " ", 
       RowBox[{"TrigExpand", "[", "t1", "]"}]}], ";", "\n", "\n", 
      RowBox[{"a", "=", 
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{"eq", ",", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], "//", 
        "Simplify"}]}], ";", "\n", 
      RowBox[{"b", "=", 
       RowBox[{"Coefficient", "[", 
        RowBox[{"eq", ",", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"c", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"eq", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]", "]"}], "->", " ", "0"}], ",", " ", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Theta]", "]"}], "->", " ", "0"}]}], 
          "}"}]}], "]"}]}], "  ", ";", "\n", "\n", 
      RowBox[{"\[Alpha]", " ", "=", 
       RowBox[{"ArcTan", "[", " ", 
        RowBox[{
         RowBox[{"a", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"a", "^", "2"}], "+", 
            RowBox[{"b", "^", "2"}]}], "]"}]}], ",", 
         RowBox[{"b", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"a", "^", "2"}], "+", 
            RowBox[{"b", "^", "2"}]}], "]"}]}]}], "]"}]}], ";", "\n", 
      RowBox[{"\[Phi]", "=", " ", 
       RowBox[{"ArcCos", "[", 
        RowBox[{
         RowBox[{"-", "c"}], "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"a", "^", "2"}], " ", "+", " ", 
           RowBox[{"b", "^", "2"}]}], "]"}]}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"sol\[Theta]", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Theta]", "->", " ", 
           RowBox[{"\[Alpha]", " ", "+", " ", "\[Phi]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", "->", " ", 
           RowBox[{"\[Alpha]", " ", "-", " ", "\[Phi]"}]}], "}"}]}], "}"}]}], 
      ";", "\n", 
      RowBox[{"Return", "[", "sol\[Theta]", "]"}], ";"}]}], "\n", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"solvetrig2", "[", 
     RowBox[{"eq1_", ",", "eq2_", ",", " ", "\[Theta]_", ",", 
      RowBox[{"simplify_:", " ", "Identity"}]}], "]"}], ":=", " ", "\n", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Inputs", " ", "are", " ", "the", " ", "equations"}], " ", ",", 
      
      RowBox[{
      "the", " ", "angle", " ", "\[Theta]", " ", "and", " ", "an", " ", 
       "operator", " ", "x", " ", "which", " ", "decides", " ", "which", " ", 
       "output", " ", "has", " ", "to", " ", "be", " ", "returned"}]}], 
     "*)"}], "\n", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
        "Solves", " ", "the", " ", "equation", " ", "a1", " ", "cos", " ", 
         RowBox[{"(", "\[Theta]", ")"}]}], " ", "+", " ", 
        RowBox[{"b1", " ", "sin", " ", 
         RowBox[{"(", "\[Theta]", ")"}]}], " ", "+", " ", "c1"}], " ", "=", 
       " ", "0"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"a2", " ", "cos", " ", 
         RowBox[{"(", "\[Theta]", ")"}]}], " ", "+", " ", 
        RowBox[{"b2", " ", "sin", " ", 
         RowBox[{"(", "\[Theta]", ")"}]}], " ", "+", " ", "c2"}], " ", "=", 
       " ", "0"}]}], "  ", "*)"}], "\n", 
    RowBox[{"(*", " ", 
     RowBox[{"TODO", ":", " ", 
      RowBox[{
      "check", " ", "if", " ", "the", " ", "input", " ", "equation", " ", 
       "can", " ", "be", " ", "actually", " ", "cast", " ", "in", " ", "the", 
       " ", "desired", " ", "form"}]}], " ", "*)"}], "\n", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t1", ",", " ", "t2", ",", "t11", ",", "t22", ",", " ", "sol", ",", 
        " ", "sol\[Theta]", ",", "con"}], "}"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"t1", " ", "=", " ", 
        RowBox[{"simplify", "[", 
         RowBox[{"Numerator", "[", 
          RowBox[{"Together", "[", "eq1", "]"}], "]"}], "]"}]}], ";", "\n", 
       RowBox[{"t2", " ", "=", " ", 
        RowBox[{"TrigExpand", "[", "t1", "]"}]}], ";", "\n", "\n", 
       RowBox[{"t11", " ", "=", " ", 
        RowBox[{"simplify", "[", 
         RowBox[{"Numerator", "[", 
          RowBox[{"Together", "[", "eq2", "]"}], "]"}], "]"}]}], ";", "\n", 
       RowBox[{"t22", " ", "=", " ", 
        RowBox[{"TrigExpand", "[", "t11", "]"}]}], ";", "\n", 
       RowBox[{"sol", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t2", ",", " ", "t22"}], "}"}], " ", "==", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\n", "\n", 
       RowBox[{"sol\[Theta]", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Theta]", " ", "->", " ", 
           RowBox[{"ArcTan", "[", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "]"}]}], "}"}], "/.", 
         "sol"}]}], ";", "\n", 
       RowBox[{"con", "=", 
        RowBox[{"Numerator", "[", 
         RowBox[{"simplify", "[", 
          RowBox[{"Expand", "[", 
           RowBox[{"Together", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", "\[Theta]", "]"}], "^", "2"}], " ", "+", 
               " ", 
               RowBox[{
                RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", "2"}], " ", "-", 
               " ", "1"}], ")"}], "/.", "sol"}], "]"}], "]"}], "]"}], "]"}]}],
        ";", "\n", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"sol\[Theta]", ",", "con"}], "}"}], "]"}], ";"}]}], "\n", 
     " ", "\n", "]"}]}], ";"}], "\n"}], "\n"}], "Input",
 CellChangeTimes->{{3.5580774360905743`*^9, 3.558077440174471*^9}, {
  3.5580831468622303`*^9, 3.5580831607612867`*^9}, {3.5580832006640043`*^9, 
  3.558083223331644*^9}, {3.558220496443914*^9, 3.5582204970192413`*^9}, {
  3.5587503292200193`*^9, 3.5587503622785063`*^9}, {3.574159778620395*^9, 
  3.5741597788454084`*^9}, {3.5741598100041904`*^9, 3.5741598112272606`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Note", " ", "the", " ", "various", " ", "factors", " ", "of", " ", "g1", 
     " ", "and", " ", 
     RowBox[{"g2", ".", " ", "Instead"}], " ", "of", " ", "looking", " ", 
     "at", " ", "solutions", " ", "of", " ", "g1", " ", "and", " ", "g2"}], 
    ",", " ", 
    RowBox[{
    "look", " ", "at", " ", "the", " ", "solutions", " ", "of", " ", 
     "factors", " ", "of", " ", "g1", " ", "and", " ", "g2"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"tmp1", "=", 
    RowBox[{"FactorList", "[", "g1", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"tmp2", "=", 
    RowBox[{"FactorList", "[", "g2", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.5580774360905743`*^9, 3.558077440174471*^9}, {
  3.5580831468622303`*^9, 3.5580831607612867`*^9}, {3.5580832006640043`*^9, 
  3.558083229738935*^9}, {3.558083413336578*^9, 3.558083423446616*^9}, {
  3.5580837581018267`*^9, 3.558083782558837*^9}, {3.5698308415421867`*^9, 
  3.5698308787133126`*^9}, {3.569830924630939*^9, 3.569830974489791*^9}}],

Cell[BoxData[
 RowBox[{"FactorList", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", 
      RowBox[{"-", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "o2x", " ", 
        SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
       RowBox[{"2", " ", "o2y", " ", 
        SuperscriptBox["q0", "2"], " ", 
        SuperscriptBox["q2", "2"], " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
       RowBox[{"2", " ", "o2x", " ", "q0", " ", 
        SuperscriptBox["q1", "2"], " ", "q3", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
       RowBox[{
       "4", " ", "o2y", " ", "q0", " ", "q1", " ", "q2", " ", "q3", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
       RowBox[{"2", " ", "o2x", " ", "q0", " ", 
        SuperscriptBox["q2", "2"], " ", "q3", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
       RowBox[{"2", " ", "o2y", " ", 
        SuperscriptBox["q1", "2"], " ", 
        SuperscriptBox["q3", "2"], " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
       RowBox[{"2", " ", "o2x", " ", "q1", " ", "q2", " ", 
        SuperscriptBox["q3", "2"], " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", "r1", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]1"}], "]"}]}], "+", 
       RowBox[{"2", " ", "q0", " ", 
        SuperscriptBox["q1", "2"], " ", "q3", " ", "r1", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]1"}], "]"}]}], "-", 
       RowBox[{"2", " ", "q0", " ", 
        SuperscriptBox["q2", "2"], " ", "q3", " ", "r1", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]1"}], "]"}]}], "-", 
       RowBox[{"2", " ", "q1", " ", "q2", " ", 
        SuperscriptBox["q3", "2"], " ", "r1", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]1"}], "]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "4"], " ", "q1", " ", "q2", " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "2"], " ", 
        SuperscriptBox["q1", "3"], " ", "q2", " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "2"], " ", "q1", " ", 
        SuperscriptBox["q2", "3"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "3"], " ", 
        SuperscriptBox["q1", "2"], " ", "q3", " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", "q0", " ", 
        SuperscriptBox["q1", "4"], " ", "q3", " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "3"], " ", 
        SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"4", " ", "q0", " ", 
        SuperscriptBox["q1", "2"], " ", 
        SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", "q0", " ", 
        SuperscriptBox["q2", "4"], " ", "q3", " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", 
        SuperscriptBox["q3", "2"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["q1", "3"], " ", "q2", " ", 
        SuperscriptBox["q3", "2"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", "q1", " ", 
        SuperscriptBox["q2", "3"], " ", 
        SuperscriptBox["q3", "2"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", "q0", " ", 
        SuperscriptBox["q1", "2"], " ", 
        SuperscriptBox["q3", "3"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", "q0", " ", 
        SuperscriptBox["q2", "2"], " ", 
        SuperscriptBox["q3", "3"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", "q1", " ", "q2", " ", 
        SuperscriptBox["q3", "4"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"2", " ", "o2x", " ", 
        SuperscriptBox["q0", "2"], " ", 
        SuperscriptBox["q1", "2"], " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
       RowBox[{"2", " ", "o2y", " ", 
        SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
       RowBox[{"2", " ", "o2y", " ", "q0", " ", 
        SuperscriptBox["q1", "2"], " ", "q3", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
       RowBox[{
       "4", " ", "o2x", " ", "q0", " ", "q1", " ", "q2", " ", "q3", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
       RowBox[{"2", " ", "o2y", " ", "q0", " ", 
        SuperscriptBox["q2", "2"], " ", "q3", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
       RowBox[{"2", " ", "o2y", " ", "q1", " ", "q2", " ", 
        SuperscriptBox["q3", "2"], " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
       RowBox[{"2", " ", "o2x", " ", 
        SuperscriptBox["q2", "2"], " ", 
        SuperscriptBox["q3", "2"], " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "4"], " ", 
        SuperscriptBox["q1", "2"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "2"], " ", 
        SuperscriptBox["q1", "4"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "2"], " ", 
        SuperscriptBox["q1", "2"], " ", 
        SuperscriptBox["q2", "2"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "2"], " ", 
        SuperscriptBox["q1", "2"], " ", 
        SuperscriptBox["q3", "2"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "2"], " ", 
        SuperscriptBox["q2", "2"], " ", 
        SuperscriptBox["q3", "2"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["q1", "2"], " ", 
        SuperscriptBox["q2", "2"], " ", 
        SuperscriptBox["q3", "2"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["q2", "4"], " ", 
        SuperscriptBox["q3", "2"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["q2", "2"], " ", 
        SuperscriptBox["q3", "4"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["q0", "2"], " ", 
        SuperscriptBox["q1", "2"], " ", "r1", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]1"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["q0", "2"], " ", 
        SuperscriptBox["q2", "2"], " ", "r1", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]1"}], "]"}]}], "+", 
       RowBox[{
       "4", " ", "q0", " ", "q1", " ", "q2", " ", "q3", " ", "r1", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]1"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["q1", "2"], " ", 
        SuperscriptBox["q3", "2"], " ", "r1", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]1"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["q2", "2"], " ", 
        SuperscriptBox["q3", "2"], " ", "r1", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]1"}], "]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "4"], " ", 
        SuperscriptBox["q2", "2"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "2"], " ", 
        SuperscriptBox["q1", "2"], " ", 
        SuperscriptBox["q2", "2"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "2"], " ", 
        SuperscriptBox["q2", "4"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "2"], " ", 
        SuperscriptBox["q1", "2"], " ", 
        SuperscriptBox["q3", "2"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["q1", "4"], " ", 
        SuperscriptBox["q3", "2"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "2"], " ", 
        SuperscriptBox["q2", "2"], " ", 
        SuperscriptBox["q3", "2"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["q1", "2"], " ", 
        SuperscriptBox["q2", "2"], " ", 
        SuperscriptBox["q3", "2"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["q1", "2"], " ", 
        SuperscriptBox["q3", "4"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "4"], " ", "q1", " ", "q2", " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "2"], " ", 
        SuperscriptBox["q1", "3"], " ", "q2", " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "2"], " ", "q1", " ", 
        SuperscriptBox["q2", "3"], " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "3"], " ", 
        SuperscriptBox["q1", "2"], " ", "q3", " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", "q0", " ", 
        SuperscriptBox["q1", "4"], " ", "q3", " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["q0", "3"], " ", 
        SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"4", " ", "q0", " ", 
        SuperscriptBox["q1", "2"], " ", 
        SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", "q0", " ", 
        SuperscriptBox["q2", "4"], " ", "q3", " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["q0", "2"], " ", "q1", " ", "q2", " ", 
        SuperscriptBox["q3", "2"], " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["q1", "3"], " ", "q2", " ", 
        SuperscriptBox["q3", "2"], " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"2", " ", "q1", " ", 
        SuperscriptBox["q2", "3"], " ", 
        SuperscriptBox["q3", "2"], " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", "q0", " ", 
        SuperscriptBox["q1", "2"], " ", 
        SuperscriptBox["q3", "3"], " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"2", " ", "q0", " ", 
        SuperscriptBox["q2", "2"], " ", 
        SuperscriptBox["q3", "3"], " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"2", " ", "q1", " ", "q2", " ", 
        SuperscriptBox["q3", "4"], " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", "1"}], "}"}]}], 
   "}"}], "]"}]], "Output",
 CellChangeTimes->{3.641988032671418*^9, 3.642001409012125*^9, 
  3.64229249573104*^9, 3.642292549615662*^9, 3.642667692291573*^9}],

Cell[BoxData[
 RowBox[{"FactorList", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q1", "2"], "+", 
       SuperscriptBox["q2", "2"], "+", 
       SuperscriptBox["q3", "2"]}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "q0"}], " ", "q2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"q1", " ", "q3", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"q0", " ", "q1", " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"q2", " ", "q3", " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"o2x", " ", "q0", " ", "q1"}], "+", 
       RowBox[{"o2y", " ", "q0", " ", "q2"}], "+", 
       RowBox[{"o2y", " ", "q1", " ", "q3"}], "-", 
       RowBox[{"o2x", " ", "q2", " ", "q3"}], "-", 
       RowBox[{"q0", " ", "q1", " ", "r1", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
       RowBox[{"q2", " ", "q3", " ", "r1", " ", 
        RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["q0", "3"], " ", "q1", " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"q0", " ", 
        SuperscriptBox["q1", "3"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"q0", " ", "q1", " ", 
        SuperscriptBox["q2", "2"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["q0", "2"], " ", "q2", " ", "q3", " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["q1", "2"], " ", "q2", " ", "q3", " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["q2", "3"], " ", "q3", " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"q0", " ", "q1", " ", 
        SuperscriptBox["q3", "2"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"q2", " ", 
        SuperscriptBox["q3", "3"], " ", "r2", " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"q0", " ", "q2", " ", "r1", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
       RowBox[{"q1", " ", "q3", " ", "r1", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["q0", "3"], " ", "q2", " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"q0", " ", 
        SuperscriptBox["q1", "2"], " ", "q2", " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"q0", " ", 
        SuperscriptBox["q2", "3"], " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["q0", "2"], " ", "q1", " ", "q3", " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["q1", "3"], " ", "q3", " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"q1", " ", 
        SuperscriptBox["q2", "2"], " ", "q3", " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{"q0", " ", "q2", " ", 
        SuperscriptBox["q3", "2"], " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
       RowBox[{"q1", " ", 
        SuperscriptBox["q3", "3"], " ", "r2", " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", "1"}], "}"}]}], 
   "}"}], "]"}]], "Output",
 CellChangeTimes->{3.641988032671418*^9, 3.642001409012125*^9, 
  3.64229249573104*^9, 3.642292549615662*^9, 3.6426676922951727`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Solutions", " ", "of", " ", "factors", " ", "of", " ", "g1", " ", "and", 
    " ", "g2"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sol\[Theta]1", "=", 
     RowBox[{"solvetrig1", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"tmp1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\[Theta]1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol\[Theta]21", "=", 
     RowBox[{
      RowBox[{"solvetrig1", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"tmp1", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "/.", 
            RowBox[{"sol\[Theta]1", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ")"}], ",", "\[Theta]2"}], "]"}], "//",
       "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol\[Theta]22", "=", 
     RowBox[{
      RowBox[{"solvetrig1", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"tmp1", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "/.", 
            RowBox[{"sol\[Theta]1", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ")"}], ",", "\[Theta]2"}], "]"}], "//",
       "Simplify"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"sol\[Theta]2", "=", 
     RowBox[{"solvetrig1", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"tmp2", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\[Theta]2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol\[Theta]11", "=", 
     RowBox[{"solvetrig1", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"tmp2", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "/.", 
           RowBox[{"sol\[Theta]2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ")"}], ",", "\[Theta]1"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"sol\[Theta]12", "=", 
    RowBox[{"solvetrig1", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"tmp2", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "/.", 
          RowBox[{"sol\[Theta]2", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ")"}], ",", "\[Theta]1"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.558753943413539*^9, 3.558753943757949*^9}, {
   3.558753998247332*^9, 3.558754015229039*^9}, {3.558754085574956*^9, 
   3.558754110224401*^9}, {3.558754177277114*^9, 3.558754271744235*^9}, 
   3.5587544796308327`*^9, {3.5587546163517036`*^9, 3.558754620847975*^9}, {
   3.558770116410509*^9, 3.5587701197894793`*^9}, 3.558770643962717*^9, {
   3.5698309857394342`*^9, 3.5698310148010964`*^9}, {3.5810885049417324`*^9, 
   3.5810885995151415`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"inputs", " ", "to", " ", "define", " ", "the", " ", "cylinders"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "shortest", " ", "distance", " ", "case2a", "\[IndentingNewLine]", 
      "input"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q0", "\[Rule]", 
        RowBox[{"-", "0.2"}]}], ",", 
       RowBox[{"q1", "\[Rule]", "0.3"}], ",", 
       RowBox[{"q2", "\[Rule]", "0.707"}], ",", 
       RowBox[{"q3", "\[Rule]", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"0.707", "^", "2"}], "-", 
          RowBox[{"0.3", "^", "2"}], "-", 
          RowBox[{".2", "^", "2"}]}], "]"}]}], ",", 
       RowBox[{"r1", "\[Rule]", "0.5"}], ",", 
       RowBox[{"r2", "\[Rule]", ".5"}], ",", 
       RowBox[{"l1", "\[Rule]", "7"}], ",", 
       RowBox[{"l2", "\[Rule]", "4"}], ",", 
       RowBox[{"tx", "\[Rule]", "2"}], ",", 
       RowBox[{"ty", "\[Rule]", 
        RowBox[{"-", "2"}]}], ",", 
       RowBox[{"tz", "\[Rule]", "2"}]}], "}"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "cyl", " ", "intersection", " ", "case2a", "\[IndentingNewLine]", 
      "input"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q0", "\[Rule]", "0.2"}], ",", 
       RowBox[{"q1", "\[Rule]", "0.2"}], ",", 
       RowBox[{"q2", "\[Rule]", "0.2"}], ",", 
       RowBox[{"q3", "\[Rule]", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"0.2", "^", "2"}], "-", 
          RowBox[{"0.2", "^", "2"}], "-", 
          RowBox[{"0.2", "^", "2"}]}], "]"}]}], ",", 
       RowBox[{"r1", "\[Rule]", "0.5"}], ",", 
       RowBox[{"r2", "\[Rule]", ".5"}], ",", 
       RowBox[{"l1", "\[Rule]", "7"}], ",", 
       RowBox[{"l2", "\[Rule]", "4"}], ",", 
       RowBox[{"tx", "\[Rule]", 
        RowBox[{"-", "0.7"}]}], ",", 
       RowBox[{"ty", "\[Rule]", 
        RowBox[{"-", "0.9"}]}], ",", 
       RowBox[{"tz", "\[Rule]", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "1.5", "+", "1.4"}]}]}], "}"}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "case2b", " ", "circle", " ", "line", "\[IndentingNewLine]", "input"}], 
     "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q0", "\[Rule]", "0"}], ",", 
       RowBox[{"q1", "\[Rule]", "0.4"}], ",", 
       RowBox[{"q2", "\[Rule]", 
        RowBox[{"-", "0.3"}]}], ",", 
       RowBox[{"q3", "\[Rule]", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"0", "^", "2"}], "-", 
          RowBox[{"0.3", "^", "2"}], "-", 
          RowBox[{"0.4", "^", "2"}]}], "]"}]}], ",", 
       RowBox[{"r1", "\[Rule]", "0.5"}], ",", 
       RowBox[{"r2", "\[Rule]", ".5"}], ",", 
       RowBox[{"l1", "\[Rule]", "7"}], ",", 
       RowBox[{"l2", "\[Rule]", "4"}], ",", 
       RowBox[{"tx", "\[Rule]", "2"}], ",", 
       RowBox[{"ty", "\[Rule]", 
        RowBox[{"-", "2"}]}], ",", 
       RowBox[{"tz", "\[Rule]", "3.5"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "case2c", " ", "circle", " ", "circle", "\[IndentingNewLine]", "input"}],
      "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q0", "\[Rule]", "0.8"}], ",", 
       RowBox[{"q1", "\[Rule]", "0.4"}], ",", 
       RowBox[{"q2", "\[Rule]", 
        RowBox[{"-", "0.3"}]}], ",", 
       RowBox[{"q3", "\[Rule]", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"0.8", "^", "2"}], "-", 
          RowBox[{"0.3", "^", "2"}], "-", 
          RowBox[{"0.4", "^", "2"}]}], "]"}]}], ",", 
       RowBox[{"r1", "\[Rule]", "0.5"}], ",", 
       RowBox[{"r2", "\[Rule]", ".5"}], ",", 
       RowBox[{"l1", "\[Rule]", "7"}], ",", 
       RowBox[{"l2", "\[Rule]", "4"}], ",", 
       RowBox[{"tx", "\[Rule]", "2"}], ",", 
       RowBox[{"ty", "\[Rule]", 
        RowBox[{"-", "2"}]}], ",", 
       RowBox[{"tz", "\[Rule]", "9.5"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"touching", " ", "cyl", "\[IndentingNewLine]", "input"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q0", "\[Rule]", 
        RowBox[{"-", "0.1"}]}], ",", 
       RowBox[{"q1", "\[Rule]", "0"}], ",", 
       RowBox[{"q2", "\[Rule]", 
        RowBox[{"-", "0.5"}]}], ",", 
       RowBox[{"q3", "\[Rule]", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"0.1", "^", "2"}], "-", 
          RowBox[{"0", "^", "2"}], "-", 
          RowBox[{"0", "^", "2"}]}], "]"}]}], ",", 
       RowBox[{"r1", "\[Rule]", "0.5"}], ",", 
       RowBox[{"r2", "\[Rule]", ".5"}], ",", 
       RowBox[{"l1", "\[Rule]", "7"}], ",", 
       RowBox[{"l2", "\[Rule]", "4"}], ",", 
       RowBox[{"tx", "\[Rule]", "1"}], ",", 
       RowBox[{"ty", "\[Rule]", "0"}], ",", 
       RowBox[{"tz", "\[Rule]", "6.7"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"common", " ", "edge", " ", "\[IndentingNewLine]", "input"}], 
     "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q0", "\[Rule]", "0"}], ",", 
       RowBox[{"q1", "\[Rule]", "0"}], ",", 
       RowBox[{"q2", "\[Rule]", "0"}], ",", 
       RowBox[{"q3", "\[Rule]", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"0", "^", "2"}], "-", 
          RowBox[{"0", "^", "2"}], "-", 
          RowBox[{"0", "^", "2"}]}], "]"}]}], ",", 
       RowBox[{"r1", "\[Rule]", "0.5"}], ",", 
       RowBox[{"r2", "\[Rule]", ".5"}], ",", 
       RowBox[{"l1", "\[Rule]", "7"}], ",", 
       RowBox[{"l2", "\[Rule]", "4"}], ",", 
       RowBox[{"tx", "\[Rule]", "0.5"}], ",", 
       RowBox[{"ty", "\[Rule]", "0"}], ",", 
       RowBox[{"tz", "\[Rule]", "7"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5588239415240726`*^9, 3.558823988304873*^9}, {
   3.558824030241153*^9, 3.5588240728567867`*^9}, {3.5588243754498453`*^9, 
   3.558824482328076*^9}, {3.5588246228224373`*^9, 3.558824635014586*^9}, {
   3.558824723176489*^9, 3.558824727162292*^9}, {3.558824784879406*^9, 
   3.558824848866665*^9}, {3.558825000633794*^9, 3.5588250846576347`*^9}, {
   3.5588258681507053`*^9, 3.558825887759346*^9}, {3.558825961729797*^9, 
   3.5588259825646544`*^9}, {3.558826013870875*^9, 3.558826045866074*^9}, {
   3.5588261276064453`*^9, 3.558826138865679*^9}, 3.558838076397911*^9, {
   3.558838243917041*^9, 3.558838260854479*^9}, {3.5698310202444077`*^9, 
   3.569831055352416*^9}, {3.5720627219461203`*^9, 3.5720627221061296`*^9}, {
   3.572062753984953*^9, 3.5720627585932164`*^9}, {3.572097681085696*^9, 
   3.5720976837718496`*^9}, {3.5720977574400635`*^9, 
   3.5720977914960113`*^9}, {3.5720981700906653`*^9, 
   3.5720982107929935`*^9}, {3.5720982797079353`*^9, 3.572098312748825*^9}, {
   3.5720985433310137`*^9, 3.5720986094467955`*^9}, {3.572098680412854*^9, 
   3.572098976285777*^9}, {3.572099285824482*^9, 3.5720993495251255`*^9}, {
   3.5720994003720336`*^9, 3.5720995908539286`*^9}, {3.5721011439407597`*^9, 
   3.5721011442607784`*^9}, {3.5721014251898465`*^9, 3.572101562187682*^9}, {
   3.572102066954553*^9, 3.5721021667882633`*^9}, {3.572102237663317*^9, 
   3.5721022950536*^9}, {3.572102374290132*^9, 3.5721023757732167`*^9}, {
   3.5721025813109727`*^9, 3.57210262969074*^9}, {3.5721261462756863`*^9, 
   3.5721261601004767`*^9}, {3.5721273274822474`*^9, 3.572127339572939*^9}, {
   3.57213045987741*^9, 3.5721304727361455`*^9}, {3.5721311785295143`*^9, 
   3.572131186088947*^9}, {3.5723217061342125`*^9, 3.572321708369341*^9}, {
   3.5723558611910925`*^9, 3.5723558686005163`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"input", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q0", "\[Rule]", 
      RowBox[{"-", "0.2"}]}], ",", 
     RowBox[{"q1", "\[Rule]", "0.3"}], ",", 
     RowBox[{"q2", "\[Rule]", "0.707"}], ",", 
     RowBox[{"q3", "\[Rule]", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"0.707", "^", "2"}], "-", 
        RowBox[{"0.3", "^", "2"}], "-", 
        RowBox[{".2", "^", "2"}]}], "]"}]}], ",", 
     RowBox[{"r1", "\[Rule]", "0.5"}], ",", 
     RowBox[{"r2", "\[Rule]", ".5"}], ",", 
     RowBox[{"l1", "\[Rule]", "7"}], ",", 
     RowBox[{"l2", "\[Rule]", "4"}], ",", 
     RowBox[{"tx", "\[Rule]", "2"}], ",", 
     RowBox[{"ty", "\[Rule]", 
      RowBox[{"-", "2"}]}], ",", 
     RowBox[{"tz", "\[Rule]", "2"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
      RowBox[{"Cylinder", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"l1", "/.", "input"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"r1", "/.", "input"}]}], "]"}]}], "}"}], "]"}], ",", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"Cylinder", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"{", 
           RowBox[{"tx", ",", "ty", ",", "tz"}], "}"}], ")"}], "/.", 
         "input"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tx", ",", "ty", ",", "tz"}], "}"}], "+", 
           RowBox[{"R", ".", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", 
              RowBox[{"l2", "/.", "input"}]}], "}"}]}]}], ")"}], "/.", 
         "input"}]}], "}"}], ",", 
      RowBox[{"r2", "/.", "input"}]}], "]"}], "]"}], ",", 
   RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5588239415240726`*^9, 3.558823988304873*^9}, {
   3.558824030241153*^9, 3.5588240728567867`*^9}, {3.5588243754498453`*^9, 
   3.558824482328076*^9}, {3.5588246228224373`*^9, 3.558824635014586*^9}, {
   3.558824723176489*^9, 3.558824727162292*^9}, {3.558824784879406*^9, 
   3.558824848866665*^9}, {3.558825000633794*^9, 3.5588250846576347`*^9}, {
   3.5588258681507053`*^9, 3.558825887759346*^9}, {3.558825961729797*^9, 
   3.5588259825646544`*^9}, {3.558826013870875*^9, 3.558826045866074*^9}, {
   3.5588261276064453`*^9, 3.558826138865679*^9}, 3.558838076397911*^9, {
   3.558838243917041*^9, 3.558838260854479*^9}, {3.5698310202444077`*^9, 
   3.569831055352416*^9}, {3.5720627219461203`*^9, 3.5720627221061296`*^9}, {
   3.572062753984953*^9, 3.5720627585932164`*^9}, {3.572097681085696*^9, 
   3.5720976837718496`*^9}, {3.5720977574400635`*^9, 
   3.5720977914960113`*^9}, {3.5720981700906653`*^9, 
   3.5720982107929935`*^9}, {3.5720982797079353`*^9, 3.572098312748825*^9}, {
   3.5720985433310137`*^9, 3.5720986094467955`*^9}, {3.572098680412854*^9, 
   3.572098976285777*^9}, {3.572099285824482*^9, 3.5720993495251255`*^9}, {
   3.5720994003720336`*^9, 3.5720995908539286`*^9}, {3.5721011439407597`*^9, 
   3.5721011442607784`*^9}, {3.5721014251898465`*^9, 3.572101562187682*^9}, {
   3.572102066954553*^9, 3.5721021667882633`*^9}, {3.572102237663317*^9, 
   3.5721022950536*^9}, {3.572102374290132*^9, 3.5721023757732167`*^9}, {
   3.5721025813109727`*^9, 3.57210262969074*^9}, {3.5721261462756863`*^9, 
   3.572126202554905*^9}, {3.572127358448018*^9, 3.572127388861758*^9}, {
   3.5721278611227694`*^9, 3.572127866864098*^9}, {3.572130478744489*^9, 
   3.5721304958664684`*^9}, {3.572130540615028*^9, 3.5721305956031733`*^9}, {
   3.572130826945405*^9, 3.5721308677867413`*^9}, {3.572130910498184*^9, 
   3.572130919776715*^9}, 3.5723145847948956`*^9, 3.5723154890296144`*^9, 
   3.5723214257591763`*^9, {3.572321520818613*^9, 3.5723215367765265`*^9}, 
   3.5723217158207664`*^9, {3.572329860884606*^9, 3.5723299003888655`*^9}, 
   3.572330650038743*^9, {3.5723308917035656`*^9, 3.57233089598781*^9}, 
   3.5723546783464375`*^9, {3.5723547686716037`*^9, 3.5723549082935896`*^9}, 
   3.572355479938286*^9, {3.5723555313172245`*^9, 3.572355531483234*^9}, {
   3.572355570350457*^9, 3.572355609998725*^9}, {3.5723557549440155`*^9, 
   3.57235578859694*^9}, {3.5729663917443695`*^9, 3.572966397310688*^9}, 
   3.572966480823465*^9, 3.5741592718474092`*^9, {3.5747338442282333`*^9, 
   3.5747338464513607`*^9}}],

Cell[BoxData[
 Graphics3DBox[{
   {Opacity[0.5], CylinderBox[{{0, 0, 0}, {0, 0, 7}}, 0.5]}, 
   CylinderBox[{{2, -2, 2}, {2.3289608678498404`, 1.921112445232791, 
     1.2812080000000001`}}, 0.5]},
  Boxed->False]], "Output",
 CellChangeTimes->{3.6419880337869864`*^9, 3.642001412733692*^9, 
  3.642292497852723*^9, 3.642292551236115*^9, 3.6426676935087833`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"sol\[Theta]2", "/.", "input"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"tmp2", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], "/.", "input"}], ")"}], 
    "\[Equal]", "0"}], ",", "\[Theta]2"}], "]"}]}], "Input",
 CellChangeTimes->{{3.574161674138813*^9, 3.574161705312596*^9}, {
  3.574161735528324*^9, 3.5741617507311935`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "combinations", " ", "of", " ", "all", " ", "possible", " ", "solutions"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nsolutions", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sol\[Theta]1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", "input"}], ",", 
          RowBox[{
           RowBox[{"sol\[Theta]21", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", "input"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sol\[Theta]1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", "input"}], ",", 
          RowBox[{
           RowBox[{"sol\[Theta]21", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", "input"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sol\[Theta]1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", "input"}], ",", 
          RowBox[{
           RowBox[{"sol\[Theta]22", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", "input"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sol\[Theta]1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", "input"}], ",", 
          RowBox[{
           RowBox[{"sol\[Theta]22", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", "input"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sol\[Theta]11", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", "input"}], ",", 
          RowBox[{
           RowBox[{"sol\[Theta]2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", "input"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sol\[Theta]11", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", "input"}], ",", 
          RowBox[{
           RowBox[{"sol\[Theta]2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", "input"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sol\[Theta]12", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", "input"}], ",", 
          RowBox[{
           RowBox[{"sol\[Theta]2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", "input"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"sol\[Theta]12", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", "input"}], ",", 
          RowBox[{
           RowBox[{"sol\[Theta]2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/.", "input"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sol\[Theta]1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"sol\[Theta]2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "/.", "input"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sol\[Theta]1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"sol\[Theta]2", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "/.", "input"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sol\[Theta]1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"sol\[Theta]2", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "/.", "input"}], "]"}], 
       ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sol\[Theta]1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"sol\[Theta]2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "/.", "input"}], "]"}]}],
       "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"ii", "=", "1"}], ",", 
     RowBox[{"ii", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "nsolutions", "]"}]}], ",", 
     RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"nsolutions", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], "=", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"nsolutions", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"solt", "/.", "input"}], "/.", 
          RowBox[{"nsolutions", "[", 
           RowBox[{"[", "ii", "]"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nsolutions", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"nsolutions", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "nsolutions"}]}]], "Input",
 CellChangeTimes->{{3.5588239415240726`*^9, 3.558823988304873*^9}, {
   3.558824030241153*^9, 3.5588240728567867`*^9}, {3.5588243754498453`*^9, 
   3.558824482328076*^9}, {3.5588246228224373`*^9, 3.558824635014586*^9}, {
   3.558824723176489*^9, 3.558824727162292*^9}, {3.558824784879406*^9, 
   3.558824848866665*^9}, {3.558825000633794*^9, 3.5588250846576347`*^9}, {
   3.5588258681507053`*^9, 3.558825887759346*^9}, {3.558825961729797*^9, 
   3.5588259825646544`*^9}, {3.558826013870875*^9, 3.558826045866074*^9}, {
   3.5588261276064453`*^9, 3.558826138865679*^9}, 3.558838076397911*^9, {
   3.558838243917041*^9, 3.558838260854479*^9}, {3.5698310202444077`*^9, 
   3.569831055352416*^9}, {3.5720627219461203`*^9, 3.5720627221061296`*^9}, {
   3.572062753984953*^9, 3.5720627585932164`*^9}, {3.572097681085696*^9, 
   3.5720976837718496`*^9}, {3.5720979043374653`*^9, 3.5720979091507406`*^9}, 
   3.5720986186113195`*^9, 3.5720994333149176`*^9, 3.5721015718612356`*^9, 
   3.5721026968205795`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t2", "\[Rule]", "Indeterminate"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t2", "\[Rule]", "Indeterminate"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t2", "\[Rule]", "Indeterminate"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t2", "\[Rule]", "Indeterminate"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t2", "\[Rule]", "Indeterminate"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t2", "\[Rule]", "Indeterminate"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t2", "\[Rule]", "Indeterminate"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t2", "\[Rule]", "Indeterminate"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t2", "\[Rule]", "Indeterminate"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t2", "\[Rule]", "Indeterminate"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t2", "\[Rule]", "Indeterminate"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t1", "\[Rule]", "Indeterminate"}], ",", 
     RowBox[{"t2", "\[Rule]", "Indeterminate"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.641988033954362*^9, 3.642001416572813*^9, 
  3.642292551589787*^9, 3.642667693715086*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"filtering", " ", "out", " ", "real", " ", "solutions"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"restol1", "=", 
     RowBox[{"10", "^", 
      RowBox[{"-", "3"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"realsolns", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"ii", "=", "1"}], ",", 
     RowBox[{"ii", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "nsolutions", "]"}]}], ",", 
     RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tmp", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Theta]1", ",", "\[Theta]2", ",", "t1", ",", "t2"}], "}"}],
         "/.", 
        RowBox[{"nsolutions", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Im", "[", "tmp", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "  ", "restol1"}], 
         " ", "&&", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Im", "[", "tmp", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", " ", "restol1"}], 
         " ", "&&", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Im", "[", "tmp", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "\[LessEqual]", " ", "restol1"}], 
         " ", "&&", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Im", "[", "tmp", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], "\[LessEqual]", " ", "restol1"}], 
         " ", "&&", 
         RowBox[{
          RowBox[{"tmp", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "\[LessEqual]", " ", "1"}], " ", "&&", 
         RowBox[{
          RowBox[{"tmp", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "\[LessEqual]", " ", "1"}], "&&", 
         RowBox[{
          RowBox[{"tmp", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "\[GreaterEqual]", "  ", "0"}], 
         " ", "&&", 
         RowBox[{
          RowBox[{"tmp", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "\[GreaterEqual]", "  ", "0"}]}], 
        ",", 
        RowBox[{"realsolns", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"realsolns", ",", 
           RowBox[{"nsolutions", "[", 
            RowBox[{"[", "ii", "]"}], "]"}]}], "]"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "realsolns", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.5588239415240726`*^9, 3.558823988304873*^9}, {
   3.558824030241153*^9, 3.5588240728567867`*^9}, {3.5588243754498453`*^9, 
   3.558824482328076*^9}, {3.5588246228224373`*^9, 3.558824635014586*^9}, {
   3.558824723176489*^9, 3.558824727162292*^9}, {3.558824784879406*^9, 
   3.558824848866665*^9}, {3.558825000633794*^9, 3.5588250846576347`*^9}, {
   3.5588258681507053`*^9, 3.558825887759346*^9}, {3.558825961729797*^9, 
   3.5588259825646544`*^9}, {3.558826013870875*^9, 3.558826045866074*^9}, {
   3.5588261276064453`*^9, 3.558826138865679*^9}, 3.558838076397911*^9, {
   3.558838243917041*^9, 3.558838260854479*^9}, {3.5698310202444077`*^9, 
   3.569831055352416*^9}, {3.5720627219461203`*^9, 3.5720627221061296`*^9}, {
   3.572062753984953*^9, 3.5720627585932164`*^9}, {3.572097681085696*^9, 
   3.5720976837718496`*^9}, 3.5720979043374653`*^9}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.641988033993095*^9, 3.6420014166870117`*^9, 
  3.642292551742406*^9, 3.6426676937279997`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "/.", "input"}], "/.", "nsolutions"}]], "Input",
 CellChangeTimes->{{3.572102719103854*^9, 3.5721027231650867`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Indeterminate", ",", "Indeterminate", ",", "Indeterminate", ",", 
   "Indeterminate", ",", "Indeterminate", ",", "Indeterminate", ",", 
   "Indeterminate", ",", "Indeterminate", ",", "Indeterminate", ",", 
   "Indeterminate", ",", "Indeterminate", ",", "Indeterminate"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6419880340380173`*^9, 3.642001416784588*^9, 
  3.6422925518309183`*^9, 3.6426676937474546`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "substituting", " ", "the", " ", "realsolutions", " ", "back", " ", "to", 
    " ", "find", " ", "residue"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f1", "/.", "input"}], "/.", "realsolns"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f2", "/.", "input"}], "/.", "realsolns"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f3", "/.", "input"}], "/.", "realsolns"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f4", "/.", "input"}], "/.", "realsolns"}], "\[IndentingNewLine]", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"d", "/.", "input"}], "/.", "realsolns"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Min", "[", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"Chop", "[", 
      RowBox[{
       RowBox[{"d", "/.", "input"}], "/.", "realsolns"}], "]"}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.558220564288939*^9, 3.558220615496231*^9}, {
  3.5588259311485863`*^9, 3.558825942083714*^9}, {3.558826088658926*^9, 
  3.558826089138582*^9}, {3.569831061332758*^9, 3.56983107098531*^9}, {
  3.572101169939247*^9, 3.572101170187261*^9}, {3.5723308407076483`*^9, 
  3.5723308434758067`*^9}, {3.574159427249298*^9, 3.5741594577670436`*^9}}],

Cell[BoxData["f1"], "Output",
 CellChangeTimes->{3.641988034078341*^9, 3.642001416809898*^9, 
  3.642292551846653*^9, 3.64266769375348*^9}],

Cell[BoxData["f2"], "Output",
 CellChangeTimes->{3.641988034078341*^9, 3.642001416809898*^9, 
  3.642292551846653*^9, 3.642667693754537*^9}],

Cell[BoxData["f3"], "Output",
 CellChangeTimes->{3.641988034078341*^9, 3.642001416809898*^9, 
  3.642292551846653*^9, 3.64266769375546*^9}],

Cell[BoxData["f4"], "Output",
 CellChangeTimes->{3.641988034078341*^9, 3.642001416809898*^9, 
  3.642292551846653*^9, 3.642667693756379*^9}],

Cell[BoxData[
 RowBox[{"0.49999999999999994`", "\[VeryThinSpace]", "+", 
  SuperscriptBox["o2x", "2"], "+", 
  SuperscriptBox["o2y", "2"], "+", 
  SuperscriptBox["o2z", "2"], "+", 
  RowBox[{"49", " ", 
   SuperscriptBox["t1", "2"]}], "+", 
  RowBox[{"15.999999999999996`", " ", 
   SuperscriptBox["t2", "2"]}], "+", 
  RowBox[{"t2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"8", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"0.04112010848123007`", " ", "o2x"}], "+", 
           RowBox[{"0.4901390556540989`", " ", "o2y"}]}], ")"}]}], "-", 
        RowBox[{"0.17969799999999997`", " ", "o2z"}]}], ")"}]}], "-", 
     RowBox[{"8.`", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"0.04112010848123007`", " ", 
         RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
        RowBox[{"0.4901390556540989`", " ", 
         RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
  
  RowBox[{"t1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "14"}], " ", "o2z"}], "+", 
     RowBox[{"10.063087999999999`", " ", "t2"}], "-", 
     RowBox[{"14.`", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"0.3239201084812301`", " ", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
        RowBox[{"0.3701390556540989`", " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
  
  RowBox[{"1.`", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.7399999999999999`"}], " ", "o2x"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"0.09041992767917992`", " ", "o2y"}], "+", 
           RowBox[{"0.3239201084812301`", " ", "o2z"}]}], ")"}]}]}], ")"}], 
      " ", 
      RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"0.07969799999999999`", " ", "o2y"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"0.3337800723208201`", " ", "o2x"}], "+", 
           RowBox[{"0.3701390556540989`", " ", "o2z"}]}], ")"}]}]}], ")"}], 
      " ", 
      RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}], "+", 
  RowBox[{"0.5`", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"o2x", " ", 
         RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
        RowBox[{"o2y", " ", 
         RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], ")"}]}], "-", 
     RowBox[{"1.`", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.330151`"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "-", 
        RowBox[{"0.4098489999999999`", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "0.12168007232082007`"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
           RowBox[{"0.21209999999999998`", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.641988034078341*^9, 3.642001416809898*^9, 
  3.642292551846653*^9, 3.642667693757596*^9}],

Cell[BoxData[
 RowBox[{"\[Sqrt]", 
  RowBox[{"(", 
   RowBox[{"0.49999999999999994`", "\[VeryThinSpace]", "+", 
    SuperscriptBox["o2x", "2"], "+", 
    SuperscriptBox["o2y", "2"], "+", 
    SuperscriptBox["o2z", "2"], "+", 
    RowBox[{"49", " ", 
     SuperscriptBox["t1", "2"]}], "+", 
    RowBox[{"15.999999999999996`", " ", 
     SuperscriptBox["t2", "2"]}], "+", 
    RowBox[{"t2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"8", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"0.04112010848123007`", " ", "o2x"}], "+", 
             RowBox[{"0.4901390556540989`", " ", "o2y"}]}], ")"}]}], "-", 
          RowBox[{"0.17969799999999997`", " ", "o2z"}]}], ")"}]}], "-", 
       RowBox[{"8.`", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0.04112010848123007`", " ", 
           RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
          RowBox[{"0.4901390556540989`", " ", 
           RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], ")"}]}]}], ")"}]}], 
    "+", 
    RowBox[{"t1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "14"}], " ", "o2z"}], "+", 
       RowBox[{"10.063087999999999`", " ", "t2"}], "-", 
       RowBox[{"14.`", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0.3239201084812301`", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
          RowBox[{"0.3701390556540989`", " ", 
           RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}], 
    "+", 
    RowBox[{"1.`", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "0.7399999999999999`"}], " ", "o2x"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"0.09041992767917992`", " ", "o2y"}], "+", 
             RowBox[{"0.3239201084812301`", " ", "o2z"}]}], ")"}]}]}], ")"}], 
        " ", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0.07969799999999999`", " ", "o2y"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"0.3337800723208201`", " ", "o2x"}], "+", 
             RowBox[{"0.3701390556540989`", " ", "o2z"}]}], ")"}]}]}], ")"}], 
        " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}], "+", 
    RowBox[{"0.5`", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"o2x", " ", 
           RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
          RowBox[{"o2y", " ", 
           RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], ")"}]}], "-", 
       RowBox[{"1.`", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "0.330151`"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "-", 
          RowBox[{"0.4098489999999999`", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "0.12168007232082007`"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
             RowBox[{"0.21209999999999998`", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.641988034078341*^9, 3.642001416809898*^9, 
  3.642292551846653*^9, 3.642667693759234*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"np1", "=", 
  RowBox[{
   RowBox[{"p1", "/.", "input"}], "/.", 
   RowBox[{"realsolns", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"np2", "=", 
  RowBox[{
   RowBox[{"p2", "/.", "input"}], "/.", 
   RowBox[{"realsolns", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.558826065509202*^9, 3.558826113945031*^9}, {
  3.569831074889533*^9, 3.569831085343131*^9}, {3.5721011753505564`*^9, 
  3.572101176305611*^9}, {3.5723549319729443`*^9, 3.5723549329459996`*^9}, {
  3.574159474416996*^9, 3.5741594890378323`*^9}, {3.5747340327060137`*^9, 
  3.574734043006603*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\(4\\)\[NoBreak] of \
\[NoBreak]\\!\\({}\\)\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.641988034152968*^9, 3.642001416994573*^9, 
  3.642292551916854*^9, 3.642667693808641*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ReplaceAll", "::", "reps"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({\\(\\(\\({}\\)\\) \[LeftDoubleBracket] 4 \
\[RightDoubleBracket]\\)}\\)\[NoBreak] is neither a list of replacement rules \
nor a valid dispatch table, and so cannot be used for replacing. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/ReplaceAll/reps\\\", \
ButtonNote -> \\\"ReplaceAll::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.641988034152968*^9, 3.642001416994573*^9, 
  3.642292551916854*^9, 3.642667693819439*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"0.5`", " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], ",", 
    RowBox[{"0.5`", " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], ",", 
    RowBox[{"7", " ", "t1"}]}], "}"}], "/.", "\[VeryThinSpace]", 
  RowBox[{
   RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "4", 
   "\[RightDoubleBracket]"}]}]], "Output",
 CellChangeTimes->{3.641988034186489*^9, 3.6420014170555*^9, 
  3.642292551928344*^9, 3.642667693820547*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\(4\\)\[NoBreak] of \
\[NoBreak]\\!\\({}\\)\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.641988034152968*^9, 3.642001416994573*^9, 
  3.642292551916854*^9, 3.6426676938423853`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ReplaceAll", "::", "reps"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({\\(\\(\\({}\\)\\) \[LeftDoubleBracket] 4 \
\[RightDoubleBracket]\\)}\\)\[NoBreak] is neither a list of replacement rules \
nor a valid dispatch table, and so cannot be used for replacing. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/ReplaceAll/reps\\\", \
ButtonNote -> \\\"ReplaceAll::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.641988034152968*^9, 3.642001416994573*^9, 
  3.642292551916854*^9, 3.642667693857719*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"o2x", "+", 
     RowBox[{"0.3289608678498406`", " ", "t2"}], "-", 
     RowBox[{"0.36999999999999994`", " ", 
      RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
     RowBox[{"0.3337800723208201`", " ", 
      RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
    RowBox[{"o2y", "+", 
     RowBox[{"3.921112445232791`", " ", "t2"}], "+", 
     RowBox[{"0.09041992767917992`", " ", 
      RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
     RowBox[{"0.039848999999999996`", " ", 
      RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
    RowBox[{"o2z", "-", 
     RowBox[{"0.7187919999999999`", " ", "t2"}], "+", 
     RowBox[{"0.3239201084812301`", " ", 
      RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
     RowBox[{"0.3701390556540989`", " ", 
      RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]}], "}"}], "/.", 
  "\[VeryThinSpace]", 
  RowBox[{
   RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "4", 
   "\[RightDoubleBracket]"}]}]], "Output",
 CellChangeTimes->{3.641988034186489*^9, 3.6420014170555*^9, 
  3.642292551928344*^9, 3.6426676938586683`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", 
      RowBox[{"Cylinder", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"0", "/.", "input"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"l1", "/.", "input"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"r1", "/.", "input"}]}], "]"}], "}"}], "]"}], ",", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"Cylinder", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tx", ",", "ty", ",", "tz"}], "}"}], "-", 
            RowBox[{"R", ".", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"0", "/.", "input"}]}], "}"}]}]}], ")"}], "/.", 
          "input"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tx", ",", "ty", ",", "tz"}], "}"}], "+", 
            RowBox[{"R", ".", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"l2", "/.", "input"}]}], "}"}]}]}], ")"}], "/.", 
          "input"}]}], "}"}], ",", 
       RowBox[{"r2", "/.", "input"}]}], "]"}], "]"}], ",", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.01", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"np1", ",", "np2"}], "}"}], "]"}]}], "}"}], "]"}], ",", " ", 
    
    RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5587795093706617`*^9, 3.558779564496065*^9}, {
   3.55877967345051*^9, 3.558779784653714*^9}, {3.558788107977495*^9, 
   3.558788157697606*^9}, {3.55878819926399*^9, 3.5587882230783567`*^9}, {
   3.5721011892353506`*^9, 3.5721012031031437`*^9}, {3.5721012470306563`*^9, 
   3.572101248979768*^9}, {3.5721013155105734`*^9, 3.572101388389742*^9}, {
   3.5721015940635056`*^9, 3.572101596796662*^9}, 3.5721022155310516`*^9, {
   3.5723549421605268`*^9, 3.572354948124868*^9}, {3.5723549849579744`*^9, 
   3.572355004397086*^9}, 3.5723554958051934`*^9}],

Cell[BoxData[
 Graphics3DBox[{CylinderBox[{{0, 0, 0}, {0, 0, 7}}, 0.5], 
   CylinderBox[{{2, -2, 2}, {2.3289608678498404`, 1.921112445232791, 
     1.2812080000000001`}}, 0.5], 
   {Thickness[0.01], 
    Line3DBox[{
     ReplaceAll[{
       0.5 Cos[$CellContext`\[Theta]1], 0.5 Sin[$CellContext`\[Theta]1], 
        7 $CellContext`t1}, Part[{}, 4]], 
      ReplaceAll[{$CellContext`o2x + 0.3289608678498406 $CellContext`t2 - 
        0.36999999999999994` Cos[$CellContext`\[Theta]2] + 
        0.3337800723208201 Sin[$CellContext`\[Theta]2], $CellContext`o2y + 
        3.921112445232791 $CellContext`t2 + 
        0.09041992767917992 Cos[$CellContext`\[Theta]2] + 
        0.039848999999999996` Sin[$CellContext`\[Theta]2], $CellContext`o2z - 
        0.7187919999999999 $CellContext`t2 + 
        0.3239201084812301 Cos[$CellContext`\[Theta]2] + 
        0.3701390556540989 Sin[$CellContext`\[Theta]2]}, Part[{}, 4]]}]}},
  Boxed->False]], "Output",
 CellChangeTimes->{3.641988034273728*^9, 3.642001417263391*^9, 
  3.642292552010784*^9, 3.642667693882765*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5580858843897543`*^9, 3.5580858844151278`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"np", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t0", " ", 
         RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], ",", 
        RowBox[{"t0", " ", 
         RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], ",", 
        RowBox[{"l1", " ", "t1"}]}], "}"}], "-", "np2"}], ")"}], "/.", 
    "input"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.572355147519273*^9, 3.5723552090607924`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"t0", " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"o2x", "+", 
         RowBox[{"0.3289608678498406`", " ", "t2"}], "-", 
         RowBox[{"0.36999999999999994`", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{"0.3337800723208201`", " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
        RowBox[{"o2y", "+", 
         RowBox[{"3.921112445232791`", " ", "t2"}], "+", 
         RowBox[{"0.09041992767917992`", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{"0.039848999999999996`", " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
        RowBox[{"o2z", "-", 
         RowBox[{"0.7187919999999999`", " ", "t2"}], "+", 
         RowBox[{"0.3239201084812301`", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{"0.3701390556540989`", " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]}], "}"}], "/.", 
      "\[VeryThinSpace]", 
      RowBox[{
       RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "4", 
       "\[RightDoubleBracket]"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"o2x", "+", 
          RowBox[{"0.3289608678498406`", " ", "t2"}], "-", 
          RowBox[{"0.36999999999999994`", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
          RowBox[{"0.3337800723208201`", " ", 
           RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
         RowBox[{"o2y", "+", 
          RowBox[{"3.921112445232791`", " ", "t2"}], "+", 
          RowBox[{"0.09041992767917992`", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
          RowBox[{"0.039848999999999996`", " ", 
           RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
         RowBox[{"o2z", "-", 
          RowBox[{"0.7187919999999999`", " ", "t2"}], "+", 
          RowBox[{"0.3239201084812301`", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
          RowBox[{"0.3701390556540989`", " ", 
           RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]}], "}"}], "/.", 
       "\[VeryThinSpace]", 
       RowBox[{
        RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "4", 
        "\[RightDoubleBracket]"}]}], ")"}]}], "+", 
    RowBox[{"t0", " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"7", " ", "t1"}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"o2x", "+", 
         RowBox[{"0.3289608678498406`", " ", "t2"}], "-", 
         RowBox[{"0.36999999999999994`", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{"0.3337800723208201`", " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
        RowBox[{"o2y", "+", 
         RowBox[{"3.921112445232791`", " ", "t2"}], "+", 
         RowBox[{"0.09041992767917992`", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{"0.039848999999999996`", " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
        RowBox[{"o2z", "-", 
         RowBox[{"0.7187919999999999`", " ", "t2"}], "+", 
         RowBox[{"0.3239201084812301`", " ", 
          RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
         RowBox[{"0.3701390556540989`", " ", 
          RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]}], "}"}], "/.", 
      "\[VeryThinSpace]", 
      RowBox[{
       RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "4", 
       "\[RightDoubleBracket]"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.641988034293667*^9, 3.642001417422833*^9, 
  3.6422925520545073`*^9, 3.642667693895863*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"np", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], ",", "t1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.572355211149912*^9, 3.572355218769348*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"t1", "\[Rule]", 
    RowBox[{
     FractionBox["1", "7"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"o2x", "+", 
          RowBox[{"0.3289608678498406`", " ", "t2"}], "-", 
          RowBox[{"0.36999999999999994`", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
          RowBox[{"0.3337800723208201`", " ", 
           RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
         RowBox[{"o2y", "+", 
          RowBox[{"3.921112445232791`", " ", "t2"}], "+", 
          RowBox[{"0.09041992767917992`", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
          RowBox[{"0.039848999999999996`", " ", 
           RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
         RowBox[{"o2z", "-", 
          RowBox[{"0.7187919999999999`", " ", "t2"}], "+", 
          RowBox[{"0.3239201084812301`", " ", 
           RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
          RowBox[{"0.3701390556540989`", " ", 
           RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]}], "}"}], "/.", 
       "\[VeryThinSpace]", 
       RowBox[{
        RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "4", 
        "\[RightDoubleBracket]"}]}], ")"}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.6419880343351097`*^9, 3.6420014175256977`*^9, 
  3.64229255206009*^9, 3.642667693919208*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Numerator", "[", 
     RowBox[{"Together", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"np", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"np", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], "^", "2"}], "-", 
       "1"}], "]"}], "]"}], "\[Equal]", "0"}], ",", "t0"}], "]"}]], "Input",
 CellChangeTimes->{{3.5723552455958824`*^9, 3.5723553146238303`*^9}},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Solve", "::", "ratnz"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Solve was unable to solve the system with inexact \
coefficients. The answer was obtained by solving a corresponding exact system \
and numericizing the result. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/Solve\\\", ButtonNote -> \
\\\"Solve::ratnz\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.642292552143742*^9, 3.642667693979258*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"t0", "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       SqrtBox["2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"o2x", "+", 
           RowBox[{"0.3289608678498406`", " ", "t2"}], "-", 
           RowBox[{"0.36999999999999994`", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
           RowBox[{"0.3337800723208201`", " ", 
            RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
          RowBox[{"o2y", "+", 
           RowBox[{"3.921112445232791`", " ", "t2"}], "+", 
           RowBox[{"0.09041992767917992`", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
           RowBox[{"0.039848999999999996`", " ", 
            RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
          RowBox[{"o2z", "-", 
           RowBox[{"0.7187919999999999`", " ", "t2"}], "+", 
           RowBox[{"0.3239201084812301`", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
           RowBox[{"0.3701390556540989`", " ", 
            RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]}], "}"}], "/.", 
        "\[VeryThinSpace]", 
        RowBox[{
         RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "4", 
         "\[RightDoubleBracket]"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t0", "\[Rule]", 
     RowBox[{
      SqrtBox["2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"o2x", "+", 
           RowBox[{"0.3289608678498406`", " ", "t2"}], "-", 
           RowBox[{"0.36999999999999994`", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
           RowBox[{"0.3337800723208201`", " ", 
            RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
          RowBox[{"o2y", "+", 
           RowBox[{"3.921112445232791`", " ", "t2"}], "+", 
           RowBox[{"0.09041992767917992`", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
           RowBox[{"0.039848999999999996`", " ", 
            RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
          RowBox[{"o2z", "-", 
           RowBox[{"0.7187919999999999`", " ", "t2"}], "+", 
           RowBox[{"0.3239201084812301`", " ", 
            RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
           RowBox[{"0.3701390556540989`", " ", 
            RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]}], "}"}], "/.", 
        "\[VeryThinSpace]", 
        RowBox[{
         RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "4", 
         "\[RightDoubleBracket]"}]}], ")"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6419880343655653`*^9, 3.642001417684342*^9, 
  3.6422925521450253`*^9, 3.6426676939803057`*^9}]
}, Open  ]]
},
WindowSize->{1855, 1056},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> True}},
ShowSelection->True,
Magnification->1.5,
FrontEndVersion->"10.0 for Linux x86 (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 71, 1, 44, "Input"],
Cell[631, 23, 400, 10, 115, "Input",
 Evaluatable->False],
Cell[1034, 35, 496, 16, 44, "Input"],
Cell[CellGroupData[{
Cell[1555, 55, 1940, 41, 241, "Input"],
Cell[3498, 98, 543, 12, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4078, 115, 5439, 126, 577, "Input"],
Cell[9520, 243, 2134, 58, 123, "Output"],
Cell[11657, 303, 2543, 69, 120, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14237, 377, 1512, 47, 157, "Input"],
Cell[15752, 426, 4331, 128, 298, "Output"],
Cell[20086, 556, 4581, 133, 298, "Output"]
}, Open  ]],
Cell[24682, 692, 844, 20, 101, "Input"],
Cell[CellGroupData[{
Cell[25551, 716, 909, 24, 101, "Input"],
Cell[26463, 742, 6044, 176, 221, "Output"],
Cell[32510, 920, 492, 9, 34, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33039, 934, 542, 10, 44, "Input"],
Cell[33584, 946, 2176, 50, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35797, 1001, 235, 6, 44, "Input"],
Cell[36035, 1009, 1726, 43, 75, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37798, 1057, 559, 12, 73, "Input"],
Cell[38360, 1071, 3901, 85, 147, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42298, 1161, 278, 8, 44, "Input"],
Cell[42579, 1171, 3801, 84, 147, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46417, 1260, 261, 7, 44, "Input"],
Cell[46681, 1269, 3136, 78, 112, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49854, 1352, 697, 14, 44, "Input"],
Cell[50554, 1368, 1397, 37, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51988, 1410, 276, 8, 44, "Input"],
Cell[52267, 1420, 1278, 30, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53582, 1455, 285, 7, 44, "Input"],
Cell[53870, 1464, 1037, 26, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54944, 1495, 695, 14, 73, "Input"],
Cell[55642, 1511, 2933, 73, 117, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58612, 1589, 325, 9, 44, "Input"],
Cell[58940, 1600, 2863, 67, 117, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61840, 1672, 338, 8, 44, "Input"],
Cell[62181, 1682, 2449, 63, 108, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64667, 1750, 493, 11, 44, "Input"],
Cell[65163, 1763, 10747, 271, 204, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75947, 2039, 377, 10, 44, "Input"],
Cell[76327, 2051, 10242, 257, 200, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86606, 2313, 261, 7, 44, "Input"],
Cell[86870, 2322, 10161, 259, 196, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97068, 2586, 312, 7, 44, "Input"],
Cell[97383, 2595, 9090, 232, 164, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106510, 2832, 125, 2, 44, "Input"],
Cell[106638, 2836, 296, 6, 34, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106971, 2847, 259, 6, 44, "Input"],
Cell[107233, 2855, 236, 3, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107506, 2863, 430, 9, 44, "Input"],
Cell[107939, 2874, 117, 3, 44, "Output"]
}, Open  ]],
Cell[108071, 2880, 2414, 60, 157, "Input"],
Cell[CellGroupData[{
Cell[110510, 2944, 1400, 29, 44, "Input"],
Cell[111913, 2975, 6102, 153, 284, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118052, 3133, 943, 20, 101, "Input"],
Cell[118998, 3155, 14716, 322, 508, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133751, 3482, 282, 7, 44, "Input"],
Cell[134036, 3491, 3181, 82, 166, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137254, 3578, 913, 19, 73, "Input"],
Cell[138170, 3599, 3950, 91, 204, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142157, 3695, 233, 6, 44, "Input"],
Cell[142393, 3703, 2508, 63, 132, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144938, 3771, 487, 13, 44, "Input"],
Cell[145428, 3786, 596, 12, 61, "Message"]
}, Open  ]],
Cell[146039, 3801, 237, 6, 44, "Input"],
Cell[CellGroupData[{
Cell[146301, 3811, 213, 5, 44, "Input"],
Cell[146517, 3818, 13897, 323, 498, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160451, 4146, 605, 14, 44, "Input"],
Cell[161059, 4162, 238, 4, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161334, 4171, 212, 5, 44, "Input"],
Cell[161549, 4178, 2699, 63, 108, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[164285, 4246, 385, 9, 44, "Input"],
Cell[164673, 4257, 204, 4, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[164914, 4266, 213, 5, 44, "Input"],
Cell[165130, 4273, 884, 25, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166051, 4303, 385, 9, 44, "Input"],
Cell[166439, 4314, 212, 4, 44, "Output"]
}, Open  ]],
Cell[166666, 4321, 7506, 187, 1081, "Input"],
Cell[CellGroupData[{
Cell[174197, 4512, 1076, 23, 101, "Input"],
Cell[175276, 4537, 14952, 322, 508, "Output"],
Cell[190231, 4861, 3930, 90, 182, "Output"]
}, Open  ]],
Cell[194176, 4954, 3167, 88, 213, "Input"],
Cell[197346, 5044, 8008, 189, 717, "Input"],
Cell[CellGroupData[{
Cell[205379, 5237, 4627, 96, 101, "Input"],
Cell[210009, 5335, 362, 7, 670, "Output"]
}, Open  ]],
Cell[210386, 5345, 458, 12, 73, "Input"],
Cell[CellGroupData[{
Cell[210869, 5361, 6345, 167, 353, "Input"],
Cell[217217, 5530, 3440, 76, 353, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[220694, 5611, 3642, 86, 325, "Input"],
Cell[224339, 5699, 160, 3, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[224536, 5707, 155, 3, 44, "Input"],
Cell[224694, 5712, 452, 9, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[225183, 5726, 1256, 29, 213, "Input"],
Cell[226442, 5757, 139, 2, 44, "Output"],
Cell[226584, 5761, 140, 2, 44, "Output"],
Cell[226727, 5765, 139, 2, 44, "Output"],
Cell[226869, 5769, 140, 2, 44, "Output"],
Cell[227012, 5773, 3550, 102, 132, "Output"],
Cell[230565, 5877, 3796, 104, 145, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[234398, 5986, 655, 15, 73, "Input"],
Cell[235056, 6003, 534, 11, 34, "Message"],
Cell[235593, 6016, 662, 12, 34, "Message"],
Cell[236258, 6030, 491, 13, 44, "Output"],
Cell[236752, 6045, 536, 11, 34, "Message"],
Cell[237291, 6058, 662, 12, 34, "Message"],
Cell[237956, 6072, 1127, 27, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[239120, 6104, 2322, 59, 129, "Input"],
Cell[241445, 6165, 1062, 20, 670, "Output"]
}, Open  ]],
Cell[242522, 6188, 96, 1, 44, "Input"],
Cell[CellGroupData[{
Cell[242643, 6193, 487, 14, 73, "Input"],
Cell[243133, 6209, 3813, 91, 185, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[246983, 6305, 239, 7, 44, "Input"],
Cell[247225, 6314, 1406, 33, 108, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[248668, 6352, 1049, 29, 44, "Input"],
Cell[249720, 6383, 545, 11, 34, "Message"],
Cell[250268, 6396, 2739, 65, 153, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
