(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     48463,       1244]
NotebookOptionsPosition[     46551,       1174]
NotebookOutlinePosition[     46911,       1190]
CellTagsIndexPosition[     46868,       1187]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"zeroQ", "[", 
     RowBox[{"a_", ",", 
      RowBox[{"eps_:", " ", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"-", "10"}], ")"}]}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NumericQ", "[", "a", "]"}], "&&", 
          RowBox[{
           RowBox[{"Abs", "[", "a", "]"}], "<", "eps"}]}], ",", 
         RowBox[{
          RowBox[{"Return", "[", "True", "]"}], ";"}], ",", 
         RowBox[{
          RowBox[{"Return", "[", "False", "]"}], ";"}]}], "]"}], ";"}]}], 
     "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rottoAxisAngle", "[", 
     RowBox[{"R_", ",", "k_", ",", "\[Phi]_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sol\[Phi]", ",", "s\[Phi]", ",", "solk", ",", "sol"}], "}"}], 
      ",", 
      RowBox[{"(*", 
       RowBox[{
       "Check", " ", "to", " ", "make", " ", "sure", " ", "the", " ", 
        "dimensions", " ", "of", " ", "the", " ", "rotation", " ", "matrix", 
        " ", "are", " ", "correct"}], "*)"}], 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MatrixQ", "[", "R", "]"}]}], "||", 
          RowBox[{
           RowBox[{"Dimensions", "[", "R", "]"}], "\[NotEqual]", 
           RowBox[{"{", 
            RowBox[{"3", ",", "3"}], "}"}]}]}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<rottoAxisAngle::error: \>\"", ",", "R", ",", 
            "\"\< is not a 3x3 matrix!\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sol\[Phi]", "=", 
        RowBox[{"{", 
         RowBox[{"\[Phi]", "\[Rule]", 
          RowBox[{"ArcCos", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Tr", "[", "R", "]"}], "-", "1"}], ")"}], "/", "2"}], 
           "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s\[Phi]", "=", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Phi]", "]"}], "/.", "sol\[Phi]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"zeroQ", "[", "sol\[Phi]", "]"}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<rottoAxisAngle::error: angle is calculated as 0,\[Pi] or -\
\[Pi]. Hence, the axis cannot be found.\>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"solk", "=", 
        RowBox[{"{", 
         RowBox[{"k", "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"2", "*", "s\[Phi]"}], ")"}]}], ")"}], "*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"R", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "2"}], "]"}], "]"}], "-", 
              RowBox[{"R", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"R", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "3"}], "]"}], "]"}], "-", 
              RowBox[{"R", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"R", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
              RowBox[{"R", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}]}]}], "}"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"sol", "=", 
        RowBox[{"Union", "[", 
         RowBox[{"solk", ",", "sol\[Phi]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "sol", "]"}], ";"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"axisAngletoRot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"kx_", ",", "ky_", ",", "kz_"}], "}"}], ",", "\[Phi]_"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "c\[Phi]", ",", "s\[Phi]", ",", "ominc\[Phi]", ",", "kxs\[Phi]", ",", 
       "kys\[Phi]", ",", "kzs\[Phi]", ",", "kxy", ",", "kyz", ",", "kzx", ",",
        "sol"}], "}"}], ",", 
     RowBox[{
      RowBox[{"c\[Phi]", "=", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s\[Phi]", "=", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ominc\[Phi]", "=", 
       RowBox[{"1", "-", "c\[Phi]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kxs\[Phi]", "=", 
       RowBox[{"kx", "*", "s\[Phi]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kys\[Phi]", "=", 
       RowBox[{"ky", "*", "s\[Phi]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kzs\[Phi]", "=", 
       RowBox[{"kz", "*", "s\[Phi]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"kxy", "=", 
       RowBox[{"kx", "*", "ky", "*", "ominc\[Phi]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"kyz", "=", 
       RowBox[{"ky", "*", "kz", "*", "ominc\[Phi]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"kzx", "=", 
       RowBox[{"kz", "*", "kx", "*", "ominc\[Phi]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"kx", "*", "kx", "*", "ominc\[Phi]"}], "+", "c\[Phi]"}], 
           ",", 
           RowBox[{"kxy", "-", "kzs\[Phi]"}], ",", 
           RowBox[{"kzx", "+", "kys\[Phi]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"kxy", "+", "kzs\[Phi]"}], ",", 
           RowBox[{
            RowBox[{"ky", "*", "ky", "*", "ominc\[Phi]"}], "+", "c\[Phi]"}], 
           ",", 
           RowBox[{"kyz", "-", "kxs\[Phi]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"kzx", "-", "kys\[Phi]"}], ",", 
           RowBox[{"kyz", "+", "kxs\[Phi]"}], ",", 
           RowBox[{
            RowBox[{"kz", "*", "kz", "*", "ominc\[Phi]"}], "+", "c\[Phi]"}]}],
           "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "sol", "]"}], ";"}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.642645322822987*^9, 3.642645327928481*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"q0", "^", "2"}], "+", 
        RowBox[{"q1", "^", "2"}], "-", 
        RowBox[{"q2", "^", "2"}], "-", 
        RowBox[{"q3", "^", "2"}]}], ",", 
       RowBox[{
        RowBox[{"2", " ", "q1", " ", "q2"}], "-", 
        RowBox[{"2", " ", "q0", " ", "q3"}]}], ",", 
       RowBox[{
        RowBox[{"2", " ", "q1", " ", "q3"}], "+", 
        RowBox[{"2", " ", "q0", " ", "q2"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
        RowBox[{"2", " ", "q0", " ", "q3"}]}], ",", 
       RowBox[{
        RowBox[{"q0", "^", "2"}], "-", 
        RowBox[{"q1", "^", "2"}], "+", 
        RowBox[{"q2", "^", "2"}], "-", 
        RowBox[{"q3", "^", "2"}]}], ",", 
       RowBox[{
        RowBox[{"2", " ", "q2", " ", "q3"}], "-", 
        RowBox[{"2", " ", "q0", " ", "q1"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"2", " ", "q1", " ", "q3"}], "-", 
        RowBox[{"2", " ", "q0", " ", "q2"}]}], ",", 
       RowBox[{
        RowBox[{"2", " ", "q2", " ", "q3"}], "+", 
        RowBox[{"2", " ", "q0", " ", "q1"}]}], ",", 
       RowBox[{
        RowBox[{"q0", "^", "2"}], "-", 
        RowBox[{"q1", "^", "2"}], "-", 
        RowBox[{"q2", "^", "2"}], "+", 
        RowBox[{"q3", "^", "2"}]}]}], "}"}]}], "}"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"o2i", "=", 
  RowBox[{"{", 
   RowBox[{"6", ",", "8", ",", "7"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"o2f", "=", 
  RowBox[{"{", 
   RowBox[{"3", ",", "4", ",", "6"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"subsall", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r1", "\[Rule]", "2"}], ",", 
     RowBox[{"r2", "\[Rule]", "2.5"}], ",", 
     RowBox[{"l1", "\[Rule]", "12"}], ",", 
     RowBox[{"l2", "\[Rule]", "10"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inputi", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q0", "\[Rule]", "0"}], ",", 
     RowBox[{"q1", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"Sqrt", "[", "2", "]"}]}]}], ",", 
     RowBox[{"q2", "\[Rule]", "0"}], ",", 
     RowBox[{"q3", "\[Rule]", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"1", "/", "2"}]}], "]"}]}]}], "}"}]}], ";", 
  RowBox[{"inputf", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q0", "\[Rule]", "0"}], ",", 
     RowBox[{"q1", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"Sqrt", "[", "3", "]"}]}]}], ",", 
     RowBox[{"q2", "\[Rule]", "0"}], ",", 
     RowBox[{"q3", "\[Rule]", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"1", "/", "3"}]}], "]"}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.642645471996566*^9, 3.642645551175962*^9}, {
   3.642645669984379*^9, 3.64264567680339*^9}, 3.642646554032672*^9, {
   3.642646639821973*^9, 3.642646667855158*^9}, {3.64264710034086*^9, 
   3.642647130513014*^9}, {3.64264721277868*^9, 3.6426472314734383`*^9}, {
   3.6426473286652327`*^9, 3.642647337892061*^9}, {3.642647395948976*^9, 
   3.642647430589641*^9}, 3.642647494343193*^9, 3.642647532839644*^9, {
   3.642647896240438*^9, 3.642647907400909*^9}, 3.642647943366392*^9, {
   3.642647989564592*^9, 3.642647989754624*^9}, {3.642648113036812*^9, 
   3.642648138703401*^9}, 3.64265113046873*^9, 3.642651169218916*^9, 
   3.6426513640065393`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "8", ",", "7"}], "}"}]], "Output",
 CellChangeTimes->{{3.642645651330861*^9, 3.642645677745854*^9}, 
   3.642646557134676*^9, 3.642646646831352*^9, 3.642646685209096*^9, 
   3.642646734225309*^9, 3.642647135227598*^9, {3.642647213518602*^9, 
   3.642647232623324*^9}, 3.6426473391543417`*^9, {3.642647397597185*^9, 
   3.642647431647935*^9}, 3.64264749606863*^9, 3.642647535188807*^9, 
   3.642647909291306*^9, 3.642647946772729*^9, 3.642648071451647*^9, {
   3.64264811465204*^9, 3.6426481404551992`*^9}, {3.642648176692615*^9, 
   3.6426481827551126`*^9}, {3.6426482334428997`*^9, 3.642648247911211*^9}, 
   3.6426482811145153`*^9, {3.6426483123284483`*^9, 3.642648323672525*^9}, {
   3.6426483603893013`*^9, 3.642648402143107*^9}, 3.642648987917201*^9, 
   3.642651131928697*^9, 3.642651171848469*^9, 3.6426513670203876`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "4", ",", "6"}], "}"}]], "Output",
 CellChangeTimes->{{3.642645651330861*^9, 3.642645677745854*^9}, 
   3.642646557134676*^9, 3.642646646831352*^9, 3.642646685209096*^9, 
   3.642646734225309*^9, 3.642647135227598*^9, {3.642647213518602*^9, 
   3.642647232623324*^9}, 3.6426473391543417`*^9, {3.642647397597185*^9, 
   3.642647431647935*^9}, 3.64264749606863*^9, 3.642647535188807*^9, 
   3.642647909291306*^9, 3.642647946772729*^9, 3.642648071451647*^9, {
   3.64264811465204*^9, 3.6426481404551992`*^9}, {3.642648176692615*^9, 
   3.6426481827551126`*^9}, {3.6426482334428997`*^9, 3.642648247911211*^9}, 
   3.6426482811145153`*^9, {3.6426483123284483`*^9, 3.642648323672525*^9}, {
   3.6426483603893013`*^9, 3.642648402143107*^9}, 3.642648987917201*^9, 
   3.642651131928697*^9, 3.642651171848469*^9, 3.64265136702124*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Rnet", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"R", "/.", "inputi"}], "]"}], ".", 
    RowBox[{"(", 
     RowBox[{"R", "/.", "inputf"}], ")"}]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.642645337756723*^9, 3.6426453506008053`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", 
       SqrtBox["2"]}], "3"], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["1", "3"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "3"], ",", "0", ",", 
     FractionBox[
      RowBox[{"2", " ", 
       SqrtBox["2"]}], "3"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.642645657791666*^9, 3.64264567905552*^9}, 
   3.642646568842243*^9, 3.642646647002739*^9, 3.6426466852313833`*^9, 
   3.642646734245665*^9, 3.64264713527144*^9, {3.6426472236591387`*^9, 
   3.642647232655016*^9}, 3.6426473391866293`*^9, {3.64264739762388*^9, 
   3.642647431675*^9}, 3.642647496102131*^9, 3.6426475352231827`*^9, 
   3.642647909331724*^9, 3.642647946809834*^9, 3.6426480714641933`*^9, {
   3.6426481146817617`*^9, 3.6426481404821863`*^9}, {3.642648176717211*^9, 
   3.642648182772539*^9}, {3.642648233462646*^9, 3.64264824792933*^9}, 
   3.642648281137825*^9, {3.642648312359033*^9, 3.642648323688796*^9}, {
   3.642648360410948*^9, 3.6426484021750402`*^9}, 3.642648987933324*^9, 
   3.64265113196661*^9, 3.642651171880596*^9, 3.642651367055872*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"o2", "=", 
  RowBox[{"o2i", "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"o2f", "-", "o2i"}], ")"}], "*", "s"}]}]}]], "Input",
 CellChangeTimes->{{3.64264536097092*^9, 3.642645360971327*^9}, {
   3.6426456601725492`*^9, 3.6426456603678207`*^9}, 3.6426458348488483`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"6", "-", 
    RowBox[{"3", " ", "s"}]}], ",", 
   RowBox[{"8", "-", 
    RowBox[{"4", " ", "s"}]}], ",", 
   RowBox[{"7", "-", "s"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6426458353533907`*^9, 3.6426465689778357`*^9, 3.642646647021042*^9, 
   3.642646685254632*^9, 3.64264673426635*^9, 3.642647135308588*^9, {
   3.642647223690942*^9, 3.642647232685874*^9}, 3.6426473392149076`*^9, {
   3.642647397650683*^9, 3.642647431702174*^9}, 3.642647496136832*^9, 
   3.64264753525386*^9, 3.642647909373255*^9, 3.6426479468455143`*^9, 
   3.642648071477476*^9, {3.6426481147112923`*^9, 3.64264814050981*^9}, {
   3.642648176736671*^9, 3.642648182789665*^9}, {3.642648233478529*^9, 
   3.642648247954154*^9}, 3.6426482811606703`*^9, {3.6426483124026127`*^9, 
   3.6426483237027617`*^9}, {3.642648360431369*^9, 3.642648402208213*^9}, 
   3.6426489879474497`*^9, 3.6426511320023203`*^9, 3.642651171914781*^9, 
   3.6426513670892572`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"kphi", "=", 
  RowBox[{
   RowBox[{"rottoAxisAngle", "[", 
    RowBox[{"Rnet", ",", "k", ",", "\[Phi]"}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.642645379913877*^9, 3.642645379914123*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"k", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ",", 
   RowBox[{"\[Phi]", "\[Rule]", 
    RowBox[{"ArcCos", "[", 
     FractionBox[
      RowBox[{"2", " ", 
       SqrtBox["2"]}], "3"], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.642645685451289*^9, 3.642646569004567*^9, 3.642646647042242*^9, 
   3.642646685280216*^9, 3.64264673429*^9, 3.642647135357665*^9, {
   3.6426472237241583`*^9, 3.642647232715959*^9}, 3.6426473392587223`*^9, {
   3.642647397678833*^9, 3.6426474317379007`*^9}, 3.6426474961691523`*^9, 
   3.642647535288229*^9, 3.642647909408677*^9, 3.642647946880826*^9, 
   3.642648071491454*^9, {3.6426481147365007`*^9, 3.642648140538529*^9}, {
   3.642648176759819*^9, 3.642648182808782*^9}, {3.6426482334957237`*^9, 
   3.642648247976108*^9}, 3.6426482811854687`*^9, {3.6426483124282837`*^9, 
   3.642648323720798*^9}, {3.642648360453273*^9, 3.642648402240776*^9}, 
   3.6426489879621696`*^9, 3.6426511320383167`*^9, 3.642651171950119*^9, 
   3.642651367125703*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rots", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"axisAngletoRot", "[", 
     RowBox[{
      RowBox[{"k", "/.", "kphi"}], ",", 
      RowBox[{
       RowBox[{"\[Phi]", "*", "s"}], "/.", "kphi"}]}], "]"}], "/.", 
    "subsall"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6426453884102077`*^9, 3.642645388410461*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"s", " ", 
       RowBox[{"ArcCos", "[", 
        FractionBox[
         RowBox[{"2", " ", 
          SqrtBox["2"]}], "3"], "]"}]}], "]"}], ",", "0", ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       RowBox[{"s", " ", 
        RowBox[{"ArcCos", "[", 
         FractionBox[
          RowBox[{"2", " ", 
           SqrtBox["2"]}], "3"], "]"}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"s", " ", 
       RowBox[{"ArcCos", "[", 
        FractionBox[
         RowBox[{"2", " ", 
          SqrtBox["2"]}], "3"], "]"}]}], "]"}], ",", "0", ",", 
     RowBox[{"Cos", "[", 
      RowBox[{"s", " ", 
       RowBox[{"ArcCos", "[", 
        FractionBox[
         RowBox[{"2", " ", 
          SqrtBox["2"]}], "3"], "]"}]}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.642645686751584*^9, 3.6426465690413733`*^9, 3.642646647066987*^9, 
   3.642646685304954*^9, 3.642646734318777*^9, 3.6426471354522057`*^9, {
   3.6426472237591267`*^9, 3.642647232747813*^9}, 3.642647339326926*^9, {
   3.642647397706747*^9, 3.642647431742836*^9}, 3.642647496205504*^9, 
   3.642647535318572*^9, 3.642647909438468*^9, 3.642647946920179*^9, 
   3.642648071505721*^9, {3.642648114762394*^9, 3.6426481405698357`*^9}, {
   3.6426481767838907`*^9, 3.6426481828309593`*^9}, {3.6426482335159483`*^9, 
   3.642648248008647*^9}, 3.642648281205246*^9, {3.642648312432995*^9, 
   3.6426483237528353`*^9}, {3.642648360476261*^9, 3.6426484022714376`*^9}, 
   3.642648987993938*^9, 3.642651132074813*^9, 3.642651171985181*^9, 
   3.642651367173274*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Det", "[", 
   RowBox[{"rots", "/.", 
    RowBox[{"s", "\[Rule]", " ", "1"}]}], "]"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.642647631347377*^9, 3.642647649072427*^9}}],

Cell[BoxData["1.`"], "Output",
 CellChangeTimes->{{3.642647638925766*^9, 3.6426476494718523`*^9}, 
   3.642647909442177*^9, 3.642647946950679*^9, 3.6426480715171013`*^9, {
   3.6426481147659903`*^9, 3.6426481405743217`*^9}, {3.642648176804014*^9, 
   3.6426481828530807`*^9}, {3.642648233519538*^9, 3.642648248028308*^9}, 
   3.642648281226856*^9, {3.6426483124563513`*^9, 3.642648323771945*^9}, {
   3.64264836049584*^9, 3.642648402275311*^9}, 3.642648988016995*^9, 
   3.642651132111053*^9, 3.642651172020615*^9, 3.642651367216728*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Rs", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"R", "/.", "inputi"}], ")"}], ".", "rots"}], "/.", "subsall"}], 
   "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.642645397273796*^9, 3.642645414646351*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       RowBox[{"s", " ", 
        RowBox[{"ArcCos", "[", 
         FractionBox[
          RowBox[{"2", " ", 
           SqrtBox["2"]}], "3"], "]"}]}], "]"}]}], ",", "0", ",", 
     RowBox[{"-", 
      RowBox[{"Cos", "[", 
       RowBox[{"s", " ", 
        RowBox[{"ArcCos", "[", 
         FractionBox[
          RowBox[{"2", " ", 
           SqrtBox["2"]}], "3"], "]"}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", 
       RowBox[{"s", " ", 
        RowBox[{"ArcCos", "[", 
         FractionBox[
          RowBox[{"2", " ", 
           SqrtBox["2"]}], "3"], "]"}]}], "]"}]}], ",", "0", ",", 
     RowBox[{"Sin", "[", 
      RowBox[{"s", " ", 
       RowBox[{"ArcCos", "[", 
        FractionBox[
         RowBox[{"2", " ", 
          SqrtBox["2"]}], "3"], "]"}]}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.64264568963273*^9, 3.6426465690871162`*^9, 3.642646647093959*^9, 
   3.6426466853268423`*^9, 3.642646734371591*^9, 3.6426471356852303`*^9, {
   3.642647223795844*^9, 3.6426472327799807`*^9}, 3.642647339536851*^9, {
   3.6426473977344103`*^9, 3.6426474318212223`*^9}, 3.642647496236096*^9, 
   3.642647535350617*^9, 3.642647909472556*^9, 3.642647946981709*^9, 
   3.6426480715284443`*^9, {3.6426481147896023`*^9, 3.642648140602503*^9}, {
   3.642648176824814*^9, 3.642648182878396*^9}, {3.642648233536921*^9, 
   3.6426482480482616`*^9}, 3.6426482812502537`*^9, {3.6426483124773607`*^9, 
   3.642648323777269*^9}, {3.642648360515909*^9, 3.642648402303979*^9}, 
   3.64264898804498*^9, 3.642651132145808*^9, 3.6426511720573893`*^9, 
   3.6426513672582493`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"cylpath", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Graphics3D", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", "]"}], ",", 
        RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
        RowBox[{"Cylinder", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"o2", "/.", 
             RowBox[{"s", "\[Rule]", " ", "i"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"o2", "+", 
               RowBox[{"Rs", ".", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"l2", "/.", "subsall"}]}], "}"}]}]}], ")"}], "/.", 
             RowBox[{"s", "\[Rule]", " ", "i"}]}]}], "}"}], ",", 
          RowBox[{"r2", "/.", "subsall"}]}], "]"}]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "1", ",", ".05"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.642645817889677*^9, 3.642645896650765*^9}, {
   3.642645998787902*^9, 3.6426460049591827`*^9}, {3.642646109612718*^9, 
   3.6426461485535507`*^9}, {3.6426461852044783`*^9, 3.642646247533087*^9}, 
   3.642647188776773*^9, {3.642647381854102*^9, 3.6426473829242992`*^9}, {
   3.6426475514666147`*^9, 3.642647599229837*^9}, {3.642647917267248*^9, 
   3.642647931006422*^9}, {3.642648174430904*^9, 3.642648261712719*^9}, {
   3.6426483104960947`*^9, 3.6426483219885693`*^9}, {3.6426483587722397`*^9, 
   3.6426484002983427`*^9}, {3.642657073333108*^9, 3.6426570845360937`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cyl1", "=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Opacity", "[", "1", "]"}], ",", 
      RowBox[{"Cylinder", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"l1", "/.", "subsall"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"r1", "/.", "subsall"}]}], "]"}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.642646028960732*^9, 3.642646038068364*^9}, 
   3.6426473533134727`*^9, {3.64264827544701*^9, 3.64264830698561*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"cylpath", ",", "cyl1"}], "]"}]], "Input",
 CellChangeTimes->{{3.6426460569007196`*^9, 3.642646059635598*^9}, {
   3.6426461551026297`*^9, 3.642646173703578*^9}, {3.642646596807165*^9, 
   3.642646605289682*^9}, 3.642657070156356*^9}],

Cell[BoxData[
 Graphics3DBox[{
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{6., 8., 7.}, {-4., 8., 7.}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{5.85, 7.8, 6.95}, {-4.148556420670518, 7.8, 
     7.119910278289406}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{5.7, 7.6, 6.9}, {-4.294226099466324, 7.6, 
     7.23977150078569}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{5.55, 7.4, 6.85}, {-4.437010286619857, 7.4, 
     7.359534625858918}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{5.4, 7.2, 6.8}, {-4.576911065450767, 7.2, 
     7.4791506402014365`}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{5.25, 7., 6.75}, {-4.713931351764444, 7., 
     7.598570572978796}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{5.1, 6.8, 6.7}, {-4.848074893010162, 6.8, 
     7.7177455099684025`}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{4.95, 6.6, 6.65}, {-4.97934626719914, 6.6, 
     7.836626607681836}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{4.8, 6.4, 6.6}, {-5.107750881582796, 6.4, 
     7.955165107466737}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{4.65, 6.2, 6.55}, {-5.233294971091587, 6.2, 
     8.073312349584203}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{4.5, 6., 6.5}, {-5.355985596534888, 6., 8.191019787257627}},
      2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{4.35, 5.8, 6.45}, {-5.4758306425624195`, 5.8, 
     8.308239000688927}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{4.199999999999999, 5.6, 6.4}, {-5.592838815387832, 5.6, 
     8.424921711038099}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{4.05, 5.4, 6.35}, {-5.707019640275072, 5.4, 
     8.541019794362093}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{3.9, 5.199999999999999, 6.3}, {-5.818383458788299, 
     5.199999999999999, 8.656485295508963}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{3.75, 5., 6.25}, {-5.926941425806108, 5., 
     8.771270441963267}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{3.5999999999999996`, 4.8, 6.2}, {-6.032705506300934, 4.8, 
     8.885327657638761}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{3.4499999999999997`, 4.6, 6.15}, {-6.135688471884581, 4.6, 
     8.998609576614365}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{3.3, 4.4, 6.1}, {-6.235903897120852, 4.4, 
     9.111069056809452}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{3.15, 4.199999999999999, 6.05}, {-6.333366155606358, 
     4.199999999999999, 9.22265919359453}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{3., 4., 6.}, {-6.428090415820634, 4., 9.333333333333334}}, 
     2.5]}, 
   {Opacity[1], CylinderBox[{{0, 0, 0}, {0, 0, 12}}, 2]}},
  ImageSize->{360., 328.97221165853364`},
  ViewPoint->{1.6303562717436761`, -1.4517247132133184`, 2.5854271956935433`},
  
  ViewVertical->{0.30158638692145084`, -0.18018214489453835`, 
   1.036811651646476}]], "Output",
 CellChangeTimes->{
  3.6426460603398523`*^9, {3.642646126066227*^9, 3.642646249843034*^9}, 
   3.6426465691351337`*^9, 3.642646605731296*^9, 3.642646647158869*^9, 
   3.642646685367402*^9, 3.642646734488778*^9, 3.64264713573138*^9, {
   3.642647198304188*^9, 3.6426472328187943`*^9}, {3.642647339579596*^9, 
   3.642647354970134*^9}, {3.642647385883608*^9, 3.642647431868792*^9}, 
   3.642647496274706*^9, {3.642647535397897*^9, 3.642647601678555*^9}, {
   3.6426479095197983`*^9, 3.642647947059229*^9}, 3.642648071555299*^9, {
   3.6426481149198103`*^9, 3.642648140639916*^9}, {3.642648176873476*^9, 
   3.642648182927479*^9}, {3.642648233574751*^9, 3.642648248083823*^9}, 
   3.642648281290103*^9, {3.642648312523035*^9, 3.642648323814822*^9}, {
   3.642648360551671*^9, 3.642648402347637*^9}, 3.6426489880801563`*^9, 
   3.642651132199888*^9, 3.64265117211668*^9, 3.642651367311049*^9, {
   3.64265707077955*^9, 3.642657086883704*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"%635", ",", 
   RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 Graphics3DBox[{
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{6., 8., 7.}, {-4., 8., 7.}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{5.85, 7.8, 6.95}, {-4.148556420670518, 7.8, 
     7.119910278289406}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{5.7, 7.6, 6.9}, {-4.294226099466324, 7.6, 
     7.23977150078569}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{5.55, 7.4, 6.85}, {-4.437010286619857, 7.4, 
     7.359534625858918}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{5.4, 7.2, 6.8}, {-4.576911065450767, 7.2, 
     7.4791506402014365`}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{5.25, 7., 6.75}, {-4.713931351764444, 7., 
     7.598570572978796}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{5.1, 6.8, 6.7}, {-4.848074893010162, 6.8, 
     7.7177455099684025`}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{4.95, 6.6, 6.65}, {-4.97934626719914, 6.6, 
     7.836626607681836}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{4.8, 6.4, 6.6}, {-5.107750881582796, 6.4, 
     7.955165107466737}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{4.65, 6.2, 6.55}, {-5.233294971091587, 6.2, 
     8.073312349584203}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{4.5, 6., 6.5}, {-5.355985596534888, 6., 8.191019787257627}},
      2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{4.35, 5.8, 6.45}, {-5.4758306425624195`, 5.8, 
     8.308239000688927}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{4.199999999999999, 5.6, 6.4}, {-5.592838815387832, 5.6, 
     8.424921711038099}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{4.05, 5.4, 6.35}, {-5.707019640275072, 5.4, 
     8.541019794362093}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{3.9, 5.199999999999999, 6.3}, {-5.818383458788299, 
     5.199999999999999, 8.656485295508963}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{3.75, 5., 6.25}, {-5.926941425806108, 5., 
     8.771270441963267}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{3.5999999999999996`, 4.8, 6.2}, {-6.032705506300934, 4.8, 
     8.885327657638761}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{3.4499999999999997`, 4.6, 6.15}, {-6.135688471884581, 4.6, 
     8.998609576614365}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{3.3, 4.4, 6.1}, {-6.235903897120852, 4.4, 
     9.111069056809452}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{3.15, 4.199999999999999, 6.05}, {-6.333366155606358, 
     4.199999999999999, 9.22265919359453}}, 2.5]}, 
   {Opacity[0.3], EdgeForm[None], 
    CylinderBox[{{3., 4., 6.}, {-6.428090415820634, 4., 9.333333333333334}}, 
     2.5]}, 
   {Opacity[1], CylinderBox[{{0, 0, 0}, {0, 0, 12}}, 2]}},
  Boxed->False,
  ImageSize->{360., 376.1252341917772},
  ViewPoint->{2.6175800908700575`, 0.2760503771982642, 2.1265160843806},
  ViewVertical->{0.02404058178585977, 0.5739433993851979, 
   0.9290573395314853}]], "Output",
 CellChangeTimes->{3.642657091051811*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"cylpath", ",", "cyl1", ",", 
   RowBox[{"Axes", "\[Rule]", " ", "True"}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "\[Infinity]", ",", "0"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{3.6426483450937767`*^9}],

Cell[BoxData[
 Graphics3DBox[{
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{6., 8., 7.}, {-4., 8., 7.}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.85, 7.8, 6.95}, {-4.148556420670518, 7.8, 
     7.119910278289406}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.7, 7.6, 6.9}, {-4.294226099466324, 7.6, 
     7.23977150078569}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.55, 7.4, 6.85}, {-4.437010286619857, 7.4, 
     7.359534625858918}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.4, 7.2, 6.8}, {-4.576911065450767, 7.2, 
     7.4791506402014365`}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.25, 7., 6.75}, {-4.713931351764444, 7., 
     7.598570572978796}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.1, 6.8, 6.7}, {-4.848074893010162, 6.8, 
     7.7177455099684025`}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.95, 6.6, 6.65}, {-4.97934626719914, 6.6, 
     7.836626607681836}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.8, 6.4, 6.6}, {-5.107750881582796, 6.4, 
     7.955165107466737}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.65, 6.2, 6.55}, {-5.233294971091587, 6.2, 
     8.073312349584203}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.5, 6., 6.5}, {-5.355985596534888, 6., 8.191019787257627}},
      2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.35, 5.8, 6.45}, {-5.4758306425624195`, 5.8, 
     8.308239000688927}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.199999999999999, 5.6, 6.4}, {-5.592838815387832, 5.6, 
     8.424921711038099}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.05, 5.4, 6.35}, {-5.707019640275072, 5.4, 
     8.541019794362093}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.9, 5.199999999999999, 6.3}, {-5.818383458788299, 
     5.199999999999999, 8.656485295508963}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.75, 5., 6.25}, {-5.926941425806108, 5., 
     8.771270441963267}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.5999999999999996`, 4.8, 6.2}, {-6.032705506300934, 4.8, 
     8.885327657638761}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.4499999999999997`, 4.6, 6.15}, {-6.135688471884581, 4.6, 
     8.998609576614365}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.3, 4.4, 6.1}, {-6.235903897120852, 4.4, 
     9.111069056809452}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.15, 4.199999999999999, 6.05}, {-6.333366155606358, 
     4.199999999999999, 9.22265919359453}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3., 4., 6.}, {-6.428090415820634, 4., 9.333333333333334}}, 
     2.5]}, 
   {Opacity[1], CylinderBox[{{0, 0, 0}, {0, 0, 12}}, 2]}},
  Axes->True,
  ImageSize->{360., 328.49486922031014`},
  ViewPoint->{0, 
    DirectedInfinity[1], 0},
  ViewVertical->{-0.0864984550438813, -0.24098383180848731`, 
   1.7362352279001911`}]], "Output",
 CellChangeTimes->{{3.642648345861308*^9, 3.6426484023936*^9}, 
   3.6426489881121483`*^9, 3.642651132248192*^9, 3.642651172167327*^9, 
   3.642651367358569*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"cylpath", ",", "cyl1", ",", 
   RowBox[{"Axes", "\[Rule]", " ", "True"}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"-", "\[Infinity]"}], ",", "0"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{3.642648056707471*^9}],

Cell[BoxData[
 Graphics3DBox[{
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{6., 8., 7.}, {-4., 8., 7.}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.85, 7.8, 6.95}, {-4.148556420670518, 7.8, 
     7.119910278289406}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.7, 7.6, 6.9}, {-4.294226099466324, 7.6, 
     7.23977150078569}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.55, 7.4, 6.85}, {-4.437010286619857, 7.4, 
     7.359534625858918}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.4, 7.2, 6.8}, {-4.576911065450767, 7.2, 
     7.4791506402014365`}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.25, 7., 6.75}, {-4.713931351764444, 7., 
     7.598570572978796}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.1, 6.8, 6.7}, {-4.848074893010162, 6.8, 
     7.7177455099684025`}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.95, 6.6, 6.65}, {-4.97934626719914, 6.6, 
     7.836626607681836}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.8, 6.4, 6.6}, {-5.107750881582796, 6.4, 
     7.955165107466737}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.65, 6.2, 6.55}, {-5.233294971091587, 6.2, 
     8.073312349584203}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.5, 6., 6.5}, {-5.355985596534888, 6., 8.191019787257627}},
      2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.35, 5.8, 6.45}, {-5.4758306425624195`, 5.8, 
     8.308239000688927}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.199999999999999, 5.6, 6.4}, {-5.592838815387832, 5.6, 
     8.424921711038099}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.05, 5.4, 6.35}, {-5.707019640275072, 5.4, 
     8.541019794362093}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.9, 5.199999999999999, 6.3}, {-5.818383458788299, 
     5.199999999999999, 8.656485295508963}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.75, 5., 6.25}, {-5.926941425806108, 5., 
     8.771270441963267}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.5999999999999996`, 4.8, 6.2}, {-6.032705506300934, 4.8, 
     8.885327657638761}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.4499999999999997`, 4.6, 6.15}, {-6.135688471884581, 4.6, 
     8.998609576614365}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.3, 4.4, 6.1}, {-6.235903897120852, 4.4, 
     9.111069056809452}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.15, 4.199999999999999, 6.05}, {-6.333366155606358, 
     4.199999999999999, 9.22265919359453}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3., 4., 6.}, {-6.428090415820634, 4., 9.333333333333334}}, 
     2.5]}, 
   {Opacity[1], CylinderBox[{{0, 0, 0}, {0, 0, 12}}, 2]}},
  Axes->True,
  ViewPoint->{0, 
    DirectedInfinity[-1], 0}]], "Output",
 CellChangeTimes->{
  3.642648071617415*^9, {3.642648114933378*^9, 3.642648140654192*^9}, {
   3.642648176981059*^9, 3.6426481829868*^9}, {3.642648233688637*^9, 
   3.642648248147916*^9}, 3.6426482813532143`*^9, {3.642648312559578*^9, 
   3.6426483238660192`*^9}, {3.6426483606535397`*^9, 3.642648402442293*^9}, 
   3.64264898815421*^9, 3.642651132291638*^9, 3.642651172208667*^9, 
   3.64265136739256*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"cylpath", ",", "cyl1", ",", 
   RowBox[{"Axes", "\[Rule]", " ", "True"}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "\[Infinity]"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.642648064299212*^9, 3.64264806855688*^9}}],

Cell[BoxData[
 Graphics3DBox[{
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{6., 8., 7.}, {-4., 8., 7.}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.85, 7.8, 6.95}, {-4.148556420670518, 7.8, 
     7.119910278289406}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.7, 7.6, 6.9}, {-4.294226099466324, 7.6, 
     7.23977150078569}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.55, 7.4, 6.85}, {-4.437010286619857, 7.4, 
     7.359534625858918}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.4, 7.2, 6.8}, {-4.576911065450767, 7.2, 
     7.4791506402014365`}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.25, 7., 6.75}, {-4.713931351764444, 7., 
     7.598570572978796}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.1, 6.8, 6.7}, {-4.848074893010162, 6.8, 
     7.7177455099684025`}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.95, 6.6, 6.65}, {-4.97934626719914, 6.6, 
     7.836626607681836}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.8, 6.4, 6.6}, {-5.107750881582796, 6.4, 
     7.955165107466737}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.65, 6.2, 6.55}, {-5.233294971091587, 6.2, 
     8.073312349584203}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.5, 6., 6.5}, {-5.355985596534888, 6., 8.191019787257627}},
      2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.35, 5.8, 6.45}, {-5.4758306425624195`, 5.8, 
     8.308239000688927}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.199999999999999, 5.6, 6.4}, {-5.592838815387832, 5.6, 
     8.424921711038099}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.05, 5.4, 6.35}, {-5.707019640275072, 5.4, 
     8.541019794362093}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.9, 5.199999999999999, 6.3}, {-5.818383458788299, 
     5.199999999999999, 8.656485295508963}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.75, 5., 6.25}, {-5.926941425806108, 5., 
     8.771270441963267}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.5999999999999996`, 4.8, 6.2}, {-6.032705506300934, 4.8, 
     8.885327657638761}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.4499999999999997`, 4.6, 6.15}, {-6.135688471884581, 4.6, 
     8.998609576614365}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.3, 4.4, 6.1}, {-6.235903897120852, 4.4, 
     9.111069056809452}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.15, 4.199999999999999, 6.05}, {-6.333366155606358, 
     4.199999999999999, 9.22265919359453}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3., 4., 6.}, {-6.428090415820634, 4., 9.333333333333334}}, 
     2.5]}, 
   {Opacity[1], CylinderBox[{{0, 0, 0}, {0, 0, 12}}, 2]}},
  Axes->True,
  ViewPoint->{0, 0, 
    DirectedInfinity[1]}]], "Output",
 CellChangeTimes->{
  3.642648071655919*^9, {3.642648114947433*^9, 3.642648140667803*^9}, {
   3.642648177020317*^9, 3.6426481830251417`*^9}, {3.6426482337295113`*^9, 
   3.6426482481882544`*^9}, 3.642648281394526*^9, {3.6426483125973454`*^9, 
   3.642648323901189*^9}, {3.642648360685907*^9, 3.642648402476293*^9}, 
   3.6426489881839933`*^9, 3.642651132321911*^9, 3.642651172237013*^9, 
   3.642651367431924*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"cylpath", ",", "cyl1", ",", 
   RowBox[{"Axes", "\[Rule]", " ", "True"}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\[Infinity]", ",", "0", ",", "0"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6426490390604563`*^9, 3.642649042202279*^9}}],

Cell[BoxData[
 Graphics3DBox[{
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{6., 8., 7.}, {-4., 8., 7.}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.85, 7.8, 6.95}, {-4.148556420670518, 7.8, 
     7.119910278289406}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.7, 7.6, 6.9}, {-4.294226099466324, 7.6, 
     7.23977150078569}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.55, 7.4, 6.85}, {-4.437010286619857, 7.4, 
     7.359534625858918}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.4, 7.2, 6.8}, {-4.576911065450767, 7.2, 
     7.4791506402014365`}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.25, 7., 6.75}, {-4.713931351764444, 7., 
     7.598570572978796}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{5.1, 6.8, 6.7}, {-4.848074893010162, 6.8, 
     7.7177455099684025`}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.95, 6.6, 6.65}, {-4.97934626719914, 6.6, 
     7.836626607681836}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.8, 6.4, 6.6}, {-5.107750881582796, 6.4, 
     7.955165107466737}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.65, 6.2, 6.55}, {-5.233294971091587, 6.2, 
     8.073312349584203}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.5, 6., 6.5}, {-5.355985596534888, 6., 8.191019787257627}},
      2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.35, 5.8, 6.45}, {-5.4758306425624195`, 5.8, 
     8.308239000688927}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.199999999999999, 5.6, 6.4}, {-5.592838815387832, 5.6, 
     8.424921711038099}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{4.05, 5.4, 6.35}, {-5.707019640275072, 5.4, 
     8.541019794362093}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.9, 5.199999999999999, 6.3}, {-5.818383458788299, 
     5.199999999999999, 8.656485295508963}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.75, 5., 6.25}, {-5.926941425806108, 5., 
     8.771270441963267}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.5999999999999996`, 4.8, 6.2}, {-6.032705506300934, 4.8, 
     8.885327657638761}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.4499999999999997`, 4.6, 6.15}, {-6.135688471884581, 4.6, 
     8.998609576614365}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.3, 4.4, 6.1}, {-6.235903897120852, 4.4, 
     9.111069056809452}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3.15, 4.199999999999999, 6.05}, {-6.333366155606358, 
     4.199999999999999, 9.22265919359453}}, 2.5]}, 
   {Opacity[0.1], EdgeForm[None], 
    CylinderBox[{{3., 4., 6.}, {-6.428090415820634, 4., 9.333333333333334}}, 
     2.5]}, 
   {Opacity[1], CylinderBox[{{0, 0, 0}, {0, 0, 12}}, 2]}},
  Axes->True,
  ViewPoint->{
    DirectedInfinity[1], 0, 0}]], "Output",
 CellChangeTimes->{3.642649042972982*^9, 3.642651132357937*^9, 
  3.6426511722684383`*^9, 3.64265136746982*^9}]
}, Open  ]]
},
WindowSize->{1855, 1056},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
CellContext->Notebook,
FrontEndVersion->"10.0 for Linux x86 (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 6788, 184, 539, "Input"],
Cell[7349, 206, 1479, 43, 32, "Input"],
Cell[CellGroupData[{
Cell[8853, 253, 2039, 51, 121, "Input"],
Cell[10895, 306, 877, 13, 32, "Output"],
Cell[11775, 321, 874, 13, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12686, 339, 302, 8, 32, "Input"],
Cell[12991, 349, 1254, 28, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14282, 382, 297, 7, 32, "Input"],
Cell[14582, 391, 983, 19, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15602, 415, 238, 6, 32, "Input"],
Cell[15843, 423, 1099, 23, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16979, 451, 351, 10, 32, "Input"],
Cell[17333, 463, 1764, 45, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19134, 513, 210, 5, 32, "Input"],
Cell[19347, 520, 537, 7, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19921, 532, 269, 8, 32, "Input"],
Cell[20193, 542, 1845, 48, 55, "Output"]
}, Open  ]],
Cell[22053, 593, 1559, 35, 32, "Input"],
Cell[23615, 630, 688, 19, 32, "Input"],
Cell[CellGroupData[{
Cell[24328, 653, 281, 5, 32, "Input"],
Cell[24612, 660, 4055, 83, 344, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28704, 748, 142, 4, 32, "Input"],
Cell[28849, 754, 3159, 70, 391, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32045, 829, 303, 7, 32, "Input"],
Cell[32351, 838, 3257, 73, 343, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35645, 916, 323, 8, 32, "Input"],
Cell[35971, 926, 3374, 74, 343, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39382, 1005, 324, 7, 32, "Input"],
Cell[39709, 1014, 3381, 74, 356, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43127, 1093, 327, 7, 32, "Input"],
Cell[43457, 1102, 3078, 69, 358, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
