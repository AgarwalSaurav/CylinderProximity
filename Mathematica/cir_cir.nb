(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     97942,       2451]
NotebookOptionsPosition[     94699,       2342]
NotebookOutlinePosition[     95179,       2360]
CellTagsIndexPosition[     95136,       2357]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
(*
Programme for finding the least distance (i.e., finding the proximity) \
between two finite circles
*)\[LineSeparator]\
\>", "Input",
 Evaluatable->False,
 CellChangeTimes->{
  3.558075401021812*^9, {3.558075433176977*^9, 3.55807549337778*^9}, 
   3.5580756045375433`*^9, {3.5698304191010246`*^9, 3.569830422737232*^9}, {
   3.5704370724730587`*^9, 3.570437074084151*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "define", " ", "the", " ", "first", " ", "circle", " ", "in", " ", "its", 
    " ", "local", " ", "frame", " ", "of", " ", "reference"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", " ", "y1"}], "}"}], " ", "=", " ", 
     RowBox[{"r1", " ", "*", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]1", "]"}], ",", " ", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z1", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "define", " ", "a", " ", "point", " ", "on", " ", "the", " ", "circle"}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"p1", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.558073458170795*^9, 3.558073553293523*^9}, {
   3.55807371917924*^9, 3.5580737362448263`*^9}, {3.558096992182033*^9, 
   3.558096992876449*^9}, {3.5580976551705437`*^9, 3.5580976563218107`*^9}, 
   3.5580976996167173`*^9, {3.558098725578822*^9, 3.5580987512630997`*^9}, {
   3.558142950725593*^9, 3.558142991505747*^9}, {3.5587083423965797`*^9, 
   3.558708342701953*^9}, 3.5587084020411243`*^9, {3.55877071174793*^9, 
   3.558770719365891*^9}, 3.558771208567287*^9, {3.558772402537244*^9, 
   3.5587724069393177`*^9}, {3.558773240379507*^9, 3.558773272034829*^9}, 
   3.5587750721059427`*^9, {3.558781569802609*^9, 3.55878158664182*^9}, {
   3.558786957930822*^9, 3.558786962508292*^9}, {3.55882511647033*^9, 
   3.558825117438373*^9}, 3.558837829436367*^9, {3.569927171334296*^9, 
   3.569927173458418*^9}, {3.5700732267759724`*^9, 3.570073227070989*^9}, {
   3.5704370763072777`*^9, 3.5704370795484633`*^9}, {3.5721276576811333`*^9, 
   3.572127660405289*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"r1", " ", 
    RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], ",", 
   RowBox[{"r1", " ", 
    RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.558075673827717*^9, 3.5580757139613857`*^9, 3.558080377378187*^9, 
   3.558096993681979*^9, {3.558097678077073*^9, 3.558097703009056*^9}, 
   3.558098752910901*^9, 3.558175433811019*^9, 3.558707265456934*^9, 
   3.55870834372339*^9, 3.558708407063963*^9, 3.55875370056467*^9, 
   3.558770727019174*^9, 3.558771243339748*^9, 3.558772407676833*^9, 
   3.558772789318028*^9, {3.558773257479459*^9, 3.55877327314431*^9}, 
   3.558775073047317*^9, 3.55878159636373*^9, 3.558786966507745*^9, 
   3.558787027180826*^9, 3.5588251188342113`*^9, 3.558837832630258*^9, 
   3.5698297915661316`*^9, 3.56992719849985*^9, 3.5699272525909433`*^9, 
   3.5699385543023643`*^9, {3.570073218711511*^9, 3.5700732273030024`*^9}, 
   3.5701662789166136`*^9, 3.5720781787450943`*^9, 3.572127479879964*^9, 
   3.5721594710732636`*^9, 3.57216004901632*^9, 3.572160710314144*^9, 
   3.572319964764612*^9, 3.5723211166534967`*^9, 3.5724881837766953`*^9, 
   3.5749754053141165`*^9, 3.5811691242300525`*^9, 3.581169155234826*^9, 
   3.5811695091620693`*^9, 3.581169552396542*^9, 3.581169663670907*^9, 
   3.5811697093445187`*^9, 3.581169802837867*^9, 3.581170279217114*^9, 
   3.5811703408176374`*^9, 3.581170372392443*^9, 3.5811705250431747`*^9, 
   3.581473371262407*^9, 3.5814739449422197`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "define", " ", "the", " ", "second", " ", "circle", " ", "likewise"}], " ",
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x2", ",", " ", "y2"}], "}"}], " ", "=", " ", 
     RowBox[{"r2", " ", "*", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]2", "]"}], ",", " ", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z2", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "take", " ", "the", " ", "second", " ", "circle", " ", "to", " ", "a", 
     " ", "generic", " ", "configuration"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"define", " ", "the", " ", "orientation"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"q0", "^", "2"}], "+", 
          RowBox[{"q1", "^", "2"}], "-", 
          RowBox[{"q2", "^", "2"}], "-", 
          RowBox[{"q3", "^", "2"}]}], ",", 
         RowBox[{
          RowBox[{"2", " ", "q1", " ", "q2"}], "-", 
          RowBox[{"2", " ", "q0", " ", "q3"}]}], ",", 
         RowBox[{
          RowBox[{"2", " ", "q1", " ", "q3"}], "+", 
          RowBox[{"2", " ", "q0", " ", "q2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
          RowBox[{"2", " ", "q0", " ", "q3"}]}], ",", 
         RowBox[{
          RowBox[{"q0", "^", "2"}], "-", 
          RowBox[{"q1", "^", "2"}], "+", 
          RowBox[{"q2", "^", "2"}], "-", 
          RowBox[{"q3", "^", "2"}]}], ",", 
         RowBox[{
          RowBox[{"2", " ", "q2", " ", "q3"}], "-", 
          RowBox[{"2", "q0", " ", "q1"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", "q1", " ", "q3"}], "-", 
          RowBox[{"2", " ", "q0", " ", "q2"}]}], ",", 
         RowBox[{
          RowBox[{"2", "q2", " ", "q3"}], "+", 
          RowBox[{"2", " ", "q0", " ", "q1"}]}], ",", " ", 
         RowBox[{
          RowBox[{"q0", "^", "2"}], "-", 
          RowBox[{"q1", "^", "2"}], "-", 
          RowBox[{"q2", "^", "2"}], "+", 
          RowBox[{"q3", "^", "2"}]}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"const1", "=", 
     RowBox[{
      RowBox[{"q0", "^", "2"}], "+", 
      RowBox[{"q1", "^", "2"}], "+", 
      RowBox[{"q2", "^", "2"}], "+", 
      RowBox[{"q3", "^", "2"}], "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "R", "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "define", " ", "the", " ", "position", " ", "of", " ", "the", " ", 
     "\"\<origin\>\""}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"tx", ",", " ", "ty", ",", " ", "tz"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "define", " ", "a", " ", "point", " ", "on", " ", "the", " ", "second", 
      " ", "circle"}], ",", " ", 
     RowBox[{
     "expressed", " ", "in", " ", "the", " ", "frame", " ", "of", " ", 
      "reference", " ", "of", " ", "the", " ", "first", " ", "circle"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"p2", " ", "=", " ", 
    RowBox[{"t", " ", "+", " ", 
     RowBox[{"R", ".", 
      RowBox[{"{", 
       RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], "}"}]}]}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.558073458170795*^9, 3.558073709507827*^9}, {
   3.558073740454792*^9, 3.5580738049933653`*^9}, 3.558082148926989*^9, {
   3.558096355912854*^9, 3.55809635695401*^9}, {3.558096434825989*^9, 
   3.5580964407635508`*^9}, {3.558096566201684*^9, 3.558096566383749*^9}, 
   3.5580968035030537`*^9, {3.558143008551819*^9, 3.5581430129027843`*^9}, {
   3.558221056875045*^9, 3.558221058367564*^9}, {3.558707871191598*^9, 
   3.5587080532057667`*^9}, {3.558708086242559*^9, 3.558708138196657*^9}, {
   3.5587081864836493`*^9, 3.558708197922638*^9}, {3.5587082919003572`*^9, 
   3.558708296868143*^9}, 3.558708403965981*^9, {3.558770730864664*^9, 
   3.5587707355707817`*^9}, 3.558771211427903*^9, {3.558772411253378*^9, 
   3.5587724139794683`*^9}, {3.558773268116036*^9, 3.558773271162249*^9}, 
   3.558775076077957*^9, {3.558781591525593*^9, 3.558781593321697*^9}, {
   3.558787035778143*^9, 3.558787038400735*^9}, {3.558825124510339*^9, 
   3.5588251252333527`*^9}, 3.5588378353835907`*^9, {3.569927177715661*^9, 
   3.5699271801337996`*^9}, {3.5700732299571543`*^9, 3.57007323005216*^9}, {
   3.5704370815725794`*^9, 3.570437091662156*^9}, {3.5720781698925877`*^9, 
   3.5720781702906103`*^9}, 3.5721274743676486`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q1", "2"], "-", 
       SuperscriptBox["q2", "2"], "-", 
       SuperscriptBox["q3", "2"]}], 
      RowBox[{
       RowBox[{"2", " ", "q1", " ", "q2"}], "-", 
       RowBox[{"2", " ", "q0", " ", "q3"}]}], 
      RowBox[{
       RowBox[{"2", " ", "q0", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q1", " ", "q3"}]}]},
     {
      RowBox[{
       RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q0", " ", "q3"}]}], 
      RowBox[{
       SuperscriptBox["q0", "2"], "-", 
       SuperscriptBox["q1", "2"], "+", 
       SuperscriptBox["q2", "2"], "-", 
       SuperscriptBox["q3", "2"]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q0", " ", "q1"}], "+", 
       RowBox[{"2", " ", "q2", " ", "q3"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q0", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q1", " ", "q3"}]}], 
      RowBox[{
       RowBox[{"2", " ", "q0", " ", "q1"}], "+", 
       RowBox[{"2", " ", "q2", " ", "q3"}]}], 
      RowBox[{
       SuperscriptBox["q0", "2"], "-", 
       SuperscriptBox["q1", "2"], "-", 
       SuperscriptBox["q2", "2"], "+", 
       SuperscriptBox["q3", "2"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.570166280731717*^9, 3.572078179851157*^9, 
  3.5721274809860272`*^9, 3.572159472248331*^9, 3.5721600531895585`*^9, 
  3.572160711307201*^9, 3.5723199659066772`*^9, 3.572321117610551*^9, 
  3.572488185188776*^9, 3.574975405370119*^9, 3.5811691253001137`*^9, 
  3.5811691558858633`*^9, 3.581169509805106*^9, 3.581169552992576*^9, 
  3.581169664549957*^9, 3.5811697099955564`*^9, 3.581169803461902*^9, 
  3.5811702798051476`*^9, 3.5811703414286723`*^9, 3.58117037303648*^9, 
  3.581170526049232*^9, 3.5814733719014435`*^9, 3.5814739455992575`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"tx", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q1", "2"], "-", 
       SuperscriptBox["q2", "2"], "-", 
       SuperscriptBox["q3", "2"]}], ")"}], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q1", " ", "q2"}], "-", 
       RowBox[{"2", " ", "q0", " ", "q3"}]}], ")"}], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
   RowBox[{"ty", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q0", " ", "q3"}]}], ")"}], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "-", 
       SuperscriptBox["q1", "2"], "+", 
       SuperscriptBox["q2", "2"], "-", 
       SuperscriptBox["q3", "2"]}], ")"}], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", 
   RowBox[{"tz", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q0", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q1", " ", "q3"}]}], ")"}], " ", "r2", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q0", " ", "q1"}], "+", 
       RowBox[{"2", " ", "q2", " ", "q3"}]}], ")"}], " ", "r2", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.570166280731717*^9, 3.572078179851157*^9, 
  3.5721274809860272`*^9, 3.572159472248331*^9, 3.5721600531895585`*^9, 
  3.572160711307201*^9, 3.5723199659066772`*^9, 3.572321117610551*^9, 
  3.572488185188776*^9, 3.574975405370119*^9, 3.5811691253001137`*^9, 
  3.5811691558858633`*^9, 3.581169509805106*^9, 3.581169552992576*^9, 
  3.581169664549957*^9, 3.5811697099955564`*^9, 3.581169803461902*^9, 
  3.5811702798051476`*^9, 3.5811703414286723`*^9, 3.58117037303648*^9, 
  3.581170526049232*^9, 3.5814733719014435`*^9, 3.581473945617258*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"algvars", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "c1", ",", " ", "c2", ",", " ", "c3", ",", " ", "r1", ",", " ", "r2", 
       ",", " ", "l1", ",", " ", "l2", ",", " ", "tx", ",", " ", "ty", ",", 
       " ", "tz"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"size", "[", "x_", "]"}], " ", ":=", "  ", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Size of the expression is:\>\"", ",", " ", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"ByteCount", "[", "x", "]"}], "/", "1000"}], "]"}], ",", 
       "  ", "\"\< KB.\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "define", " ", "the", " ", "distance", " ", "between", " ", "p1"}], ",", 
     " ", "p2"}], " ", "*)"}], "\n", 
   RowBox[{"d", " ", "=", " ", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"Numerator", "[", 
       RowBox[{"Together", "[", 
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p1", " ", "-", " ", "p2"}], ")"}], ".", " ", 
          RowBox[{"(", 
           RowBox[{"p1", " ", "-", " ", "p2"}], ")"}]}], "]"}], "]"}], "]"}], 
      ",", "algvars", " ", ",", " ", "FullSimplify"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"size", "[", "d", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.558074291890336*^9, 3.5580743032330713`*^9}, 
   3.5721274900055428`*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["r1", "2"], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["q0", "2"], "+", 
      SuperscriptBox["q1", "2"], "+", 
      SuperscriptBox["q2", "2"], "+", 
      SuperscriptBox["q3", "2"]}], ")"}], "2"], " ", 
   SuperscriptBox["r2", "2"]}], "+", 
  SuperscriptBox["tx", "2"], "+", 
  SuperscriptBox["ty", "2"], "+", 
  SuperscriptBox["tz", "2"], "+", 
  RowBox[{"r2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"tx", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["q0", "2"], "+", 
           SuperscriptBox["q1", "2"], "-", 
           SuperscriptBox["q2", "2"], "-", 
           SuperscriptBox["q3", "2"]}], ")"}], " ", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", " ", "q2"}], "-", 
           RowBox[{"q0", " ", "q3"}]}], ")"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}], "+", 
     RowBox[{"4", " ", "tz", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "q0"}], " ", "q2"}], "+", 
           RowBox[{"q1", " ", "q3"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q0", " ", "q1"}], "+", 
           RowBox[{"q2", " ", "q3"}]}], ")"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}], "+", 
     RowBox[{"ty", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", " ", "q2"}], "+", 
           RowBox[{"q0", " ", "q3"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["q0", "2"], "-", 
           SuperscriptBox["q1", "2"], "+", 
           SuperscriptBox["q2", "2"], "-", 
           SuperscriptBox["q3", "2"]}], ")"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
  
  RowBox[{"r1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "tx", " ", 
      RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
     RowBox[{"2", " ", "ty", " ", 
      RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
     RowBox[{"2", " ", "r2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"q0", "-", "q3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q0", "+", "q3"}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"q1", "-", "q2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"q1", "+", "q2"}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "+", 
        RowBox[{"2", " ", "q0", " ", "q3", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
        RowBox[{"2", " ", "q1", " ", "q2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.5721594805998087`*^9, 3.5721600689214582`*^9, 
  3.572160714007355*^9, 3.572162770622987*^9, 3.5723199686708355`*^9, 
  3.5723211201686974`*^9, 3.574975407162222*^9, 3.581169127128218*^9, 
  3.5811691581319914`*^9, 3.5811695118612237`*^9, 3.58116955498469*^9, 
  3.581169666845088*^9, 3.581169712084676*^9, 3.5811698056550274`*^9, 
  3.5811702819212685`*^9, 3.581170343454788*^9, 3.581170375116599*^9, 
  3.5811705284693704`*^9, 3.58147337481461*^9, 3.5814739486284304`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Size of the expression is:\"\>", "\[InvisibleSpace]", "5.632`",
    "\[InvisibleSpace]", "\<\" KB.\"\>"}],
  SequenceForm["Size of the expression is:", 5.632, " KB."],
  Editable->False]], "Print",
 CellChangeTimes->{3.5721594806018085`*^9, 3.572160068925459*^9, 
  3.5721607140113554`*^9, 3.572162770630987*^9, 3.572319968674836*^9, 
  3.572321120172698*^9, 3.574975407165222*^9, 3.5811691271322184`*^9, 
  3.5811691581359916`*^9, 3.581169511865224*^9, 3.5811695549886904`*^9, 
  3.5811696668490887`*^9, 3.581169712088676*^9, 3.581169805660028*^9, 
  3.581170281925269*^9, 3.5811703434587884`*^9, 3.5811703751205993`*^9, 
  3.5811705284733706`*^9, 3.5814733748176103`*^9, 3.5814739486324306`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq1", " ", "=", " ", 
  RowBox[{"Factor", "[", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"d", ",", " ", "\[Theta]1"}], "]"}], ",", " ", "algvars", ",", 
     " ", "FullSimplify"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5580742152226553`*^9, 3.55807428163601*^9}, {
   3.558074321689114*^9, 3.5580743711156588`*^9}, 3.558075720377026*^9, {
   3.558773386697381*^9, 3.558773387591748*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], " ", "r1", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"ty", " ", 
     RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
    RowBox[{"2", " ", "q0", " ", "q3", " ", "r2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{"2", " ", "q1", " ", "q2", " ", "r2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{"tx", " ", 
     RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q3", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q1", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q2", "2"], " ", "r2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.558773484084691*^9, 3.5587750840382147`*^9, 
  3.558781609706571*^9, 3.558787047320714*^9, 3.5588251314037523`*^9, 
  3.5588378610486097`*^9, 3.5698299242537208`*^9, 3.5699274011124387`*^9, 
  3.56993857869376*^9, 3.5700732435849338`*^9, 3.5701662953435526`*^9, 
  3.5720781882516375`*^9, 3.5721274937157555`*^9, 3.572159486101123*^9, 
  3.5721600845673532`*^9, 3.5721607147843995`*^9, 3.5723199694858823`*^9, 
  3.5723211210247464`*^9, 3.5749754088563185`*^9, 3.581169127878261*^9, 
  3.5811691597610846`*^9, 3.581169512624267*^9, 3.5811695557297325`*^9, 
  3.58116966757913*^9, 3.581169712821718*^9, 3.5811698064500732`*^9, 
  3.5811702826563106`*^9, 3.58117034419183*^9, 3.5811703758446407`*^9, 
  3.5811705294584265`*^9, 3.5814733757116613`*^9, 3.5814739494854794`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eq2", " ", "=", " ", 
   RowBox[{"Factor", "[", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"d", ",", " ", "\[Theta]2"}], "]"}], ",", " ", "algvars", ",", 
      " ", "FullSimplify"}], "]"}], "]"}]}], "\[IndentingNewLine]"}]], "Input",\

 CellChangeTimes->{{3.558074373968647*^9, 3.558074388579677*^9}, {
  3.5580744571006203`*^9, 3.558074478763012*^9}, {3.558773392592637*^9, 
  3.5587733935033207`*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", "r2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "q0", " ", "q3", " ", "r1", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{"2", " ", "q1", " ", "q2", " ", "tx", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"2", " ", "q0", " ", "q3", " ", "tx", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", "ty", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q1", "2"], " ", "ty", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q2", "2"], " ", "ty", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q3", "2"], " ", "ty", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"2", " ", "q0", " ", "q1", " ", "tz", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"2", " ", "q2", " ", "q3", " ", "tz", " ", 
     RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"2", " ", "q1", " ", "q2", " ", "r1", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", "r1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q3", "2"], " ", "r1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "-", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", "tx", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q1", "2"], " ", "tx", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q2", "2"], " ", "tx", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q3", "2"], " ", "tx", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"2", " ", "q1", " ", "q2", " ", "ty", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"2", " ", "q0", " ", "q3", " ", "ty", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{"2", " ", "q0", " ", "q2", " ", "tz", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
    RowBox[{"2", " ", "q1", " ", "q3", " ", "tz", " ", 
     RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["q1", "2"], " ", "r1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["q2", "2"], " ", "r1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "+", "\[Theta]2"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.558771287008296*^9, 3.558772458873426*^9, 3.558772842561883*^9, {
   3.558773377220252*^9, 3.558773394266075*^9}, 3.558775087079199*^9, 
   3.558781614633267*^9, 3.558787049063971*^9, 3.558825133048872*^9, 
   3.558837863491074*^9, 3.5698299293190107`*^9, 3.5699274077358174`*^9, 
   3.5699385831920166`*^9, 3.5700732460090723`*^9, 3.5701662978376956`*^9, 
   3.572078191141803*^9, 3.5721274948058176`*^9, 3.572159488366253*^9, 
   3.572160086589469*^9, 3.5721607157404547`*^9, 3.572319971405992*^9, 
   3.5723211220778065`*^9, 3.574975409908379*^9, 3.581169128795314*^9, 
   3.5811691617171965`*^9, 3.581169513570321*^9, 3.581169556658786*^9, 
   3.581169668484182*^9, 3.5811697137397704`*^9, 3.5811698074331293`*^9, 
   3.581170283572363*^9, 3.581170345130884*^9, 3.5811703767586927`*^9, 
   3.5811705314815426`*^9, 3.5814733767277193`*^9, 3.581473951475593*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f1", " ", "=", " ", 
  RowBox[{"TrigExpand", "[", 
   RowBox[{"eq1", "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", "r1"}], " ", ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5580744196122627`*^9, 3.558074448476202*^9}, 
   3.5580745428124313`*^9, {3.558096923248156*^9, 3.558096923918198*^9}, 
   3.55817551056384*^9, {3.558708448092165*^9, 3.5587084484363127`*^9}, {
   3.558773490487608*^9, 3.558773491978403*^9}, 3.55877510185742*^9, 
   3.5587816491789417`*^9, 3.5587870955272017`*^9, {3.5698306893804836`*^9, 
   3.569830710763706*^9}, {3.569927550203966*^9, 3.569927550587988*^9}, 
   3.5699385846210985`*^9, {3.570073254579563*^9, 3.5700732547695737`*^9}, {
   3.5721296564264555`*^9, 3.572129656667469*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "ty"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{"2", " ", "q1", " ", "q2", " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", "q0", " ", "q3", " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"tx", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q1", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q2", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q1", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q2", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q3", "2"], " ", "r2", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", "q1", " ", "q2", " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", "q0", " ", "q3", " ", "r2", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.558075752233301*^9, 3.558083373849803*^9, 3.558096924902897*^9, 
   3.5580970439410563`*^9, 3.5581755114876413`*^9, 3.558708450129443*^9, 
   3.5587537424832983`*^9, 3.558771297436647*^9, 3.558772476142478*^9, 
   3.5587728851588984`*^9, 3.5587734326600924`*^9, 3.558773493920581*^9, 
   3.558775102420537*^9, 3.5587816506764393`*^9, 3.558787096146031*^9, 
   3.5587875254643707`*^9, 3.558825137953763*^9, 3.558837875932971*^9, 
   3.569829934047281*^9, 3.5699275517250533`*^9, 3.5699385843340826`*^9, 
   3.570073255160596*^9, 3.570166297896699*^9, 3.5720781925688844`*^9, 
   3.5721274949358253`*^9, 3.5721594890582924`*^9, {3.5721600873675137`*^9, 
   3.5721600885945835`*^9}, 3.572160716676508*^9, 3.5723199721480346`*^9, 
   3.5723211229238553`*^9, 3.5749754099573817`*^9, 3.581169128864318*^9, 
   3.5811691617832003`*^9, 3.5811695136373253`*^9, 3.58116955672779*^9, 
   3.5811696685491858`*^9, 3.581169713803774*^9, 3.581169807501133*^9, 
   3.5811702836153655`*^9, 3.5811703451768866`*^9, 3.581170376809696*^9, 
   3.581170531841563*^9, 3.581473376770722*^9, 3.5814739516486034`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f2", " ", "=", " ", 
  RowBox[{"TrigExpand", "[", 
   RowBox[{"eq2", "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", "r2"}], "   ", ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5580744934358597`*^9, 3.55807449849539*^9}, 
   3.5580969296478033`*^9, 3.558175514370661*^9, 3.5587084548281527`*^9, 
   3.55877248590512*^9, {3.558773495815301*^9, 3.558773496641211*^9}, {
   3.558773535050222*^9, 3.558773537143808*^9}, 3.558775104929267*^9, {
   3.558781653762402*^9, 3.5587816584163933`*^9}, 3.558787536913473*^9, {
   3.569830715318967*^9, 3.569830718783165*^9}, {3.569927553924179*^9, 
   3.569927554503212*^9}, {3.5699385883233104`*^9, 3.5699385885913258`*^9}, {
   3.5700732584027815`*^9, 3.5700732585637903`*^9}, {3.57212965790954*^9, 
   3.572129658051548*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "q1", " ", "q2", " ", "tx", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", "q0", " ", "q3", " ", "tx", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "ty", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q1", "2"], " ", "ty", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q2", "2"], " ", "ty", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q3", "2"], " ", "ty", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", "q0", " ", "q1", " ", "tz", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", "q2", " ", "q3", " ", "tz", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", "q1", " ", "q2", " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", "q0", " ", "q3", " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q1", "2"], " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q2", "2"], " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q3", "2"], " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "tx", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q1", "2"], " ", "tx", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q2", "2"], " ", "tx", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q3", "2"], " ", "tx", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", "q1", " ", "q2", " ", "ty", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", "q0", " ", "q3", " ", "ty", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", "q0", " ", "q2", " ", "tz", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{"2", " ", "q1", " ", "q3", " ", "tz", " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["q1", "2"], " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q2", "2"], " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["q3", "2"], " ", "r1", " ", 
   RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", "q1", " ", "q2", " ", "r1", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
  RowBox[{"2", " ", "q0", " ", "q3", " ", "r1", " ", 
   RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.558075752372301*^9, 3.558083374672802*^9, {3.558096931492816*^9, 
   3.5580969333667383`*^9}, 3.558097045022575*^9, 3.5581755151611547`*^9, 
   3.558708455543537*^9, 3.558753742580264*^9, 3.558771303771049*^9, {
   3.55877247731999*^9, 3.558772486458741*^9}, 3.5587728862005987`*^9, 
   3.558773435009131*^9, 3.558773497425158*^9, 3.558773538307983*^9, 
   3.558775105477404*^9, 3.558781659673285*^9, 3.5587875386530952`*^9, 
   3.558825138844091*^9, 3.5588378782201*^9, 3.569829936268408*^9, 
   3.569927555465267*^9, 3.569938589496378*^9, 3.570073258961813*^9, 
   3.5701662981117115`*^9, 3.572078193970965*^9, 3.5721275073425345`*^9, 
   3.572159489700329*^9, 3.5721600908077106`*^9, 3.572160717369548*^9, 
   3.572319972888077*^9, 3.5723211237169003`*^9, 3.5749754105284147`*^9, 
   3.5811691289193206`*^9, 3.581169162851261*^9, 3.581169513709329*^9, 
   3.5811695567977943`*^9, 3.58116966862819*^9, 3.581169713872778*^9, 
   3.581169807568137*^9, 3.5811702845924215`*^9, 3.5811703452268896`*^9, 
   3.5811703774527326`*^9, 3.5811705321895833`*^9, 3.581473376816725*^9, 
   3.581473953217693*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Note", " ", "the", " ", "various", " ", "factors", " ", "of", " ", "g1", 
     " ", "and", " ", 
     RowBox[{"g2", ".", " ", "Instead"}], " ", "of", " ", "looking", " ", 
     "at", " ", "solutions", " ", "of", " ", "g1", " ", "and", " ", "g2"}], 
    ",", " ", 
    RowBox[{
    "look", " ", "at", " ", "the", " ", "solutions", " ", "of", " ", 
     "factors", " ", "of", " ", "g1", " ", "and", " ", "g2"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"tmp1", "=", 
    RowBox[{"FactorList", "[", "f1", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"tmp2", "=", 
    RowBox[{"FactorList", "[", "f2", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.5580774360905743`*^9, 3.558077440174471*^9}, {
  3.5580831468622303`*^9, 3.5580831607612867`*^9}, {3.5580832006640043`*^9, 
  3.558083229738935*^9}, {3.558083413336578*^9, 3.558083423446616*^9}, {
  3.5580837581018267`*^9, 3.558083782558837*^9}, {3.5698308415421867`*^9, 
  3.5698308787133126`*^9}, {3.569830924630939*^9, 3.569830974489791*^9}, {
  3.5700732979800453`*^9, 3.5700732989140987`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"ty", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"2", " ", "q1", " ", "q2", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "q0", " ", "q3", " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"tx", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q0", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q1", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q2", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q0", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q1", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q2", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q3", "2"], " ", "r2", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "q1", " ", "q2", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "q0", " ", "q3", " ", "r2", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.558083783992363*^9, {3.558097088447268*^9, 3.558097091387961*^9}, 
   3.558175601295726*^9, 3.558220542611833*^9, 3.558708595988408*^9, {
   3.558753771220283*^9, 3.558753790820266*^9}, 3.5587720182963133`*^9, 
   3.55877222247858*^9, 3.558772627095003*^9, 3.558773068474074*^9, 
   3.5587751765691643`*^9, 3.5587880373200274`*^9, 3.558825186677043*^9, 
   3.5588379672501507`*^9, 3.569830303025385*^9, 3.569928491291793*^9, 
   3.5699401096193237`*^9, 3.570073299277119*^9, 3.570166299126769*^9, 
   3.5720781960080814`*^9, 3.5721275089666276`*^9, 3.572159493475545*^9, 
   3.57216009341986*^9, 3.5721607183066015`*^9, 3.572319973625119*^9, 
   3.572321124513946*^9, 3.574975411691481*^9, 3.5811691289723234`*^9, 
   3.5811691637513127`*^9, 3.5811695144003687`*^9, 3.581169556858797*^9, 
   3.5811696693462315`*^9, 3.581169714573818*^9, 3.581169808287178*^9, 
   3.5811702858554935`*^9, 3.581170345914929*^9, 3.5811703781347713`*^9, 
   3.581170533167639*^9, 3.581473376864727*^9, 3.5814739542347507`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "q1", " ", "q2", " ", "tx", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "q0", " ", "q3", " ", "tx", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q0", "2"], " ", "ty", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q1", "2"], " ", "ty", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q2", "2"], " ", "ty", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q3", "2"], " ", "ty", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "q0", " ", "q1", " ", "tz", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "q2", " ", "q3", " ", "tz", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "q1", " ", "q2", " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "q0", " ", "q3", " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q0", "2"], " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q1", "2"], " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q2", "2"], " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q3", "2"], " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q0", "2"], " ", "tx", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q1", "2"], " ", "tx", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q2", "2"], " ", "tx", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q3", "2"], " ", "tx", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "q1", " ", "q2", " ", "ty", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "q0", " ", "q3", " ", "ty", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "q0", " ", "q2", " ", "tz", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{"2", " ", "q1", " ", "q3", " ", "tz", " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q0", "2"], " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["q1", "2"], " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q2", "2"], " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["q3", "2"], " ", "r1", " ", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "q1", " ", "q2", " ", "r1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}], "-", 
      RowBox[{"2", " ", "q0", " ", "q3", " ", "r1", " ", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.558083783992363*^9, {3.558097088447268*^9, 3.558097091387961*^9}, 
   3.558175601295726*^9, 3.558220542611833*^9, 3.558708595988408*^9, {
   3.558753771220283*^9, 3.558753790820266*^9}, 3.5587720182963133`*^9, 
   3.55877222247858*^9, 3.558772627095003*^9, 3.558773068474074*^9, 
   3.5587751765691643`*^9, 3.5587880373200274`*^9, 3.558825186677043*^9, 
   3.5588379672501507`*^9, 3.569830303025385*^9, 3.569928491291793*^9, 
   3.5699401096193237`*^9, 3.570073299277119*^9, 3.570166299126769*^9, 
   3.5720781960080814`*^9, 3.5721275089666276`*^9, 3.572159493475545*^9, 
   3.57216009341986*^9, 3.5721607183066015`*^9, 3.572319973625119*^9, 
   3.572321124513946*^9, 3.574975411691481*^9, 3.5811691289723234`*^9, 
   3.5811691637513127`*^9, 3.5811695144003687`*^9, 3.581169556858797*^9, 
   3.5811696693462315`*^9, 3.581169714573818*^9, 3.581169808287178*^9, 
   3.5811702858554935`*^9, 3.581170345914929*^9, 3.5811703781347713`*^9, 
   3.581170533167639*^9, 3.581473376864727*^9, 3.5814739542807536`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"j1", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Numerator", "[", 
     RowBox[{"Together", "[", 
      RowBox[{"f1", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]1", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"k1", "^", "2"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"k1", "^", "2"}]}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]1", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", " ", "k1"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"k1", "^", "2"}]}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]2", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"k2", "^", "2"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"k2", "^", "2"}]}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]2", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "k2"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"k2", "^", "2"}]}], ")"}]}]}]}], "}"}]}], "]"}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"k1", ",", "k2"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.569928914086976*^9, 3.5699290237992506`*^9}, {
   3.5699291504004917`*^9, 3.5699291509015207`*^9}, {3.5699297488657227`*^9, 
   3.5699297619874725`*^9}, 3.569931273939952*^9, {3.569941188941057*^9, 
   3.5699412162136173`*^9}, {3.5700733154200425`*^9, 3.57007332254045*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", "q1", " ", "q2", " ", "r2"}], "-", 
  RowBox[{"2", " ", "q0", " ", "q3", " ", "r2"}], "+", 
  RowBox[{"k2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox["q0", "2"], " ", "r2"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["q1", "2"], " ", "r2"}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["q2", "2"], " ", "r2"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["q3", "2"], " ", "r2"}]}], ")"}]}], "+", 
  RowBox[{"k1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["q0", "2"], " ", "r2"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["q1", "2"], " ", "r2"}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["q2", "2"], " ", "r2"}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["q3", "2"], " ", "r2"}], "+", 
     RowBox[{"k2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"8", " ", "q1", " ", "q2", " ", "r2"}], "-", 
        RowBox[{"8", " ", "q0", " ", "q3", " ", "r2"}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "tx"}], "+", 
     RowBox[{
      SuperscriptBox["k2", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox["q0", "2"], " ", "r2"}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["q1", "2"], " ", "r2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["q2", "2"], " ", "r2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["q3", "2"], " ", "r2"}], "+", 
        RowBox[{"2", " ", "tx"}]}], ")"}]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["k2", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "q1", " ", "q2", " ", "r2"}], "+", 
     RowBox[{"2", " ", "q0", " ", "q3", " ", "r2"}], "-", "ty"}], ")"}]}], 
  "-", "ty", "+", 
  RowBox[{
   SuperscriptBox["k1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "q1", " ", "q2", " ", "r2"}], "+", 
     RowBox[{"2", " ", "q0", " ", "q3", " ", "r2"}], "+", 
     RowBox[{"k2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["q0", "2"], " ", "r2"}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["q1", "2"], " ", "r2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["q2", "2"], " ", "r2"}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["q3", "2"], " ", "r2"}]}], ")"}]}], "+", "ty", "+", 
     RowBox[{
      SuperscriptBox["k2", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "q1", " ", "q2", " ", "r2"}], "-", 
        RowBox[{"2", " ", "q0", " ", "q3", " ", "r2"}], "+", "ty"}], 
       ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.569928916016086*^9, {3.5699290127256174`*^9, 3.569929024336282*^9}, 
   3.569929156621848*^9, 3.5699297634665575`*^9, 3.5699312774001493`*^9, 
   3.5699405320334845`*^9, {3.5699412061450415`*^9, 3.569941227616269*^9}, {
   3.570073317736175*^9, 3.5700733228884697`*^9}, 3.5701663015069056`*^9, 
   3.572078202089429*^9, 3.5721275128488493`*^9, 3.5721601022513647`*^9, 
   3.5721607199416947`*^9, 3.5723199755232277`*^9, 3.572321126139039*^9, 
   3.574975415082675*^9, 3.5811691290593286`*^9, 3.581169164768371*^9, 
   3.581169514746389*^9, 3.5811695575388365`*^9, 3.5811696698422594`*^9, 
   3.581169715047845*^9, 3.5811698089982185`*^9, 3.581170287141567*^9, 
   3.5811703462609487`*^9, 3.5811703785047927`*^9, 3.5811705345607185`*^9, 
   3.5814733774077587`*^9, 3.581473958292983*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"j2", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Numerator", "[", 
     RowBox[{"Together", "[", 
      RowBox[{"f2", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]1", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"k1", "^", "2"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"k1", "^", "2"}]}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]1", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", " ", "k1"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"k1", "^", "2"}]}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]2", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"k2", "^", "2"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"k2", "^", "2"}]}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]2", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "k2"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"k2", "^", "2"}]}], ")"}]}]}]}], "}"}]}], "]"}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"t1", ",", "t2"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.5699290443484263`*^9, {3.5699291603650618`*^9, 3.569929164641307*^9}, 
   3.5699297697909193`*^9, {3.569931189267109*^9, 3.5699311914652348`*^9}, 
   3.5699312778351746`*^9, 3.569941224928116*^9, {3.570073326801694*^9, 
   3.5700733306609144`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", "k1", " ", 
   SuperscriptBox["q0", "2"], " ", "r1"}], "+", 
  RowBox[{"2", " ", "k2", " ", 
   SuperscriptBox["q0", "2"], " ", "r1"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", "k2", " ", 
   SuperscriptBox["q0", "2"], " ", "r1"}], "+", 
  RowBox[{"2", " ", "k1", " ", 
   SuperscriptBox["k2", "2"], " ", 
   SuperscriptBox["q0", "2"], " ", "r1"}], "+", 
  RowBox[{"2", " ", "k1", " ", 
   SuperscriptBox["q1", "2"], " ", "r1"}], "+", 
  RowBox[{"2", " ", "k2", " ", 
   SuperscriptBox["q1", "2"], " ", "r1"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", "k2", " ", 
   SuperscriptBox["q1", "2"], " ", "r1"}], "-", 
  RowBox[{"2", " ", "k1", " ", 
   SuperscriptBox["k2", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", "r1"}], "-", 
  RowBox[{"2", " ", "q1", " ", "q2", " ", "r1"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", "q1", " ", "q2", " ", "r1"}], "+", 
  RowBox[{"8", " ", "k1", " ", "k2", " ", "q1", " ", "q2", " ", "r1"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["k2", "2"], " ", "q1", " ", "q2", " ", "r1"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", 
   SuperscriptBox["k2", "2"], " ", "q1", " ", "q2", " ", "r1"}], "-", 
  RowBox[{"2", " ", "k1", " ", 
   SuperscriptBox["q2", "2"], " ", "r1"}], "-", 
  RowBox[{"2", " ", "k2", " ", 
   SuperscriptBox["q2", "2"], " ", "r1"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", "k2", " ", 
   SuperscriptBox["q2", "2"], " ", "r1"}], "+", 
  RowBox[{"2", " ", "k1", " ", 
   SuperscriptBox["k2", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "r1"}], "+", 
  RowBox[{"2", " ", "q0", " ", "q3", " ", "r1"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", "q0", " ", "q3", " ", "r1"}], "+", 
  RowBox[{"8", " ", "k1", " ", "k2", " ", "q0", " ", "q3", " ", "r1"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["k2", "2"], " ", "q0", " ", "q3", " ", "r1"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", 
   SuperscriptBox["k2", "2"], " ", "q0", " ", "q3", " ", "r1"}], "+", 
  RowBox[{"2", " ", "k1", " ", 
   SuperscriptBox["q3", "2"], " ", "r1"}], "-", 
  RowBox[{"2", " ", "k2", " ", 
   SuperscriptBox["q3", "2"], " ", "r1"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", "k2", " ", 
   SuperscriptBox["q3", "2"], " ", "r1"}], "-", 
  RowBox[{"2", " ", "k1", " ", 
   SuperscriptBox["k2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "r1"}], "-", 
  RowBox[{"2", " ", "k2", " ", 
   SuperscriptBox["q0", "2"], " ", "tx"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", "k2", " ", 
   SuperscriptBox["q0", "2"], " ", "tx"}], "-", 
  RowBox[{"2", " ", "k2", " ", 
   SuperscriptBox["q1", "2"], " ", "tx"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", "k2", " ", 
   SuperscriptBox["q1", "2"], " ", "tx"}], "+", 
  RowBox[{"2", " ", "q1", " ", "q2", " ", "tx"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", "q1", " ", "q2", " ", "tx"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["k2", "2"], " ", "q1", " ", "q2", " ", "tx"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", 
   SuperscriptBox["k2", "2"], " ", "q1", " ", "q2", " ", "tx"}], "+", 
  RowBox[{"2", " ", "k2", " ", 
   SuperscriptBox["q2", "2"], " ", "tx"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", "k2", " ", 
   SuperscriptBox["q2", "2"], " ", "tx"}], "-", 
  RowBox[{"2", " ", "q0", " ", "q3", " ", "tx"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", "q0", " ", "q3", " ", "tx"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["k2", "2"], " ", "q0", " ", "q3", " ", "tx"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", 
   SuperscriptBox["k2", "2"], " ", "q0", " ", "q3", " ", "tx"}], "+", 
  RowBox[{"2", " ", "k2", " ", 
   SuperscriptBox["q3", "2"], " ", "tx"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", "k2", " ", 
   SuperscriptBox["q3", "2"], " ", "tx"}], "+", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "ty"}], "+", 
  RowBox[{
   SuperscriptBox["k1", "2"], " ", 
   SuperscriptBox["q0", "2"], " ", "ty"}], "-", 
  RowBox[{
   SuperscriptBox["k2", "2"], " ", 
   SuperscriptBox["q0", "2"], " ", "ty"}], "-", 
  RowBox[{
   SuperscriptBox["k1", "2"], " ", 
   SuperscriptBox["k2", "2"], " ", 
   SuperscriptBox["q0", "2"], " ", "ty"}], "-", 
  RowBox[{
   SuperscriptBox["q1", "2"], " ", "ty"}], "-", 
  RowBox[{
   SuperscriptBox["k1", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", "ty"}], "+", 
  RowBox[{
   SuperscriptBox["k2", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", "ty"}], "+", 
  RowBox[{
   SuperscriptBox["k1", "2"], " ", 
   SuperscriptBox["k2", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", "ty"}], "-", 
  RowBox[{"4", " ", "k2", " ", "q1", " ", "q2", " ", "ty"}], "-", 
  RowBox[{"4", " ", 
   SuperscriptBox["k1", "2"], " ", "k2", " ", "q1", " ", "q2", " ", "ty"}], 
  "+", 
  RowBox[{
   SuperscriptBox["q2", "2"], " ", "ty"}], "+", 
  RowBox[{
   SuperscriptBox["k1", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "ty"}], "-", 
  RowBox[{
   SuperscriptBox["k2", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "ty"}], "-", 
  RowBox[{
   SuperscriptBox["k1", "2"], " ", 
   SuperscriptBox["k2", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "ty"}], "-", 
  RowBox[{"4", " ", "k2", " ", "q0", " ", "q3", " ", "ty"}], "-", 
  RowBox[{"4", " ", 
   SuperscriptBox["k1", "2"], " ", "k2", " ", "q0", " ", "q3", " ", "ty"}], 
  "-", 
  RowBox[{
   SuperscriptBox["q3", "2"], " ", "ty"}], "-", 
  RowBox[{
   SuperscriptBox["k1", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "ty"}], "+", 
  RowBox[{
   SuperscriptBox["k2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "ty"}], "+", 
  RowBox[{
   SuperscriptBox["k1", "2"], " ", 
   SuperscriptBox["k2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "ty"}], "+", 
  RowBox[{"2", " ", "q0", " ", "q1", " ", "tz"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", "q0", " ", "q1", " ", "tz"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["k2", "2"], " ", "q0", " ", "q1", " ", "tz"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", 
   SuperscriptBox["k2", "2"], " ", "q0", " ", "q1", " ", "tz"}], "+", 
  RowBox[{"4", " ", "k2", " ", "q0", " ", "q2", " ", "tz"}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["k1", "2"], " ", "k2", " ", "q0", " ", "q2", " ", "tz"}], 
  "-", 
  RowBox[{"4", " ", "k2", " ", "q1", " ", "q3", " ", "tz"}], "-", 
  RowBox[{"4", " ", 
   SuperscriptBox["k1", "2"], " ", "k2", " ", "q1", " ", "q3", " ", "tz"}], 
  "+", 
  RowBox[{"2", " ", "q2", " ", "q3", " ", "tz"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", "q2", " ", "q3", " ", "tz"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["k2", "2"], " ", "q2", " ", "q3", " ", "tz"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["k1", "2"], " ", 
   SuperscriptBox["k2", "2"], " ", "q2", " ", "q3", " ", "tz"}]}]], "Output",
 CellChangeTimes->{3.5700733312279468`*^9, 3.5701663028819838`*^9, 
  3.572078203937535*^9, 3.572127515062976*^9, 3.5721601057525654`*^9, 
  3.57216072090875*^9, 3.5723199767252965`*^9, 3.5723211270950937`*^9, 
  3.5749754169567823`*^9, 3.5811691291343327`*^9, 3.581169165542415*^9, 
  3.581169515715444*^9, 3.581169558273878*^9, 3.58116967072231*^9, 
  3.5811697158538914`*^9, 3.5811698097082596`*^9, 3.581170288214628*^9, 
  3.5811703468959846`*^9, 3.5811703791648307`*^9, 3.581170535572777*^9, 
  3.581473378428817*^9, 3.5814739602700963`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"solvetrig2", "[", 
     RowBox[{"eq1_", ",", "eq2_", ",", " ", "\[Theta]_", ",", 
      RowBox[{"simplify_:", " ", "Identity"}]}], "]"}], ":=", " ", "\n", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Inputs", " ", "are", " ", "the", " ", "equations"}], " ", ",", 
      
      RowBox[{
      "the", " ", "angle", " ", "\[Theta]", " ", "and", " ", "an", " ", 
       "operator", " ", "x", " ", "which", " ", "decides", " ", "which", " ", 
       "output", " ", "has", " ", "to", " ", "be", " ", "returned"}]}], 
     "*)"}], "\n", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
        "Solves", " ", "the", " ", "equation", " ", "a1", " ", "cos", " ", 
         RowBox[{"(", "\[Theta]", ")"}]}], " ", "+", " ", 
        RowBox[{"b1", " ", "sin", " ", 
         RowBox[{"(", "\[Theta]", ")"}]}], " ", "+", " ", "c1"}], " ", "=", 
       " ", "0"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"a2", " ", "cos", " ", 
         RowBox[{"(", "\[Theta]", ")"}]}], " ", "+", " ", 
        RowBox[{"b2", " ", "sin", " ", 
         RowBox[{"(", "\[Theta]", ")"}]}], " ", "+", " ", "c2"}], " ", "=", 
       " ", "0"}]}], "  ", "*)"}], "\n", 
    RowBox[{"(*", " ", 
     RowBox[{"TODO", ":", " ", 
      RowBox[{
      "check", " ", "if", " ", "the", " ", "input", " ", "equation", " ", 
       "can", " ", "be", " ", "actually", " ", "cast", " ", "in", " ", "the", 
       " ", "desired", " ", "form"}]}], " ", "*)"}], "\n", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t1", ",", " ", "t2", ",", "t11", ",", "t22", ",", " ", "sol", ",", 
        " ", "sol\[Theta]", ",", "con"}], "}"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"t1", " ", "=", " ", 
        RowBox[{"simplify", "[", 
         RowBox[{"Numerator", "[", 
          RowBox[{"Together", "[", "eq1", "]"}], "]"}], "]"}]}], ";", "\n", 
       RowBox[{"t2", " ", "=", " ", 
        RowBox[{"TrigExpand", "[", "t1", "]"}]}], ";", "\n", "\n", 
       RowBox[{"t11", " ", "=", " ", 
        RowBox[{"simplify", "[", 
         RowBox[{"Numerator", "[", 
          RowBox[{"Together", "[", "eq2", "]"}], "]"}], "]"}]}], ";", "\n", 
       RowBox[{"t22", " ", "=", " ", 
        RowBox[{"TrigExpand", "[", "t11", "]"}]}], ";", "\n", 
       RowBox[{"sol", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t2", ",", " ", "t22"}], "}"}], " ", "==", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\n", "\n", 
       RowBox[{"sol\[Theta]", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Theta]", " ", "->", " ", 
           RowBox[{"ArcTan", "[", 
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "]"}]}], "}"}], "/.", 
         "sol"}]}], ";", "\n", 
       RowBox[{"con", "=", 
        RowBox[{"Numerator", "[", 
         RowBox[{"simplify", "[", 
          RowBox[{"Expand", "[", 
           RowBox[{"Together", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", "\[Theta]", "]"}], "^", "2"}], " ", "+", 
               " ", 
               RowBox[{
                RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", "2"}], " ", "-", 
               " ", "1"}], ")"}], "/.", "sol"}], "]"}], "]"}], "]"}], "]"}]}],
        ";", "\n", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"sol\[Theta]", ",", "con"}], "}"}], "]"}], ";"}]}], "\n", 
     " ", "\n", "]"}]}], ";"}], "\n", "\n"}]], "Input",
 CellChangeTimes->{{3.5721601815008974`*^9, 3.572160206410322*^9}, {
  3.5721604264939103`*^9, 3.5721604314801955`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ar", "=", 
   RowBox[{"solvetrig2", "[", 
    RowBox[{"f1", ",", "f2", ",", "\[Theta]2"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5721601903244023`*^9, 3.572160217589962*^9}, {
   3.572160251369894*^9, 3.572160251962928*^9}, 3.572160726455067*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ar2", "=", 
   RowBox[{"TrigExpand", "[", 
    RowBox[{"Numerator", "[", 
     RowBox[{"Together", "[", 
      RowBox[{"ar", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.572160447962138*^9, 3.572160511315762*^9}, 
   3.5721607342415123`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ar3", "=", 
   RowBox[{"Numerator", "[", 
    RowBox[{"Together", "[", 
     RowBox[{"ar2", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]1", "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"k1", "^", "2"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"k1", "^", "2"}]}], ")"}]}]}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]1", "]"}], "\[Rule]", 
         RowBox[{"2", " ", 
          RowBox[{"k1", "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"k1", "^", "2"}]}], ")"}]}]}]}]}], "}"}]}], "]"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5721606043370824`*^9, 3.5721606449654064`*^9}, 
   3.572160741450925*^9, 3.5811697033281746`*^9, 3.581170542892195*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<ar3.m\>\"", ",", "ar3"}], "]"}]], "Input",
 CellChangeTimes->{{3.581170352178287*^9, 3.5811703630239077`*^9}}],

Cell[BoxData["\<\"ar3.m\"\>"], "Output",
 CellChangeTimes->{{3.5811703671381426`*^9, 3.5811704154619064`*^9}, 
   3.5811705560069456`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"SystemOpen", "[", 
  RowBox[{"DirectoryName", "[", 
   RowBox[{"AbsoluteFileName", "[", "\"\<ar3.m\>\"", "]"}], "]"}], 
  "]"}]], "Input",
 NumberMarks->False],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"input", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q0", "\[Rule]", "0.8"}], ",", 
       RowBox[{"q1", "\[Rule]", "0.4"}], ",", 
       RowBox[{"q2", "\[Rule]", 
        RowBox[{"-", "0.3"}]}], ",", 
       RowBox[{"q3", "\[Rule]", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"0.8", "^", "2"}], "-", 
          RowBox[{"0.3", "^", "2"}], "-", 
          RowBox[{"0.4", "^", "2"}]}], "]"}]}], ",", 
       RowBox[{"r1", "\[Rule]", "0.5"}], ",", 
       RowBox[{"r2", "\[Rule]", ".5"}], ",", 
       RowBox[{"l1", "\[Rule]", "7"}], ",", 
       RowBox[{"l2", "\[Rule]", "4"}], ",", 
       RowBox[{"tx", "\[Rule]", "2"}], ",", 
       RowBox[{"ty", "\[Rule]", 
        RowBox[{"-", "2"}]}], ",", 
       RowBox[{"tz", "\[Rule]", 
        RowBox[{"9.5", "-", "7"}]}]}], "}"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"input", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q1", "\[Rule]", "0"}], ",", 
       RowBox[{"q2", "\[Rule]", "0"}], ",", 
       RowBox[{"q3", "\[Rule]", "0"}], ",", 
       RowBox[{"q0", "\[Rule]", "1"}], ",", 
       RowBox[{"r1", "\[Rule]", "0.5"}], ",", 
       RowBox[{"r2", "\[Rule]", ".5"}], ",", 
       RowBox[{"l1", "\[Rule]", "7"}], ",", 
       RowBox[{"l2", "\[Rule]", "4"}], ",", 
       RowBox[{"tx", "\[Rule]", "2.4"}], ",", 
       RowBox[{"ty", "\[Rule]", 
        RowBox[{"-", "1.3"}]}], ",", 
       RowBox[{"tz", "\[Rule]", "9.5"}]}], "}"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"input", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r1", "->", "1"}], ",", 
     RowBox[{"l1", "->", "5"}], ",", 
     RowBox[{"r2", "->", "1"}], ",", 
     RowBox[{"l2", "->", "10"}], ",", 
     RowBox[{"q0", "\[Rule]", 
      RowBox[{"-", "0.3"}]}], ",", 
     RowBox[{"q1", "->", "0.4"}], ",", 
     RowBox[{"q2", "->", 
      RowBox[{"-", "0.3"}]}], ",", 
     RowBox[{"q3", "->", "0.812403840463596"}], ",", 
     RowBox[{"tx", "->", "8.799230723708769"}], ",", 
     RowBox[{"ty", "->", 
      RowBox[{"-", "1.3823269128344733"}]}], ",", 
     RowBox[{"tz", "->", 
      RowBox[{"-", "1.2894615065961377"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.5720784391219864`*^9, 3.5720784633313713`*^9}, {
   3.5721275603125644`*^9, 3.5721275704831457`*^9}, {3.5721277622211127`*^9, 
   3.572127772542703*^9}, {3.572127816810235*^9, 3.5721278171792564`*^9}, 
   3.5721278486780577`*^9, {3.572127885059139*^9, 3.5721278858521843`*^9}, {
   3.5721282095857005`*^9, 3.572128221066357*^9}, {3.5721282722132826`*^9, 
   3.5721282806607656`*^9}, {3.5721289648568993`*^9, 3.572128989462307*^9}, {
   3.5721290615314293`*^9, 3.572129064479598*^9}, {3.572160673364031*^9, 
   3.5721606978644323`*^9}, {3.572319951540856*^9, 3.5723199540850015`*^9}, {
   3.574975495397269*^9, 3.5749754974773874`*^9}, {3.5811690558831434`*^9, 
   3.581169113448436*^9}, {3.5814733163532667`*^9, 3.5814733683142385`*^9}, 
   3.5814740395026283`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"r1", "\[Rule]", "1"}], ",", 
   RowBox[{"l1", "\[Rule]", "5"}], ",", 
   RowBox[{"r2", "\[Rule]", "1"}], ",", 
   RowBox[{"l2", "\[Rule]", "10"}], ",", 
   RowBox[{"q0", "\[Rule]", 
    RowBox[{"-", "0.3`"}]}], ",", 
   RowBox[{"q1", "\[Rule]", "0.4`"}], ",", 
   RowBox[{"q2", "\[Rule]", 
    RowBox[{"-", "0.3`"}]}], ",", 
   RowBox[{"q3", "\[Rule]", "0.812403840463596`"}], ",", 
   RowBox[{"tx", "\[Rule]", "8.799230723708769`"}], ",", 
   RowBox[{"ty", "\[Rule]", 
    RowBox[{"-", "1.3823269128344733`"}]}], ",", 
   RowBox[{"tz", "\[Rule]", 
    RowBox[{"-", "1.2894615065961377`"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.58147404093871*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"solk1", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ar3", "/.", "input"}], ")"}], "\[Equal]", "0"}], ",", "k1"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5720784391219864`*^9, 3.5720784633313713`*^9}, {
   3.5721275603125644`*^9, 3.5721275704831457`*^9}, {3.5721277622211127`*^9, 
   3.572127772542703*^9}, {3.572127816810235*^9, 3.5721278171792564`*^9}, 
   3.5721278486780577`*^9, {3.572127885059139*^9, 3.5721278858521843`*^9}, {
   3.5721282095857005`*^9, 3.572128221066357*^9}, {3.5721282722132826`*^9, 
   3.5721282806607656`*^9}, {3.5721289648568993`*^9, 3.572128989462307*^9}, {
   3.5721290615314293`*^9, 3.572129064479598*^9}, {3.572160673364031*^9, 
   3.5721606978644323`*^9}, {3.572319951540856*^9, 3.5723199540850015`*^9}, {
   3.574975495397269*^9, 3.5749754974773874`*^9}, {3.5811690558831434`*^9, 
   3.581169113448436*^9}, {3.5814733163532667`*^9, 3.5814733683142385`*^9}, 
   3.5814740395026283`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"k1", "\[Rule]", 
     RowBox[{"-", "0.0865374450884716`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k1", "\[Rule]", 
     RowBox[{"-", "0.0708447894159289`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k1", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "0.01652981153189054`"}], "-", 
      RowBox[{"0.7655172082357474`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k1", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "0.01652981153189054`"}], "+", 
      RowBox[{"0.7655172082357474`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k1", "\[Rule]", 
     RowBox[{"0.0457524792242505`", "\[VeryThinSpace]", "-", 
      RowBox[{"1.079471380904468`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k1", "\[Rule]", 
     RowBox[{"0.0457524792242505`", "\[VeryThinSpace]", "+", 
      RowBox[{"1.079471380904468`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k1", "\[Rule]", "11.528674905164808`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k1", "\[Rule]", "14.270269622499963`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.572160701692651*^9, 3.5721607472332554`*^9, 
  3.5723199911211195`*^9, 3.57232114224196*^9, 3.574975441676196*^9, 
  3.5749754983774395`*^9, 3.581169140237968*^9, 3.5811691792592*^9, 
  3.581169528001147*^9, 3.5811695704715757`*^9, 3.5814733899234743`*^9, 
  3.5814740516393223`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ar3", "/.", "input"}]], "Input",
 CellChangeTimes->{{3.581473840968272*^9, 3.581473844700486*^9}}],

Cell[BoxData[
 RowBox[{"50.29446648859576`", "\[VeryThinSpace]", "+", 
  RowBox[{"1282.1186347600815`", " ", "k1"}], "+", 
  RowBox[{"8101.926106906301`", " ", 
   SuperscriptBox["k1", "2"]}], "+", 
  RowBox[{"1823.3724793040074`", " ", 
   SuperscriptBox["k1", "3"]}], "+", 
  RowBox[{"20508.64521125829`", " ", 
   SuperscriptBox["k1", "4"]}], "-", 
  RowBox[{"2079.974508708394`", " ", 
   SuperscriptBox["k1", "5"]}], "+", 
  RowBox[{"11927.902337637055`", " ", 
   SuperscriptBox["k1", "6"]}], "-", 
  RowBox[{"1872.4740295018596`", " ", 
   SuperscriptBox["k1", "7"]}], "+", 
  RowBox[{"72.85889002702456`", " ", 
   SuperscriptBox["k1", "8"]}]}]], "Output",
 CellChangeTimes->{3.5814738452405167`*^9, 3.581473927725235*^9, 
  3.5814740438948793`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nsolutions", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"0", "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "solk1", "]"}], ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", 
     RowBox[{"Length", "[", "solk1", "]"}]}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"nsolutions", "[", 
       RowBox[{"[", "ii", "]"}], "]"}], "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Theta]1", "->", 
          RowBox[{"Chop", "[", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"ArcTan", "[", "k1", "]"}]}], "/.", 
            RowBox[{"solk1", "[", 
             RowBox[{"[", "ii", "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"ar", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", "input"}], "/.", 
          RowBox[{"(", 
           RowBox[{"\[Theta]1", "->", 
            RowBox[{"Chop", "[", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"ArcTan", "[", "k1", "]"}]}], "/.", 
              RowBox[{"solk1", "[", 
               RowBox[{"[", "ii", "]"}], "]"}]}], "]"}]}], ")"}]}]}], "}"}], 
       "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
  "\n"}], "\[IndentingNewLine]", "nsolutions"}], "Input",
 CellChangeTimes->{{3.5701736021484785`*^9, 3.5701736144621825`*^9}, {
   3.572160821400498*^9, 3.572160828186886*^9}, 3.572160872003392*^9, {
   3.572160904051225*^9, 3.572160926133488*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{"-", "0.17264478409179987`"}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"-", "0.7873068005235592`"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{"-", "0.14145324420197816`"}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", "2.3483223085337896`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.07974066174683317`"}], "-", 
       RowBox[{"2.01638198387642`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.8690445811781647`"}], "+", 
       RowBox[{"2.4539801976772595`", " ", "\[ImaginaryI]"}]}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.07974066174683317`"}], "+", 
       RowBox[{"2.01638198387642`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "0.8690445811781647`"}], "-", 
       RowBox[{"2.453980197677259`", " ", "\[ImaginaryI]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{"2.6412232808346126`", "\[VeryThinSpace]", "-", 
       RowBox[{"3.1215826717670128`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"2.0074424288227126`", "\[VeryThinSpace]", "-", 
       RowBox[{"3.568626749171979`", " ", "\[ImaginaryI]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{"2.6412232808346126`", "\[VeryThinSpace]", "+", 
       RowBox[{"3.1215826717670128`", " ", "\[ImaginaryI]"}]}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"2.0074424288227126`", "\[VeryThinSpace]", "+", 
       RowBox[{"3.5686267491719788`", " ", "\[ImaginaryI]"}]}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "2.968545306316299`"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"-", "0.7838694074909464`"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "3.0016698684382406`"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", "2.3629974536271545`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.5701736040385866`*^9, 3.5701736151062193`*^9}, {
   3.5701739961080112`*^9, 3.5701740266527586`*^9}, {3.5701741635675898`*^9, 
   3.5701741866209083`*^9}, 3.5701744407024407`*^9, 3.570174491882368*^9, 
   3.570182403090863*^9, 3.5720782194274206`*^9, 3.5721275811077538`*^9, 
   3.5721277745628185`*^9, 3.5721278187863483`*^9, 3.5721278892803802`*^9, 
   3.572128284316975*^9, 3.5721289914004183`*^9, 3.572129066165694*^9, 
   3.5721297534860067`*^9, 3.572160791630795*^9, {3.5721608779277306`*^9, 
   3.5721609266125154`*^9}, 3.572319994747327*^9, 3.5723211423649673`*^9, 
   3.5749755041017666`*^9, 3.5811691826013913`*^9, 3.5814733978519278`*^9, 
   3.581474058840734*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"filtering", " ", "out", " ", "real", " ", "solutions"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"restol1", "=", 
     RowBox[{"10", "^", 
      RowBox[{"-", "3"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"realsolns", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"ii", "=", "1"}], ",", 
     RowBox[{"ii", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "nsolutions", "]"}]}], ",", 
     RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tmp", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Theta]1", ",", "\[Theta]2"}], "}"}], "/.", 
        RowBox[{"nsolutions", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Im", "[", "tmp", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "  ", "restol1"}], 
         " ", "&&", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Im", "[", "tmp", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", " ", "restol1"}]}],
         " ", ",", 
        RowBox[{"realsolns", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"realsolns", ",", 
           RowBox[{"nsolutions", "[", 
            RowBox[{"[", "ii", "]"}], "]"}]}], "]"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "realsolns", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", "d", "]"}], "/.", "input"}], "/.", 
    "realsolns"}]}]}]], "Input",
 CellChangeTimes->{{3.5701736021484785`*^9, 3.570173629265029*^9}, 
   3.570173659420754*^9, 3.5701737213722973`*^9, {3.572127976855389*^9, 
   3.5721279771234045`*^9}, {3.5814734041852903`*^9, 3.581473405617372*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{"-", "0.17264478409179987`"}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"-", "0.7873068005235592`"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{"-", "0.14145324420197816`"}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", "2.3483223085337896`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "2.968545306316299`"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"-", "0.7838694074909464`"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", "3.0016698684382406`"}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", "2.3629974536271545`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.570173666237144*^9, 3.5701737221463413`*^9, 3.570173997803108*^9, 
   3.5701740279458323`*^9, {3.570174164356635*^9, 3.5701741881159935`*^9}, 
   3.5701744420265164`*^9, 3.5701744931894426`*^9, 3.5701824050339746`*^9, 
   3.5721275860730376`*^9, 3.5721277757538867`*^9, 3.572127819837408*^9, {
   3.572127890345441*^9, 3.5721278916825175`*^9}, 3.572127977670436*^9, 
   3.572128288652223*^9, 3.572128992501481*^9, 3.5721290670587454`*^9, 
   3.57212975458907*^9, 3.5723199982455273`*^9, {3.572321142451972*^9, 
   3.572321142552978*^9}, 3.5749755091320543`*^9, 3.581169184436496*^9, {
   3.5814733990549965`*^9, 3.581473406010394*^9}, 3.581474060445826*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "7.40908779959829`", ",", "8.687492077799567`", ",", "9.406272798967574`", 
   ",", "10.637457606441835`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.570173666237144*^9, 3.5701737221463413`*^9, 3.570173997803108*^9, 
   3.5701740279458323`*^9, {3.570174164356635*^9, 3.5701741881159935`*^9}, 
   3.5701744420265164`*^9, 3.5701744931894426`*^9, 3.5701824050339746`*^9, 
   3.5721275860730376`*^9, 3.5721277757538867`*^9, 3.572127819837408*^9, {
   3.572127890345441*^9, 3.5721278916825175`*^9}, 3.572127977670436*^9, 
   3.572128288652223*^9, 3.572128992501481*^9, 3.5721290670587454`*^9, 
   3.57212975458907*^9, 3.5723199982455273`*^9, {3.572321142451972*^9, 
   3.572321142552978*^9}, 3.5749755091320543`*^9, 3.581169184436496*^9, {
   3.5814733990549965`*^9, 3.581473406010394*^9}, 3.5814740604528265`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"q", "=", 
   RowBox[{"{", 
    RowBox[{"q0", ",", "q1", ",", "q2", ",", "q3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"CC", "[", 
  RowBox[{
   RowBox[{"r1", "/.", "input"}], ",", 
   RowBox[{"l1", "/.", "input"}], ",", 
   RowBox[{"r2", "/.", "input"}], ",", 
   RowBox[{"l2", "/.", "input"}], ",", 
   RowBox[{"q", "/.", "input"}], ",", 
   RowBox[{"t", "/.", "input"}]}], "]"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Theta]1$13096", "\[Rule]", 
    RowBox[{"-", "0.17264478409179468`"}]}], ",", 
   RowBox[{"\[Theta]2$13096", "\[Rule]", 
    RowBox[{"-", "0.7873068005235601`"}]}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.581474163443717*^9, 3.581474202876972*^9, {3.5814742537058797`*^9, 
   3.58147427014382*^9}, 3.5814743786220245`*^9}],

Cell[BoxData["\<\"we are in CC now\"\>"], "Print",
 CellChangeTimes->{
  3.581474163443717*^9, 3.581474202876972*^9, {3.5814742537058797`*^9, 
   3.58147427014382*^9}, 3.581474378625025*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"0.9851338696227768`", ",", 
     RowBox[{"-", "0.171788413235741`"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8.271051018731177`", ",", 
     RowBox[{"-", "1.442312333494085`"}], ",", 
     RowBox[{"-", "0.4424503209804619`"}]}], "}"}], ",", "7.409087799598289`",
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.17264478409179468`"}], ",", 
     RowBox[{"-", "0.7873068005235601`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5814741634497175`*^9, 3.581474202883973*^9, {3.581474253723881*^9, 
   3.5814742701508207`*^9}, 3.581474378629025*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mind", "=", 
   RowBox[{
    RowBox[{"d", "/.", "input"}], "/.", 
    RowBox[{"realsolns", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mini", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "2"}], ",", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "realsolns", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", "/.", "input"}], "/.", 
        RowBox[{"realsolns", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "<", "mind"}], ",", 
     RowBox[{
      RowBox[{"mind", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", "/.", "input"}], "/.", 
         RowBox[{"realsolns", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], ";", 
      RowBox[{"mini", "=", "i"}]}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Sqrt", "[", "mind", "]"}], "\[IndentingNewLine]", "mini"}], "Input",\

 CellChangeTimes->{{3.5587795093706617`*^9, 3.558779564496065*^9}, {
   3.55877967345051*^9, 3.558779784653714*^9}, {3.558788107977495*^9, 
   3.558788157697606*^9}, {3.55878819926399*^9, 3.5587882230783567`*^9}, {
   3.57017407319042*^9, 3.5701741279275513`*^9}, 3.570174199541647*^9, {
   3.5701824523966837`*^9, 3.570182530176132*^9}, {3.5701825648341146`*^9, 
   3.570182603618333*^9}, {3.5721286829977784`*^9, 3.5721286964565477`*^9}, {
   3.5811692259168687`*^9, 3.581169228894039*^9}}],

Cell[BoxData["7.40908779959829`"], "Output",
 CellChangeTimes->{{3.570182604219367*^9, 3.570182606852518*^9}, 
   3.5721275895842385`*^9, 3.572127776923954*^9, 3.5721278207014575`*^9, 
   3.572127893100599*^9, 3.572128295912638*^9, {3.572128684647873*^9, 
   3.572128697349599*^9}, 3.572128993788554*^9, 3.5721290695678887`*^9, 
   3.572129757133215*^9, 3.572320001123692*^9, 3.5723211425839796`*^9, 
   3.5749755127152596`*^9, 3.5811691895857906`*^9, 3.581169229357065*^9, 
   3.5814734092295785`*^9, 3.581474063454998*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.570182604219367*^9, 3.570182606852518*^9}, 
   3.5721275895842385`*^9, 3.572127776923954*^9, 3.5721278207014575`*^9, 
   3.572127893100599*^9, 3.572128295912638*^9, {3.572128684647873*^9, 
   3.572128697349599*^9}, 3.572128993788554*^9, 3.5721290695678887`*^9, 
   3.572129757133215*^9, 3.572320001123692*^9, 3.5723211425839796`*^9, 
   3.5749755127152596`*^9, 3.5811691895857906`*^9, 3.581169229357065*^9, 
   3.5814734092295785`*^9, 3.581474063463999*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"np1", "=", 
  RowBox[{
   RowBox[{"p1", "/.", "input"}], "/.", 
   RowBox[{"realsolns", "[", 
    RowBox[{"[", "mini", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"np2", "=", 
  RowBox[{
   RowBox[{"p2", "/.", "input"}], "/.", 
   RowBox[{"realsolns", "[", 
    RowBox[{"[", "mini", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"np3", "=", 
   RowBox[{
    RowBox[{"p1", "/.", "input"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "\[Rule]", 
       RowBox[{"-", "0.8498293759874517`"}]}], ",", 
      RowBox[{"\[Theta]2", "\[Rule]", 
       RowBox[{"\[Pi]", "-", "0.3686611279601015`"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"np4", "=", 
   RowBox[{
    RowBox[{"p2", "/.", "input"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "\[Rule]", 
       RowBox[{"-", "0.8498293759874517`"}]}], ",", 
      RowBox[{"\[Theta]2", "\[Rule]", 
       RowBox[{"\[Pi]", "-", "0.3686611279601015`"}]}]}], "}"}]}]}], ";", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{"Cylinder", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{
            RowBox[{"-", "l1"}], "/.", "input"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"r1", "/.", "input"}]}], "]"}], "]"}], ",", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"Cylinder", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"tx", ",", "ty", ",", "tz"}], "}"}], ")"}], "/.", 
          "input"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tx", ",", "ty", ",", "tz"}], "}"}], "+", 
            RowBox[{"R", ".", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"l2", "/.", "input"}]}], "}"}]}]}], ")"}], "/.", 
          "input"}]}], "}"}], ",", 
       RowBox[{"r2", "/.", "input"}]}], "]"}], "]"}], ",", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.01", "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"np1", ",", "np2"}], "}"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5587795093706617`*^9, 3.558779564496065*^9}, {
   3.55877967345051*^9, 3.558779784653714*^9}, {3.558788107977495*^9, 
   3.558788157697606*^9}, {3.55878819926399*^9, 3.5587882230783567`*^9}, {
   3.57017407319042*^9, 3.5701741279275513`*^9}, 3.570174199541647*^9, {
   3.5701824523966837`*^9, 3.570182530176132*^9}, {3.5701825648341146`*^9, 
   3.5701826173381176`*^9}, {3.57212800712012*^9, 3.5721280531237516`*^9}, {
   3.5721283039600983`*^9, 3.572128306364236*^9}, {3.5721286883620853`*^9, 
   3.5721286895821548`*^9}, {3.5721287229210615`*^9, 
   3.5721287493505735`*^9}, {3.5721290233932476`*^9, 
   3.5721290439894257`*^9}, {3.572129134047577*^9, 3.572129169631612*^9}, {
   3.5721297883830028`*^9, 3.572129824021041*^9}, {3.572321112713271*^9, 
   3.5723211132092996`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.9851338696227759`", ",", 
   RowBox[{"-", "0.17178841323574612`"}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5701824568379374`*^9, 3.5701826183871775`*^9, 3.572127595992605*^9, 
   3.572127777833006*^9, 3.572127821560507*^9, 3.572127955223152*^9, {
   3.5721280111433506`*^9, 3.5721280538597937`*^9}, {3.5721283005059013`*^9, 
   3.572128306680254*^9}, {3.5721286991117*^9, 3.5721287503106284`*^9}, {
   3.57212899756077*^9, 3.5721290708629627`*^9}, {3.5721291450242047`*^9, 
   3.572129169966631*^9}, 3.5721297617724805`*^9, {3.5721297923662305`*^9, 
   3.57212982434606*^9}, 3.5723200650393476`*^9, 3.5723211426829853`*^9, 
   3.5749755159204426`*^9, 3.581169194363064*^9, 3.581473412897788*^9, 
   3.5814740654791136`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8.271051018731177`", ",", 
   RowBox[{"-", "1.442312333494086`"}], ",", 
   RowBox[{"-", "0.4424503209804621`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5701824568379374`*^9, 3.5701826183871775`*^9, 3.572127595992605*^9, 
   3.572127777833006*^9, 3.572127821560507*^9, 3.572127955223152*^9, {
   3.5721280111433506`*^9, 3.5721280538597937`*^9}, {3.5721283005059013`*^9, 
   3.572128306680254*^9}, {3.5721286991117*^9, 3.5721287503106284`*^9}, {
   3.57212899756077*^9, 3.5721290708629627`*^9}, {3.5721291450242047`*^9, 
   3.572129169966631*^9}, 3.5721297617724805`*^9, {3.5721297923662305`*^9, 
   3.57212982434606*^9}, 3.5723200650393476`*^9, 3.5723211426829853`*^9, 
   3.5749755159204426`*^9, 3.581169194363064*^9, 3.581473412897788*^9, 
   3.5814740654841137`*^9}],

Cell[BoxData[
 Graphics3DBox[{CylinderBox[{{0, 0, 0}, {0, 0, -5}}, 1], 
   CylinderBox[{{
    8.799230723708769, -1.3823269128344733`, -1.2894615065961377`}, {
    17.098461447417534`, -3.8567499556160496`, 3.7105384934038623`}}, 1], 
   {Thickness[0.01], 
    Line3DBox[{{0.9851338696227759, -0.17178841323574612`, 0}, {
      8.271051018731177, -1.442312333494086, -0.4424503209804621}}]}},
  AutomaticImageSize->True,
  Boxed->False,
  ImageSize->{422.29865173800425`, 459.6601409041105},
  ViewPoint->{0.7233939608197753, 2.8771874169773968`, 1.6274193513155786`},
  ViewVertical->{0.9720040091037434, 0.3047543082917055, 
   0.25740132029149493`}]], "Output",
 CellChangeTimes->{
  3.5701824568379374`*^9, 3.5701826183871775`*^9, 3.572127595992605*^9, 
   3.572127777833006*^9, 3.572127821560507*^9, 3.572127955223152*^9, {
   3.5721280111433506`*^9, 3.5721280538597937`*^9}, {3.5721283005059013`*^9, 
   3.572128306680254*^9}, {3.5721286991117*^9, 3.5721287503106284`*^9}, {
   3.57212899756077*^9, 3.5721290708629627`*^9}, {3.5721291450242047`*^9, 
   3.572129169966631*^9}, 3.5721297617724805`*^9, {3.5721297923662305`*^9, 
   3.57212982434606*^9}, 3.5723200650393476`*^9, 3.5723211426829853`*^9, 
   3.5749755159204426`*^9, 3.581169194363064*^9, 3.581473412897788*^9, 
   3.581474065513116*^9}]
}, Open  ]]
},
WindowSize->{1008, 633},
WindowMargins->{{18, Automatic}, {Automatic, 16}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> True}},
ShowSelection->True,
Magnification->1.5999997854232788`,
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 385, 10, 116, "Input",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[967, 34, 2000, 41, 242, "Input"],
Cell[2970, 77, 1506, 25, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4513, 107, 5098, 121, 634, "Input"],
Cell[9614, 230, 2374, 61, 124, "Output"],
Cell[11991, 293, 2156, 54, 113, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14184, 352, 1496, 39, 270, "Input"],
Cell[15683, 393, 3909, 107, 195, "Output"],
Cell[19595, 502, 746, 12, 33, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20378, 519, 459, 10, 45, "Input"],
Cell[20840, 531, 1943, 41, 81, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22820, 577, 480, 12, 74, "Input"],
Cell[23303, 591, 3657, 78, 194, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26997, 674, 744, 13, 45, "Input"],
Cell[27744, 689, 3191, 66, 159, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30972, 760, 793, 14, 45, "Input"],
Cell[31768, 776, 4747, 102, 249, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36552, 883, 1129, 24, 130, "Input"],
Cell[37684, 909, 3450, 72, 196, "Output"],
Cell[41137, 983, 5183, 109, 281, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46357, 1097, 1824, 49, 158, "Input"],
Cell[48184, 1148, 3570, 91, 178, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51791, 1244, 1800, 50, 158, "Input"],
Cell[53594, 1296, 7564, 184, 425, "Output"]
}, Open  ]],
Cell[61173, 1483, 4053, 100, 718, "Input"],
Cell[65229, 1585, 291, 6, 45, "Input"],
Cell[65523, 1593, 370, 11, 45, "Input"],
Cell[65896, 1606, 920, 26, 102, "Input"],
Cell[CellGroupData[{
Cell[66841, 1636, 164, 3, 45, "Input"],
Cell[67008, 1641, 138, 2, 44, "Output"]
}, Open  ]],
Cell[67161, 1646, 183, 5, 45, "Input"],
Cell[CellGroupData[{
Cell[67369, 1655, 3061, 73, 242, "Input"],
Cell[70433, 1730, 705, 18, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71175, 1753, 1036, 19, 74, "Input"],
Cell[72214, 1774, 1491, 36, 99, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73742, 1815, 122, 2, 45, "Input"],
Cell[73867, 1819, 757, 18, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74661, 1842, 1769, 48, 270, "Input"],
Cell[76433, 1892, 3099, 71, 180, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79569, 1968, 2033, 54, 298, "Input"],
Cell[81605, 2024, 1527, 33, 72, "Output"],
Cell[83135, 2059, 852, 14, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84024, 2078, 442, 13, 102, "Input"],
Cell[CellGroupData[{
Cell[84491, 2095, 379, 9, 33, "Print"],
Cell[84873, 2106, 190, 3, 33, "Print"]
}, Open  ]],
Cell[85078, 2112, 663, 17, 128, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85778, 2134, 1624, 40, 242, "Input"],
Cell[87405, 2176, 524, 7, 44, "Output"],
Cell[87932, 2185, 508, 7, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88477, 2197, 3300, 86, 270, "Input"],
Cell[91780, 2285, 780, 13, 44, "Output"],
Cell[92563, 2300, 814, 14, 44, "Output"],
Cell[93380, 2316, 1303, 23, 758, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
