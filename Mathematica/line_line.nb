(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     50396,       1316]
NotebookOptionsPosition[     48189,       1240]
NotebookOutlinePosition[     48730,       1259]
CellTagsIndexPosition[     48687,       1256]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
(*
Programme for finding the least distance (i.e., finding the proximity) \
between two finite lines\[LineSeparator]
*)\[LineSeparator]\
\>", "Input",
 Evaluatable->False,
 CellChangeTimes->{
  3.558075401021812*^9, {3.558075433176977*^9, 3.55807549337778*^9}, 
   3.5580756045375433`*^9, {3.5698304191010246`*^9, 3.569830422737232*^9}, {
   3.570436965952966*^9, 3.570436968064087*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "define", " ", "the", " ", "first", " ", "line", " ", "in", " ", "its", 
    " ", "local", " ", "frame", " ", "of", " ", "reference"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", " ", "y1"}], "}"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z1", " ", "=", " ", 
     RowBox[{"l1", "*", "t1"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "define", " ", "a", " ", "point", " ", "on", " ", "the", " ", "line"}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"p1", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"x1", ",", " ", "y1", ",", " ", "z1"}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.558073458170795*^9, 3.558073553293523*^9}, {
   3.55807371917924*^9, 3.5580737362448263`*^9}, {3.558096992182033*^9, 
   3.558096992876449*^9}, {3.5580976551705437`*^9, 3.5580976563218107`*^9}, 
   3.5580976996167173`*^9, {3.558098725578822*^9, 3.5580987512630997`*^9}, {
   3.558142950725593*^9, 3.558142991505747*^9}, {3.5587083423965797`*^9, 
   3.558708342701953*^9}, 3.5587084020411243`*^9, {3.55877071174793*^9, 
   3.558770719365891*^9}, 3.558771208567287*^9, {3.558772402537244*^9, 
   3.5587724069393177`*^9}, {3.558773240379507*^9, 3.558773272034829*^9}, 
   3.5587750721059427`*^9, {3.558781569802609*^9, 3.55878158664182*^9}, {
   3.558786957930822*^9, 3.558786962508292*^9}, {3.55882511647033*^9, 
   3.558825117438373*^9}, 3.558837829436367*^9, {3.5701395964699454`*^9, 
   3.570139597530006*^9}, {3.57043697389342*^9, 3.570436980219782*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   RowBox[{"l1", " ", "t1"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.558075673827717*^9, 3.5580757139613857`*^9, 3.558080377378187*^9, 
   3.558096993681979*^9, {3.558097678077073*^9, 3.558097703009056*^9}, 
   3.558098752910901*^9, 3.558175433811019*^9, 3.558707265456934*^9, 
   3.55870834372339*^9, 3.558708407063963*^9, 3.55875370056467*^9, 
   3.558770727019174*^9, 3.558771243339748*^9, 3.558772407676833*^9, 
   3.558772789318028*^9, {3.558773257479459*^9, 3.55877327314431*^9}, 
   3.558775073047317*^9, 3.55878159636373*^9, 3.558786966507745*^9, 
   3.558787027180826*^9, 3.5588251188342113`*^9, 3.558837832630258*^9, 
   3.5698297915661316`*^9, 3.5701392306970243`*^9, 3.5701396094796896`*^9, 
   3.572098369610077*^9, 3.572099670694495*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "define", " ", "the", " ", "second", " ", "line", " ", "likewise"}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x2", ",", " ", "y2"}], "}"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z2", " ", "=", " ", 
     RowBox[{"l2", "*", "t2"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "take", " ", "the", " ", "second", " ", "line", " ", "to", " ", "a", " ", 
     "generic", " ", "configuration"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"define", " ", "the", " ", "orientation"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"q0", "^", "2"}], "+", 
          RowBox[{"q1", "^", "2"}], "-", 
          RowBox[{"q2", "^", "2"}], "-", 
          RowBox[{"q3", "^", "2"}]}], ",", 
         RowBox[{
          RowBox[{"2", " ", "q1", " ", "q2"}], "-", 
          RowBox[{"2", " ", "q0", " ", "q3"}]}], ",", 
         RowBox[{
          RowBox[{"2", " ", "q1", " ", "q3"}], "+", 
          RowBox[{"2", " ", "q0", " ", "q2"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
          RowBox[{"2", " ", "q0", " ", "q3"}]}], ",", 
         RowBox[{
          RowBox[{"q0", "^", "2"}], "-", 
          RowBox[{"q1", "^", "2"}], "+", 
          RowBox[{"q2", "^", "2"}], "-", 
          RowBox[{"q3", "^", "2"}]}], ",", 
         RowBox[{
          RowBox[{"2", " ", "q2", " ", "q3"}], "-", 
          RowBox[{"2", "q0", " ", "q1"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", "q1", " ", "q3"}], "-", 
          RowBox[{"2", " ", "q0", " ", "q2"}]}], ",", 
         RowBox[{
          RowBox[{"2", "q2", " ", "q3"}], "+", 
          RowBox[{"2", " ", "q0", " ", "q1"}]}], ",", " ", 
         RowBox[{
          RowBox[{"q0", "^", "2"}], "-", 
          RowBox[{"q1", "^", "2"}], "-", 
          RowBox[{"q2", "^", "2"}], "+", 
          RowBox[{"q3", "^", "2"}]}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"const1", "=", 
     RowBox[{
      RowBox[{"q0", "^", "2"}], "+", 
      RowBox[{"q1", "^", "2"}], "+", 
      RowBox[{"q2", "^", "2"}], "+", 
      RowBox[{"q3", "^", "2"}], "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "R", "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "define", " ", "the", " ", "position", " ", "of", " ", "the", " ", 
     "\"\<origin\>\""}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"tx", ",", " ", "ty", ",", " ", "tz"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "define", " ", "a", " ", "point", " ", "on", " ", "the", " ", "second", 
      " ", "line"}], ",", " ", 
     RowBox[{
     "expressed", " ", "in", " ", "the", " ", "frame", " ", "of", " ", 
      "reference", " ", "of", " ", "the", " ", "first", " ", "line"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"p2", " ", "=", " ", 
    RowBox[{"t", " ", "+", " ", 
     RowBox[{"R", ".", 
      RowBox[{"{", 
       RowBox[{"x2", ",", " ", "y2", ",", " ", "z2"}], "}"}]}]}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.558073458170795*^9, 3.558073709507827*^9}, {
   3.558073740454792*^9, 3.5580738049933653`*^9}, 3.558082148926989*^9, {
   3.558096355912854*^9, 3.55809635695401*^9}, {3.558096434825989*^9, 
   3.5580964407635508`*^9}, {3.558096566201684*^9, 3.558096566383749*^9}, 
   3.5580968035030537`*^9, {3.558143008551819*^9, 3.5581430129027843`*^9}, {
   3.558221056875045*^9, 3.558221058367564*^9}, {3.558707871191598*^9, 
   3.5587080532057667`*^9}, {3.558708086242559*^9, 3.558708138196657*^9}, {
   3.5587081864836493`*^9, 3.558708197922638*^9}, {3.5587082919003572`*^9, 
   3.558708296868143*^9}, 3.558708403965981*^9, {3.558770730864664*^9, 
   3.5587707355707817`*^9}, 3.558771211427903*^9, {3.558772411253378*^9, 
   3.5587724139794683`*^9}, {3.558773268116036*^9, 3.558773271162249*^9}, 
   3.558775076077957*^9, {3.558781591525593*^9, 3.558781593321697*^9}, {
   3.558787035778143*^9, 3.558787038400735*^9}, {3.558825124510339*^9, 
   3.5588251252333527`*^9}, 3.5588378353835907`*^9, {3.570139602356282*^9, 
   3.5701396072495623`*^9}, {3.5704369826809225`*^9, 3.570436996232698*^9}, 
   3.572098362430667*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SuperscriptBox["q0", "2"], "+", 
       SuperscriptBox["q1", "2"], "-", 
       SuperscriptBox["q2", "2"], "-", 
       SuperscriptBox["q3", "2"]}], 
      RowBox[{
       RowBox[{"2", " ", "q1", " ", "q2"}], "-", 
       RowBox[{"2", " ", "q0", " ", "q3"}]}], 
      RowBox[{
       RowBox[{"2", " ", "q0", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q1", " ", "q3"}]}]},
     {
      RowBox[{
       RowBox[{"2", " ", "q1", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q0", " ", "q3"}]}], 
      RowBox[{
       SuperscriptBox["q0", "2"], "-", 
       SuperscriptBox["q1", "2"], "+", 
       SuperscriptBox["q2", "2"], "-", 
       SuperscriptBox["q3", "2"]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q0", " ", "q1"}], "+", 
       RowBox[{"2", " ", "q2", " ", "q3"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q0", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q1", " ", "q3"}]}], 
      RowBox[{
       RowBox[{"2", " ", "q0", " ", "q1"}], "+", 
       RowBox[{"2", " ", "q2", " ", "q3"}]}], 
      RowBox[{
       SuperscriptBox["q0", "2"], "-", 
       SuperscriptBox["q1", "2"], "-", 
       SuperscriptBox["q2", "2"], "+", 
       SuperscriptBox["q3", "2"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.558707871832981*^9, 3.558708138728207*^9, 3.558708198581408*^9, 
   3.5587082978452873`*^9, 3.55870834504177*^9, {3.558708405260985*^9, 
   3.5587084083440943`*^9}, 3.5587537016734962`*^9, 3.558770736353063*^9, 
   3.558771244338304*^9, 3.558772414511715*^9, 3.558772793263393*^9, 
   3.5587732742356367`*^9, 3.5587750766013517`*^9, 3.558781597760364*^9, 
   3.558787039112307*^9, 3.5588251259975224`*^9, 3.5588378361620207`*^9, 
   3.5698297951003337`*^9, 3.5701392321901097`*^9, 3.570139610501748*^9, 
   3.5720983707631435`*^9, 3.5720996723615904`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"l2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "q0", " ", "q2"}], "+", 
       RowBox[{"2", " ", "q1", " ", "q3"}]}], ")"}], " ", "t2"}], "+", "tx"}],
    ",", 
   RowBox[{
    RowBox[{"l2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "q0", " ", "q1"}], "+", 
       RowBox[{"2", " ", "q2", " ", "q3"}]}], ")"}], " ", "t2"}], "+", "ty"}],
    ",", 
   RowBox[{
    RowBox[{"l2", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["q0", "2"], "-", 
       SuperscriptBox["q1", "2"], "-", 
       SuperscriptBox["q2", "2"], "+", 
       SuperscriptBox["q3", "2"]}], ")"}], " ", "t2"}], "+", "tz"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.558707871832981*^9, 3.558708138728207*^9, 3.558708198581408*^9, 
   3.5587082978452873`*^9, 3.55870834504177*^9, {3.558708405260985*^9, 
   3.5587084083440943`*^9}, 3.5587537016734962`*^9, 3.558770736353063*^9, 
   3.558771244338304*^9, 3.558772414511715*^9, 3.558772793263393*^9, 
   3.5587732742356367`*^9, 3.5587750766013517`*^9, 3.558781597760364*^9, 
   3.558787039112307*^9, 3.5588251259975224`*^9, 3.5588378361620207`*^9, 
   3.5698297951003337`*^9, 3.5701392321901097`*^9, 3.570139610501748*^9, 
   3.5720983707631435`*^9, 3.5720996723645906`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"algvars", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "c1", ",", " ", "c2", ",", " ", "c3", ",", " ", "r1", ",", " ", "r2", 
       ",", " ", "l1", ",", " ", "l2", ",", " ", "tx", ",", " ", "ty", ",", 
       " ", "tz"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"size", "[", "x_", "]"}], " ", ":=", "  ", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Size of the expression is:\>\"", ",", " ", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"ByteCount", "[", "x", "]"}], "/", "1000"}], "]"}], ",", 
       "  ", "\"\< KB.\>\""}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "define", " ", "the", " ", "distance", " ", "between", " ", "p1"}], ",", 
     " ", "p2"}], " ", "*)"}], "\n", 
   RowBox[{"d", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Collect", "[", 
       RowBox[{
        RowBox[{"Numerator", "[", 
         RowBox[{"Together", "[", 
          RowBox[{"Expand", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p1", " ", "-", " ", "p2"}], ")"}], ".", " ", 
            RowBox[{"(", 
             RowBox[{"p1", " ", "-", " ", "p2"}], ")"}]}], "]"}], "]"}], 
         "]"}], ",", "algvars", " ", ",", " ", "FullSimplify"}], "]"}], "/.", 
      
      RowBox[{"r1", "\[Rule]", "0"}]}], "/.", 
     RowBox[{"r2", "\[Rule]", "0"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"size", "[", "d", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.558074291890336*^9, 3.5580743032330713`*^9}, 
   3.572099679975026*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["l1", "2"], " ", 
   SuperscriptBox["t1", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["l2", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["q0", "2"], "+", 
      SuperscriptBox["q1", "2"], "+", 
      SuperscriptBox["q2", "2"], "+", 
      SuperscriptBox["q3", "2"]}], ")"}], "2"], " ", 
   SuperscriptBox["t2", "2"]}], "+", 
  SuperscriptBox["tx", "2"], "+", 
  SuperscriptBox["ty", "2"], "+", 
  SuperscriptBox["tz", "2"], "+", 
  RowBox[{"l1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "l2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["q0", "2"]}], "+", 
        SuperscriptBox["q1", "2"], "+", 
        SuperscriptBox["q2", "2"], "-", 
        SuperscriptBox["q3", "2"]}], ")"}], " ", "t1", " ", "t2"}], "-", 
     RowBox[{"2", " ", "t1", " ", "tz"}]}], ")"}]}], "+", 
  RowBox[{"l2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"q0", " ", "q2"}], "+", 
        RowBox[{"q1", " ", "q3"}]}], ")"}], " ", "t2", " ", "tx"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "q0", " ", "q1", " ", "t2"}], "+", 
        RowBox[{"4", " ", "q2", " ", "q3", " ", "t2"}]}], ")"}], " ", "ty"}], 
     "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["q0", "2"], "-", 
        SuperscriptBox["q1", "2"], "-", 
        SuperscriptBox["q2", "2"], "+", 
        SuperscriptBox["q3", "2"]}], ")"}], " ", "t2", " ", "tz"}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.558075700574498*^9, 3.558075743197714*^9, 3.558083340173418*^9, 
   3.558096635968401*^9, 3.558096830487033*^9, 3.558097026151394*^9, 
   3.558175455848567*^9, 3.558708240691564*^9, 3.5587083144003963`*^9, 
   3.558708363427329*^9, 3.558708429096653*^9, 3.558753727948043*^9, 
   3.55877086564357*^9, 3.558771270483081*^9, 3.558772442622078*^9, 
   3.558772826473074*^9, {3.558773344388289*^9, 3.558773351400172*^9}, 
   3.558775079823591*^9, 3.5587816053161793`*^9, 3.5587870441246634`*^9, 
   3.558825128488229*^9, {3.5588378389128036`*^9, 3.5588378528097897`*^9}, 
   3.5698298001016197`*^9, 3.569829918089368*^9, 3.5698304735451384`*^9, {
   3.5701392406095915`*^9, 3.570139252418267*^9}, 3.5720983737773156`*^9, 
   3.5720996814521103`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Size of the expression is:\"\>", "\[InvisibleSpace]", "3.2`", 
   "\[InvisibleSpace]", "\<\" KB.\"\>"}],
  SequenceForm["Size of the expression is:", 3.2, " KB."],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5698299180943685`*^9, 3.5698304735491385`*^9, {3.5701392406335926`*^9, 
   3.570139252422267*^9}, 3.572098373780316*^9, 3.5720996814551105`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq3", " ", "=", " ", 
  RowBox[{"Factor", "[", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"d", ",", " ", "t1"}], "]"}], ",", " ", "algvars"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5580744013003883`*^9, 3.558074405469269*^9}, 
   3.55870837743467*^9, 3.558708416285698*^9, {3.558773407055828*^9, 
   3.5587734080537367`*^9}, 3.558787081920381*^9, 3.558837870196101*^9}],

Cell[BoxData[
 RowBox[{"2", " ", "l1", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"l1", " ", "t1"}], "-", 
    RowBox[{"l2", " ", 
     SuperscriptBox["q0", "2"], " ", "t2"}], "+", 
    RowBox[{"l2", " ", 
     SuperscriptBox["q1", "2"], " ", "t2"}], "+", 
    RowBox[{"l2", " ", 
     SuperscriptBox["q2", "2"], " ", "t2"}], "-", 
    RowBox[{"l2", " ", 
     SuperscriptBox["q3", "2"], " ", "t2"}], "-", "tz"}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.558075707788279*^9, 3.55807575062318*^9, 3.558083370993641*^9, 
   3.558096910389751*^9, {3.558097032773487*^9, 3.558097037630073*^9}, 
   3.558175502569605*^9, 3.55870838132275*^9, 3.558708438288974*^9, 
   3.558753741128714*^9, 3.558771154071809*^9, 3.558771289187728*^9, 
   3.5587724602126102`*^9, 3.558772843938776*^9, {3.558773402491294*^9, 
   3.55877340919588*^9}, 3.558775095609807*^9, 3.558781625323029*^9, 
   3.5587870507468243`*^9, 3.558787082595313*^9, 3.558825134120995*^9, {
   3.558837865276832*^9, 3.5588378710101767`*^9}, 3.569829929891043*^9, 
   3.5701392967968054`*^9, 3.5720983748613777`*^9, 3.5720996833072166`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eq4", " ", "=", " ", 
   RowBox[{"Factor", "[", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"d", ",", " ", "t2"}], "]"}], ",", " ", "algvars"}], "]"}], 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5580743911825647`*^9, 3.558074416807541*^9}, {
   3.558773425006267*^9, 3.5587734266129627`*^9}, 3.5587870904717903`*^9, 
   3.558837873116452*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], " ", "l2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"l1", " ", 
     SuperscriptBox["q0", "2"], " ", "t1"}], "-", 
    RowBox[{"l1", " ", 
     SuperscriptBox["q1", "2"], " ", "t1"}], "-", 
    RowBox[{"l1", " ", 
     SuperscriptBox["q2", "2"], " ", "t1"}], "+", 
    RowBox[{"l1", " ", 
     SuperscriptBox["q3", "2"], " ", "t1"}], "-", 
    RowBox[{"l2", " ", 
     SuperscriptBox["q0", "4"], " ", "t2"}], "-", 
    RowBox[{"2", " ", "l2", " ", 
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q1", "2"], " ", "t2"}], "-", 
    RowBox[{"l2", " ", 
     SuperscriptBox["q1", "4"], " ", "t2"}], "-", 
    RowBox[{"2", " ", "l2", " ", 
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q2", "2"], " ", "t2"}], "-", 
    RowBox[{"2", " ", "l2", " ", 
     SuperscriptBox["q1", "2"], " ", 
     SuperscriptBox["q2", "2"], " ", "t2"}], "-", 
    RowBox[{"l2", " ", 
     SuperscriptBox["q2", "4"], " ", "t2"}], "-", 
    RowBox[{"2", " ", "l2", " ", 
     SuperscriptBox["q0", "2"], " ", 
     SuperscriptBox["q3", "2"], " ", "t2"}], "-", 
    RowBox[{"2", " ", "l2", " ", 
     SuperscriptBox["q1", "2"], " ", 
     SuperscriptBox["q3", "2"], " ", "t2"}], "-", 
    RowBox[{"2", " ", "l2", " ", 
     SuperscriptBox["q2", "2"], " ", 
     SuperscriptBox["q3", "2"], " ", "t2"}], "-", 
    RowBox[{"l2", " ", 
     SuperscriptBox["q3", "4"], " ", "t2"}], "-", 
    RowBox[{"2", " ", "q0", " ", "q2", " ", "tx"}], "-", 
    RowBox[{"2", " ", "q1", " ", "q3", " ", "tx"}], "+", 
    RowBox[{"2", " ", "q0", " ", "q1", " ", "ty"}], "-", 
    RowBox[{"2", " ", "q2", " ", "q3", " ", "ty"}], "-", 
    RowBox[{
     SuperscriptBox["q0", "2"], " ", "tz"}], "+", 
    RowBox[{
     SuperscriptBox["q1", "2"], " ", "tz"}], "+", 
    RowBox[{
     SuperscriptBox["q2", "2"], " ", "tz"}], "-", 
    RowBox[{
     SuperscriptBox["q3", "2"], " ", "tz"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.558787549859593*^9, 3.558825136225856*^9, 
  3.558837873688485*^9, 3.569829931457133*^9, 3.570139298070878*^9, 
  3.572098376072447*^9, 3.5720996851953244`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f3", " ", "=", " ", 
  RowBox[{"TrigExpand", "[", 
   RowBox[{"eq3", "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", "l1"}], "  ", ")"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "2", " ", "l1", " ", "can", " ", "be", " ", "factored", " ", "out", " ", 
    "as", " ", "seen", " ", "in", " ", "eq3"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{
  3.5580744408080797`*^9, {3.558074501749075*^9, 3.558074514709106*^9}, 
   3.5580969401919727`*^9, 3.558097047513084*^9, 3.558175523227558*^9, {
   3.558708469603606*^9, 3.558708470754726*^9}, 3.5587707650873823`*^9, {
   3.5587718208118277`*^9, 3.5587718229238157`*^9}, 3.558772521938931*^9, {
   3.5587734425009613`*^9, 3.558773446674428*^9}, 3.55877354210109*^9, {
   3.5587751108155746`*^9, 3.558775111310463*^9}, {3.558781674405641*^9, 
   3.5587816750927467`*^9}, {3.5587875555626593`*^9, 3.558787559224262*^9}, {
   3.558825146899507*^9, 3.558825149441065*^9}, {3.569830721596326*^9, 
   3.569830726777622*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"l1", " ", "t1"}], "-", 
  RowBox[{"l2", " ", 
   SuperscriptBox["q0", "2"], " ", "t2"}], "+", 
  RowBox[{"l2", " ", 
   SuperscriptBox["q1", "2"], " ", "t2"}], "+", 
  RowBox[{"l2", " ", 
   SuperscriptBox["q2", "2"], " ", "t2"}], "-", 
  RowBox[{"l2", " ", 
   SuperscriptBox["q3", "2"], " ", "t2"}], "-", "tz"}]], "Output",
 CellChangeTimes->{3.558075752546062*^9, 3.558083375539033*^9, 
  3.558096941162429*^9, 3.558097048352868*^9, 3.558175525991734*^9, 
  3.558708471512143*^9, 3.558753742661718*^9, 3.5587718292887077`*^9, 
  3.558772523436356*^9, 3.5587728876169987`*^9, 3.558773447729068*^9, 
  3.558773542884054*^9, 3.558775112279964*^9, 3.558781676140222*^9, 
  3.558787560184602*^9, 3.558825150136022*^9, 3.558837879500019*^9, 
  3.5698299380945125`*^9, 3.5701393104655867`*^9, 3.572098377257515*^9, 
  3.5720996868254175`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f4", " ", "=", " ", 
  RowBox[{"TrigExpand", "[", 
   RowBox[{"eq4", "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", "l2"}], " ", ")"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "2", " ", "l2", " ", "can", " ", "be", " ", "factored", " ", "out", " ", 
    "as", " ", "seen", " ", "in", " ", "eq4"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5580745198017483`*^9, 3.558074550007493*^9}, 
   3.558175535150817*^9, {3.558708475379404*^9, 3.5587084767378073`*^9}, {
   3.558771825292232*^9, 3.5587718275233727`*^9}, 3.5587725398960037`*^9, {
   3.5587730004750957`*^9, 3.5587730019859037`*^9}, {3.558773454059803*^9, 
   3.55877345488923*^9}, 3.5587735474680758`*^9, 3.558775114447081*^9, {
   3.5587816818373203`*^9, 3.558781682548086*^9}, 3.5587875632101297`*^9, {
   3.558825152835134*^9, 3.558825157120617*^9}, {3.5698307288987436`*^9, 
   3.5698307418854866`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "l1"}], " ", 
   SuperscriptBox["q0", "2"], " ", "t1"}], "+", 
  RowBox[{"l1", " ", 
   SuperscriptBox["q1", "2"], " ", "t1"}], "+", 
  RowBox[{"l1", " ", 
   SuperscriptBox["q2", "2"], " ", "t1"}], "-", 
  RowBox[{"l1", " ", 
   SuperscriptBox["q3", "2"], " ", "t1"}], "+", 
  RowBox[{"l2", " ", 
   SuperscriptBox["q0", "4"], " ", "t2"}], "+", 
  RowBox[{"2", " ", "l2", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q1", "2"], " ", "t2"}], "+", 
  RowBox[{"l2", " ", 
   SuperscriptBox["q1", "4"], " ", "t2"}], "+", 
  RowBox[{"2", " ", "l2", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "t2"}], "+", 
  RowBox[{"2", " ", "l2", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q2", "2"], " ", "t2"}], "+", 
  RowBox[{"l2", " ", 
   SuperscriptBox["q2", "4"], " ", "t2"}], "+", 
  RowBox[{"2", " ", "l2", " ", 
   SuperscriptBox["q0", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "t2"}], "+", 
  RowBox[{"2", " ", "l2", " ", 
   SuperscriptBox["q1", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "t2"}], "+", 
  RowBox[{"2", " ", "l2", " ", 
   SuperscriptBox["q2", "2"], " ", 
   SuperscriptBox["q3", "2"], " ", "t2"}], "+", 
  RowBox[{"l2", " ", 
   SuperscriptBox["q3", "4"], " ", "t2"}], "+", 
  RowBox[{"2", " ", "q0", " ", "q2", " ", "tx"}], "+", 
  RowBox[{"2", " ", "q1", " ", "q3", " ", "tx"}], "-", 
  RowBox[{"2", " ", "q0", " ", "q1", " ", "ty"}], "+", 
  RowBox[{"2", " ", "q2", " ", "q3", " ", "ty"}], "+", 
  RowBox[{
   SuperscriptBox["q0", "2"], " ", "tz"}], "-", 
  RowBox[{
   SuperscriptBox["q1", "2"], " ", "tz"}], "-", 
  RowBox[{
   SuperscriptBox["q2", "2"], " ", "tz"}], "+", 
  RowBox[{
   SuperscriptBox["q3", "2"], " ", "tz"}]}]], "Output",
 CellChangeTimes->{3.558075752735882*^9, 3.558083377580409*^9, 
  3.558096952808318*^9, 3.5580970531286488`*^9, 3.558175536428129*^9, 
  3.558708477782247*^9, 3.558753742830414*^9, 3.558771830534041*^9, 
  3.558772540926063*^9, 3.558772888630608*^9, 3.5587730029080257`*^9, 
  3.558773455775467*^9, 3.558773548315939*^9, 3.558775115147327*^9, 
  3.558781683547781*^9, 3.558787564846799*^9, 3.558825158191497*^9, 
  3.558837880177603*^9, 3.569829939542595*^9, 3.570139312516704*^9, 
  3.5720983784785843`*^9, 3.5720996883255033`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solt", "=", 
  RowBox[{"FullSimplify", "[", " ", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f3", ",", "f4"}], "}"}], " ", "\[Equal]", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"t1", ",", "t2"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "two", " ", "equations", " ", "linear", " ", "in", " ", "t1", " ", "and", 
    " ", "t2", " ", "are", " ", "solved", " ", "simultaneously"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.5580749122473717`*^9, 3.5580749735675898`*^9}, {
   3.558075121534004*^9, 3.558075123626783*^9}, {3.558175545397298*^9, 
   3.558175548263546*^9}, {3.5587085057971373`*^9, 3.558708509507172*^9}, {
   3.558771841030569*^9, 3.558771993647889*^9}, {3.558772187384592*^9, 
   3.558772197069064*^9}, {3.558772568755226*^9, 3.5587725886783743`*^9}, {
   3.5587728958109283`*^9, 3.558772923848027*^9}, {3.558773009241201*^9, 
   3.558773031634039*^9}, {3.558775142055781*^9, 3.558775144231162*^9}, {
   3.558787888701654*^9, 3.558787896789309*^9}, {3.558825164346663*^9, 
   3.558825166617366*^9}, {3.558837886933154*^9, 3.558837888110662*^9}, 
   3.55883794883505*^9, {3.569830758854457*^9, 3.569830786861059*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"t1", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["q0", "2"], "-", 
           SuperscriptBox["q1", "2"], "-", 
           SuperscriptBox["q2", "2"], "+", 
           SuperscriptBox["q3", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q0", " ", "q2", " ", "tx"}], "+", 
           RowBox[{"q1", " ", "q3", " ", "tx"}], "-", 
           RowBox[{"q0", " ", "q1", " ", "ty"}], "+", 
           RowBox[{"q2", " ", "q3", " ", "ty"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["q1", "2"], "+", 
           SuperscriptBox["q2", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["q0", "2"], "+", 
           SuperscriptBox["q3", "2"]}], ")"}]}]]}], "+", 
      RowBox[{"2", " ", "tz"}]}], 
     RowBox[{"2", " ", "l1"}]]}], ",", 
   RowBox[{"t2", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"q0", " ", "q2", " ", "tx"}], "+", 
       RowBox[{"q1", " ", "q3", " ", "tx"}], "-", 
       RowBox[{"q0", " ", "q1", " ", "ty"}], "+", 
       RowBox[{"q2", " ", "q3", " ", "ty"}]}], 
      RowBox[{"2", " ", "l2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q1", "2"], "+", 
         SuperscriptBox["q2", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["q0", "2"], "+", 
         SuperscriptBox["q3", "2"]}], ")"}]}]]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.558075761318028*^9, 3.558083390818747*^9, 3.558096967460684*^9, 
   3.558097067851766*^9, 3.558175558448155*^9, 3.558708519963051*^9, 
   3.558710370870763*^9, 3.558753753460732*^9, {3.558771846064519*^9, 
   3.558771888796585*^9}, 3.558771941185425*^9, {3.558771983360647*^9, 
   3.5587719940228662`*^9}, 3.558772210568729*^9, 3.558772599962852*^9, {
   3.558772907663917*^9, 3.558772924903552*^9}, {3.558773027702991*^9, 
   3.558773041239002*^9}, 3.558775154979561*^9, 3.5587879090173187`*^9, 
   3.558825176416081*^9, {3.558837881720862*^9, 3.5588378980948753`*^9}, 
   3.5588379498416023`*^9, 3.5698299591127143`*^9, 3.570139334336952*^9, 
   3.572098380450697*^9, 3.5720996904906273`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"inputs", " ", "to", " ", "define", " ", "the", " ", "lines"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"input", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q0", "\[Rule]", "0"}], ",", 
       RowBox[{"q1", "\[Rule]", "0"}], ",", 
       RowBox[{"q2", "\[Rule]", "0.707"}], ",", 
       RowBox[{"q3", "\[Rule]", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"0.707", "^", "2"}], "-", 
          RowBox[{"0", "^", "2"}], "-", 
          RowBox[{"0", "^", "2"}]}], "]"}]}], ",", 
       RowBox[{"r1", "\[Rule]", "0.5"}], ",", 
       RowBox[{"r2", "\[Rule]", ".5"}], ",", 
       RowBox[{"l1", "\[Rule]", "4"}], ",", 
       RowBox[{"l2", "\[Rule]", "6"}], ",", 
       RowBox[{"tx", "\[Rule]", "0.5"}], ",", 
       RowBox[{"ty", "\[Rule]", 
        RowBox[{
         RowBox[{"-", "0.9"}], "-", "0.5", "-", "0.9"}]}], ",", 
       RowBox[{"tz", "\[Rule]", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "1.5", "+", ".9", "+", "1.4"}]}]}], "}"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "combinations", " ", "of", " ", "all", " ", "possible", " ", 
     "solutions"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"nsolutions", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"solt", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/.", "input"}], ",", 
       RowBox[{
        RowBox[{"solt", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/.", "input"}]}], "}"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.5588239415240726`*^9, 3.558823988304873*^9}, {
   3.558824030241153*^9, 3.5588240728567867`*^9}, {3.5588243754498453`*^9, 
   3.558824482328076*^9}, {3.5588246228224373`*^9, 3.558824635014586*^9}, {
   3.558824723176489*^9, 3.558824727162292*^9}, {3.558824784879406*^9, 
   3.558824848866665*^9}, {3.558825000633794*^9, 3.5588250846576347`*^9}, {
   3.5588258681507053`*^9, 3.558825887759346*^9}, {3.558825961729797*^9, 
   3.5588259825646544`*^9}, {3.558826013870875*^9, 3.558826045866074*^9}, {
   3.5588261276064453`*^9, 3.558826138865679*^9}, 3.558838076397911*^9, {
   3.558838243917041*^9, 3.558838260854479*^9}, {3.5698310202444077`*^9, 
   3.569831055352416*^9}, {3.5701393739592185`*^9, 3.5701394116723757`*^9}, {
   3.570437005974255*^9, 3.5704370067693005`*^9}, 3.572098341537472*^9, 
   3.572099656631691*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"t1", "\[Rule]", "0.45017365000791887`"}], ",", 
   RowBox[{"t2", "\[Rule]", "0.38333335081410114`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.570139412881445*^9, 3.5720983838838935`*^9, 
  3.572099691565689*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"tmp", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"t1", ",", "t2"}], "}"}], "/.", 
   RowBox[{"nsolutions", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"Im", "[", "tmp", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "restol1"}], " ", "&&",
   " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"Im", "[", "tmp", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", " ", "restol1"}], " ", "&&", 
  RowBox[{
   RowBox[{"tmp", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "1"}], " ", "&&", 
  RowBox[{
   RowBox[{"tmp", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", " ", "1"}], "&&", 
  RowBox[{
   RowBox[{"tmp", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "\[GreaterEqual]", "  ", "0"}], " ", "&&", 
  RowBox[{
   RowBox[{"tmp", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "\[GreaterEqual]", "  ", 
   "0"}]}]}], "Input",
 CellChangeTimes->{{3.572099790870369*^9, 3.5720997939275436`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.45017365000791887`", ",", "t2"}], "}"}]], "Output",
 CellChangeTimes->{3.5720997943715687`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Abs", "[", 
    RowBox[{"Im", "[", "t2", "]"}], "]"}], "\[LessEqual]", 
   FractionBox["1", "1000"]}], "&&", 
  RowBox[{"t2", "\[LessEqual]", "1"}], "&&", 
  RowBox[{"t2", "\[GreaterEqual]", "0"}]}]], "Output",
 CellChangeTimes->{3.572099794374569*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"filtering", " ", "out", " ", "real", " ", "solutions"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"restol1", "=", 
     RowBox[{"10", "^", 
      RowBox[{"-", "3"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"realsolns", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmp", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t1", ",", "t2"}], "}"}], "/.", "nsolutions"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"Im", "[", "tmp", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "restol1"}], " ",
       "&&", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"Im", "[", "tmp", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", " ", "restol1"}], " ",
       "&&", 
      RowBox[{
       RowBox[{"tmp", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "1"}], " ", "&&", 
      RowBox[{
       RowBox[{"tmp", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", " ", "1"}], "&&", 
      RowBox[{
       RowBox[{"tmp", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[GreaterEqual]", "  ", "0"}], " ", "&&", 
      RowBox[{
       RowBox[{"tmp", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "\[GreaterEqual]", "  ", "0"}]}], ",", 
     RowBox[{"realsolns", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"realsolns", ",", "nsolutions"}], "]"}]}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "function", " ", "to", " ", "check", " ", "if", " ", "end", " ", 
      "points", " ", "of", " ", "the", " ", "line"}], "-", 
     RowBox[{
     "segments", " ", "are", " ", "the", " ", "closest", " ", "points"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mindist", "[", 
     RowBox[{"p1_", ",", "p2_", ",", "t1_", ",", "t2_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "min", ",", "min1", ",", "min2", ",", "min3", ",", "min4", ",", 
        "mint"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"min1", "=", 
         RowBox[{"Norm", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"p1", "/.", "input"}], "/.", 
               RowBox[{"t1", "\[Rule]", "0"}]}], "/.", 
              RowBox[{"t2", "\[Rule]", "0"}]}], ")"}], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"p2", "/.", "input"}], "/.", 
               RowBox[{"t1", "\[Rule]", "0"}]}], "/.", 
              RowBox[{"t2", "\[Rule]", "0"}]}], ")"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"min2", "=", 
         RowBox[{"Norm", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"p1", "/.", "input"}], "/.", 
               RowBox[{"t1", "\[Rule]", "0"}]}], "/.", 
              RowBox[{"t2", "\[Rule]", "1"}]}], ")"}], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"p2", "/.", "input"}], "/.", 
               RowBox[{"t1", "\[Rule]", "0"}]}], "/.", 
              RowBox[{"t2", "\[Rule]", "1"}]}], ")"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"min3", "=", 
         RowBox[{"Norm", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"p1", "/.", "input"}], "/.", 
               RowBox[{"t1", "\[Rule]", "1"}]}], "/.", 
              RowBox[{"t2", "\[Rule]", "1"}]}], ")"}], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"p2", "/.", "input"}], "/.", 
               RowBox[{"t1", "\[Rule]", "1"}]}], "/.", 
              RowBox[{"t2", "\[Rule]", "1"}]}], ")"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"min4", "=", 
         RowBox[{"Norm", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"p1", "/.", "input"}], "/.", 
               RowBox[{"t1", "\[Rule]", "1"}]}], "/.", 
              RowBox[{"t2", "\[Rule]", "0"}]}], ")"}], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"p2", "/.", "input"}], "/.", 
               RowBox[{"t1", "\[Rule]", "1"}]}], "/.", 
              RowBox[{"t2", "\[Rule]", "0"}]}], ")"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"min", "=", "min1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"mint", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"min2", "<", "min"}], ",", 
          RowBox[{
           RowBox[{"mint", "=", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], ";", 
           RowBox[{"min", "=", "min2"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"min3", "<", "min"}], ",", 
          RowBox[{
           RowBox[{"mint", "=", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}], ";", 
           RowBox[{"min", "=", "min3"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"min4", "<", "min"}], ",", 
          RowBox[{
           RowBox[{"mint", "=", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ";", 
           RowBox[{"min", "=", "min4"}]}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"min", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"t1", "->", 
             RowBox[{"mint", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"t2", "\[Rule]", 
             RowBox[{"mint", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"realsolns", "\[Equal]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{
      RowBox[{"realsolns", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mindist", "[", 
          RowBox[{
           RowBox[{"p1", "/.", "input"}], ",", 
           RowBox[{"p2", "/.", "input"}], ",", "t1", ",", "t2"}], "]"}], "[", 
         
         RowBox[{"[", "2", "]"}], "]"}], "}"}]}], ";"}]}], "]"}], 
   "\[IndentingNewLine]", "realsolns", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.5588239415240726`*^9, 3.558823988304873*^9}, {
   3.558824030241153*^9, 3.5588240728567867`*^9}, {3.5588243754498453`*^9, 
   3.558824482328076*^9}, {3.5588246228224373`*^9, 3.558824635014586*^9}, {
   3.558824723176489*^9, 3.558824727162292*^9}, {3.558824784879406*^9, 
   3.558824848866665*^9}, {3.558825000633794*^9, 3.5588250846576347`*^9}, {
   3.5588258681507053`*^9, 3.558825887759346*^9}, {3.558825961729797*^9, 
   3.5588259825646544`*^9}, {3.558826013870875*^9, 3.558826045866074*^9}, {
   3.5588261276064453`*^9, 3.558826138865679*^9}, 3.558838076397911*^9, {
   3.558838243917041*^9, 3.558838260854479*^9}, {3.5698310202444077`*^9, 
   3.569831055352416*^9}, {3.5701393739592185`*^9, 3.5701394353707314`*^9}, {
   3.57013947469098*^9, 3.570139540242729*^9}, {3.5701399441608324`*^9, 
   3.5701402370355835`*^9}, {3.5701402746607356`*^9, 3.570140317346177*^9}, {
   3.570140351116109*^9, 3.5701403974787607`*^9}, {3.5701404663677006`*^9, 
   3.57014046827781*^9}, {3.570437020023059*^9, 3.570437034799904*^9}, {
   3.5720998545810127`*^9, 3.5720998809615216`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"t1", "\[Rule]", "0.45017365000791887`"}], ",", 
    RowBox[{"t2", "\[Rule]", "0.38333335081410114`"}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.558825863067546*^9, {3.558825966559875*^9, 3.558825990906122*^9}, 
   3.558826048609662*^9, 3.5588380816721354`*^9, {3.5588382480296803`*^9, 
   3.558838261439872*^9}, 3.569830389665341*^9, 3.570139437848873*^9, 
   3.5701394899068503`*^9, {3.5701402309302344`*^9, 3.570140237604616*^9}, {
   3.570140310712798*^9, 3.5701403183992376`*^9}, {3.570140385383069*^9, 
   3.570140397956788*^9}, 3.5701404692498655`*^9, 3.5720983873620925`*^9, 
   3.5720996950418873`*^9, {3.5720998678427715`*^9, 3.5720998817645674`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"t1", "\[Rule]", "0.45017365000791887`"}], ",", 
    RowBox[{"t2", "\[Rule]", "0.38333335081410114`"}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.558825863067546*^9, {3.558825966559875*^9, 3.558825990906122*^9}, 
   3.558826048609662*^9, 3.5588380816721354`*^9, {3.5588382480296803`*^9, 
   3.558838261439872*^9}, 3.569830389665341*^9, 3.570139437848873*^9, 
   3.5701394899068503`*^9, {3.5701402309302344`*^9, 3.570140237604616*^9}, {
   3.570140310712798*^9, 3.5701403183992376`*^9}, {3.570140385383069*^9, 
   3.570140397956788*^9}, 3.5701404692498655`*^9, 3.5720983873620925`*^9, 
   3.5720996950418873`*^9, {3.5720998678427715`*^9, 3.5720998817675676`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"np1", "=", 
  RowBox[{
   RowBox[{"p1", "/.", "input"}], "/.", 
   RowBox[{"realsolns", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"np2", "=", 
  RowBox[{
   RowBox[{"p2", "/.", "input"}], "/.", 
   RowBox[{"realsolns", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.558826065509202*^9, 3.558826113945031*^9}, {
  3.569831074889533*^9, 3.569831085343131*^9}, {3.5701403269487267`*^9, 
  3.5701403292198563`*^9}, {3.570140471512995*^9, 3.570140473768124*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "1.8006946000316755`"}], "}"}]], "Output",
 CellChangeTimes->{{3.558826073752213*^9, 3.558826083715197*^9}, 
   3.558826115093013*^9, 3.5588382649179773`*^9, 3.5698304023080635`*^9, 
   3.570140337571334*^9, 3.5701404024360437`*^9, 3.5701404741441455`*^9, 
   3.5720983891391945`*^9, 3.5720998842457094`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.5`", ",", "0.`", ",", "1.8006946000316755`"}], "}"}]], "Output",
 CellChangeTimes->{{3.558826073752213*^9, 3.558826083715197*^9}, 
   3.558826115093013*^9, 3.5588382649179773`*^9, 3.5698304023080635`*^9, 
   3.570140337571334*^9, 3.5701404024360437`*^9, 3.5701404741441455`*^9, 
   3.5720983891391945`*^9, 3.5720998842527103`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"l1", "/.", "input"}]}], "}"}]}], "}"}], "]"}], "]"}], ",", 
    
    RowBox[{"Graphics3D", "[", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tx", ",", "ty", ",", "tz"}], "}"}], "-", 
           RowBox[{"R", ".", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", 
              RowBox[{"0", "/.", "input"}]}], "}"}]}]}], ")"}], "/.", 
         "input"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"tx", ",", "ty", ",", "tz"}], "}"}], "+", 
           RowBox[{"R", ".", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", 
              RowBox[{"l2", "/.", "input"}]}], "}"}]}]}], ")"}], "/.", 
         "input"}]}], "}"}], "]"}], "]"}], ",", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"np1", ",", "np2"}], "}"}], "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5587795093706617`*^9, 3.558779564496065*^9}, {
  3.55877967345051*^9, 3.558779784653714*^9}, {3.558788107977495*^9, 
  3.558788157697606*^9}, {3.55878819926399*^9, 3.5587882230783567`*^9}, {
  3.5701404131086545`*^9, 3.570140436407987*^9}, {3.572098426881353*^9, 
  3.572098436878925*^9}, {3.5720984930211363`*^9, 3.5720985075939693`*^9}}],

Cell[BoxData[
 Graphics3DBox[{Line3DBox[{{0, 0, 0}, {0, 0, 4}}], 
   Line3DBox[{{0.5, -2.3, 1.7999999999999998`}, {0.5, 3.6999997263879942`, 
    1.8018120000000009`}}], 
   Line3DBox[{{0, 0, 1.8006946000316755`}, {0.5, 0., 1.8006946000316755`}}]},
  ImageSize->{249.35710666787705`, 432.},
  ViewPoint->{-0.3984641335420446, -2.680132233046439, -2.0268491674680935`},
  ViewVertical->{
   0.19471146459059255`, -0.9436896133270999, -0.4956509857737147}]], "Output",\

 CellChangeTimes->{{3.5587795291426973`*^9, 3.558779565368815*^9}, {
   3.5587796744213743`*^9, 3.558779702765456*^9}, {3.558779734454988*^9, 
   3.558779785558836*^9}, 3.5587881085765963`*^9, {3.558788140575094*^9, 
   3.558788158276354*^9}, {3.5587881888493977`*^9, 3.5587882865879107`*^9}, 
   3.5587883401810703`*^9, 3.558826117257182*^9, 3.558838266044379*^9, 
   3.569830406058278*^9, {3.5701404168868704`*^9, 3.570140438467105*^9}, 
   3.5701404756672325`*^9, 3.5720983906062784`*^9, 3.57209843802299*^9, {
   3.572098495766293*^9, 3.5720985108851576`*^9}, 3.572099886496838*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5580858843897543`*^9, 3.5580858844151278`*^9}}]
},
WindowSize->{1350, 633},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> True}},
ShowSelection->True,
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.5, 1.5 Inherited],
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 397, 10, 133, "Input",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[979, 34, 1786, 36, 233, "Input"],
Cell[2768, 72, 816, 14, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3621, 91, 4879, 117, 584, "Input"],
Cell[8503, 210, 2388, 62, 114, "Output"],
Cell[10894, 274, 1343, 35, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12274, 314, 1640, 43, 206, "Input"],
Cell[13917, 359, 2428, 64, 80, "Output"],
Cell[16348, 425, 411, 8, 32, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16796, 438, 444, 10, 43, "Input"],
Cell[17243, 450, 1100, 22, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18380, 477, 445, 11, 71, "Input"],
Cell[18828, 490, 2114, 53, 106, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20979, 548, 989, 19, 43, "Input"],
Cell[21971, 569, 873, 18, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22881, 592, 895, 17, 43, "Input"],
Cell[23779, 611, 2316, 56, 102, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26132, 672, 1350, 28, 71, "Input"],
Cell[27485, 702, 2345, 59, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29867, 766, 2485, 57, 179, "Input"],
Cell[32355, 825, 264, 6, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32656, 836, 1104, 32, 98, "Input"],
Cell[33763, 870, 137, 3, 42, "Output"],
Cell[33903, 875, 299, 8, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34239, 888, 8193, 210, 719, "Input"],
Cell[42435, 1100, 743, 14, 42, "Output"],
Cell[43181, 1116, 743, 14, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43961, 1135, 551, 13, 71, "Input"],
Cell[44515, 1150, 367, 6, 42, "Output"],
Cell[44885, 1158, 372, 6, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45294, 1169, 1722, 46, 125, "Input"],
Cell[47019, 1217, 1055, 17, 702, "Output"]
}, Open  ]],
Cell[48089, 1237, 96, 1, 43, "Input"]
}
]
*)

(* End of internal cache information *)
